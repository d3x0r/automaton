'use strict';(function(){function u(a){if(!(this instanceof u))return new u(this);this.brain=a;this.threshold=.5;this.algorithm=0;this.k=.2;this.input=0;this.on=!1;this.cycle=a.cycle-1;this.type="Neuron";this.inputs=[];this.outputs=[]}function ea(a){if(!(this instanceof ea))return new ea(this);u.call(this,a);this.type="Sigmoid";this.k=this.brain.k;return n}function X(a){if(!(this instanceof X))return new X(this);u.call(this,a);this.type="Oscillator";this.freq=1}function Y(a,c){if(!(this instanceof
Y))return new Y(this);u.call(this,a);this.type="TickOscillator";this.freq=c||1E3}function U(a,c){if(!(this instanceof U))return new U(this,a);u.call(this,a);this.cb=c;this.type="External"}function Z(a,c){if(!(this instanceof Z))return new Z(this,a);u.call(this,a);this.cb=c;this.type="Exporter"}function R(){if(!(this instanceof R))return new R(this);this.output=this.input=null;this.gain=1}function S(a,c,d,b,e,f,g,h,l,q,t){if(!(this instanceof S))return new S(a,c,d,b,e,f,g,h,l,q,t);this.flags={block:0,
viaset:0};this.scaled=[];this.current_scale;this.isBlock=h;this.isRoute=l;this.cellSize=a.GetCellSize();this.size={rows:b,cols:e};this.cellSize={width:0,height:0};this.hot={x:f,y:g};this.board=a;this.name=c;this.image=this.original=d;"on"in d?d=d.on:this.image=d;if(d){this.grid=null;this.lastCell={coords:null,size:this.cellSize};if("IMG"===d.nodeName)d.addEventListener("load",m.bind(this)),d.width&&m.call(this);else if("svg"===d.nodeName){var r;function w(B){var G=(new XMLSerializer).serializeToString(B);
G="data:image/svg+xml,"+encodeURI(G).replace(/#/g,"%23");r=document.createElement("img");r.width=B.getAttribute("width");r.height=B.getAttribute("height");r.src=G;return r}this.original.on=w(this.original.on);this.original.off=w(this.original.off);"range"in this.original&&(this.original.range=this.original.range.map(w));this.image=this.original;m.call(this)}function m(){var w=this.image;"on"in w&&(w=w.on);if("number"===typeof w.width){var B=w.width/this.size.cols;w=w.height/this.size.rows}else B=
66/this.size.cols,w=66/this.size.rows;var G=[];this.cellSize.width=B;this.cellSize.height=w;for(var H=0;H<this.size.cols;H++){G[H]=[];for(var ra=0;ra<this.size.rows;ra++)G[H].push({x:H*B,y:ra*w})}this.grid=G}this.current_scale=0}this.psvCreate=t;this.methods=q?q:new y(this);this.methods.SetPeice(this)}function P(a,c,d,b,e,f){S.call(this,a,c,{on:d,off:b},7,7,0,0,!1,!0,e,f)}function y(a){if(!(this instanceof y))return new y;this.master=a}function Q(){if(!(this instanceof Q))return new Q}function sa(){return{x:0,
y:0,cellx:0,celly:0,isAbove:null,isBelow:null,flags:{BackDir:0,ForeDir:0,bForced:0,bFlopped:0,bTry:0,bRight:0}}}function E(a,c,d,b,e,f,g,h){if(!(this instanceof E))return new E(a,c,d,b,e,f,g,h);this.board=a;this.peice=c||null;this.psvInstance=c?c.methods.Create(c.psvCreate):null;this.iLayer;this.linked=[];this.route_start_layer={layer:null,x:0,y:0};this.route_end_layer={layer:null,x:0,y:0};this.flags={bForced:0,bEnded:0,bRoute:0,bRoot:0};this.prior=this.next=null;this.flags.bRoot=!a.rootLayer;this.pds_path=
[];this.flags.bRoute=c.isRoute;this.x=d||0;this.y=b||0;this.min_x=d-g||0;this.min_y=b-h||0;this.w=e||1;this.h=f||1;this.peice=c;if(!this.flags.bRoute)for(a=0;a<this.peice.size.cols;a++)for(c=0;c<this.peice.size.rows;c++)d=new sa,d.x=this.x+a-this.peice.hot.x,d.y=this.y+c-this.peice.hot.y,d.cellx=a,d.celly=c,this.pds_path.push(d)}function wa(a,c){return a==c?0:a==(c+1&7)?-1:a==(c-1&7)?1:10}function ta(a){var c=[];return{get(d,b,e,f,g,h,l,q){(q=c.pop())||(q=E(a,d,b,e,f,g,h,l));return q},drop(d){c.push(d)}}}
function z(a){if(!(this instanceof z))return new z(a);var c=this.canvas=document.createElement("canvas");c.width=1024;c.height=1024;c.style.width="100%";c.style.height="100%";this.ctx=c.getContext("2d");a.appendChild(c);var d=this,b=0;c.addEventListener("mousemove",function(e){e.preventDefault();d.mousePos.x=e.clientX;d.mousePos.y=e.clientY;var f=a.getBoundingClientRect();d.DoMouse(e.offsetX*c.width/f.width,e.offsetY*c.height/f.height,b)});c.addEventListener("mouseup",function(e){e.preventDefault();
b=e.buttons;d.mousePos.x=e.clientX;d.mousePos.y=e.clientY;var f=a.getBoundingClientRect();d.DoMouse(e.offsetX*c.width/f.width,e.offsetY*c.height/f.height,b)});c.addEventListener("mousedown",function(e){e.preventDefault();b=e.buttons;d.mousePos.x=e.clientX;d.mousePos.y=e.clientY;var f=a.getBoundingClientRect();d.DoMouse(e.offsetX*c.width/f.width,e.offsetY*c.height/f.height,b)});a.addEventListener("contextmenu",e=>{e.preventDefault();return!1},!1);document.body.addEventListener("contextmenu",e=>{e.preventDefault();
return!1},!1);c.addEventListener("contextmenu",e=>{e.preventDefault();return!1},!1);this.cellSize={width:16,height:16};this._cell_height=this._cell_width=0;this.default_peice_instance;this.default_peice;this.OnClose;this.psvClose;this.peices=[];this.layerPool=ta();this.mouse_current_layer;this.route_current_layer;this.move_current_layer;this.mousePos={x:0,y:0};this.wY=this.wX=this.yStart=this.xStart=0;this.board_height=this.board_width=50;this.board_origin_y=this.board_origin_x=0;this.flags={bSliding:0,
bDragging:0,bLockLeft:0,bLockRight:0,bLeft:0,bRight:0,bLeftChanged:0,bRightChanged:0};this.scale=0;this.current_path={viaset:null,_x:0,_y:0};this.selected=null;this.peices=[];this.scale=this.board_origin_y=this.board_origin_x=0;this.move_current_layer=this.route_current_layer=this.mouse_current_layer=this.default_peice=null;this.flags.bSliding=0;this.flags.bDragging=0;this.flags.bLockLeft=0;this.flags.bLeftChanged=0;this.flags.bLeft=0;this.flags.bLockRight=0;this.flags.bRightChanged=0;this.flags.bRight=
null;this.layerPool=ta();this.OnClose=null}function ua(a,c,d){d=d||"0";a=a.toString(16);return a.length>=c?a:Array(c-a.length+1).join(d)+a}function ia(){for(var a={on:va(),off:va(),range:[]},c=0;8>c;c++)a.range[c]=va(),a.range[c].setColor(`#${ua(0,2)}${ua(223*(8-c)/8,2)}${ua(0,2)}`);a.off.setColor("#707070");return a}function va(){var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("width",66);a.setAttribute("height",66);a.setAttribute("viewBox","-2 -2 68 68");a.innerHTML=
'\n\t\t<defs>\n\t\t\t<radialGradient id="gradient-0" gradientUnits="userSpaceOnUse" cx="-38.806" cy="-32.359" r="31.21" gradientTransform="matrix(0.556701, 0.060335, -0.061948, 0.571572, 35.942307, 40.952184)"><stop offset="0" style="stop-color: rgba(255, 249, 249, 0.72);"></stop><stop offset="1" style="stop-color: rgba(255, 255, 255, 0);"></stop></radialGradient>\n\t\t\t<radialGradient id="gradient-1" gradientUnits="userSpaceOnUse" cx="7.916" cy="20.156" r="31.21" gradientTransform="matrix(1.665372, 0.004509, -0.004806, 1.773443, -10.723868, -25.421527)"><stop offset="0" style="stop-color: rgba(227, 227, 227, 0);"></stop><stop offset="1" style="stop-color: rgba(0, 0, 0, 0.45);"></stop></radialGradient>\n\t\t\t<radialGradient id="gradient-2" gradientUnits="userSpaceOnUse" cx="5.259" cy="16.687" r="31.21" gradientTransform="matrix(1.490671, 0.00387, 0.00009, 1.829344, 1.658628, -19.147887)"><stop offset="0" style="stop-color: rgba(246, 243, 243, 0);"></stop><stop offset="1" style=""></stop></radialGradient>\n\t\t\t<linearGradient id="gradient-4" gradientUnits="userSpaceOnUse" x1="17.355" y1="-22.732" x2="17.355" y2="44.298" gradientTransform="matrix(0.770686, -0.637215, 0.374193, 0.45257, 22.306562, 74.687881)"><stop offset="0" style="stop-color: rgba(227, 227, 227, 0.29);"></stop><stop offset="1" style="stop-color: rgba(0, 0, 0, 0.06);"></stop></linearGradient>\n\t\t</defs>\n\t\t\x3c!--\n\t\t<ellipse style="fill: rgb(255, 0, 255);" cx="63.354" cy="78.071" rx="30.93" ry="30.717"></ellipse>\n\t\t<ellipse style="fill: rgb(0, 0, 255);" cx="63.354" cy="78.071" rx="30.93" ry="30.717"></ellipse>\n\t\t<ellipse style="fill: rgb(128, 0, 0);" cx="63.354" cy="78.071" rx="30.93" ry="30.717"></ellipse>\n\t\t--\x3e\n\t\t<circle ID="nodeColor" style="fill: rgb(35, 232, 0);" cx="32" cy="32" r="30"></circle>\n\t\t<circle style="fill:url(&quot;#gradient-2&quot;); fill-opacity: 0.28;" cx="39" cy="39" r="30" transform="matrix(1.062366, 0, 0, 1.046363, -8.38973, -7.437199)"></circle>\n\t\t<circle style="fill: url(&quot;#gradient-0&quot;); fill-opacity: 0.78;" cx="32" cy="32"  r="30"></circle>\n\t\t<circle style="fill:  url(&quot;#gradient-1&quot;); fill-opacity: 0.68;" cx="32" cy="32" r="30"></circle>\n\t\t<circle style="fill: url(&quot;#gradient-4&quot;);" cx="32" cy="32"  r="30" transform="matrix(1.00693, 0, 0, 0.99307, -0.224218, 0.3336)"></circle>\n\t';
a.setColor=function(c){var d=a.children.nodeColor;d&&(d.style.fill=c)};return a}function xa(){var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("width",66);a.setAttribute("height",66);a.setAttribute("viewBox","100 -5 130 170");a.innerHTML='   \n\t\t\t\t<ellipse cx="164.18392" cy="128.5" fill="#ffffff" id="svg_26" rx="41.17323" ry="12" stroke="#7f7f7f" stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="6"/>\n\t\t\t\t<ellipse cx="164.18392" cy="123.5" fill="#ffffff" id="svg_27" rx="41.17323" ry="12" stroke="#ffffff" stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="6"/>\n\t\t\t\t<ellipse cx="163.35715" cy="120.75" fill="#4558e8" id="svg_24" rx="35.07874" ry="11.25" stroke="#4558e8" stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="6"/>\n\t\t\t\t<rect fill="#4558e8" height="65" id="svg_25" stroke="#cccccc" stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-opacity="0" stroke-width="6" width="75.81102" x="125.62486" y="55.5"/>\n\t\t\t\t<ellipse cx="163.53037" cy="51.5" fill="#ffffff" id="svg_23" rx="41.17323" ry="12" stroke="#cccccc" stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="2"/>\n\t\t\t\t<ellipse cx="163.93392" cy="45.25" fill="#b2b2b2" id="svg_21" rx="41.17323" ry="12" stroke="#cccccc" stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="2"/>\n\n\t\t\t';
return a}function ya(){return'\n\t<g id="iconColor" class="layer" stroke="#DDDD00" fill="#DDDD00" transform="translate( 28,40) scale( 0.60)">\n\t<title>Layer 1</title>\n\t<rect  height="15" id="svg_1" opacity="0.7"  stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="3" width="33" x="17.83333" y="48.5"/>\n\t<path d="m52.033,77.5l-1.033,-42.5c0,0 24.58544,20.66514 25.82504,19.88532c1.2396,-0.77982 -24.79204,22.61468 -24.79204,22.61468z"  id="svg_3" opacity="0.7"  stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="3"/>\n\t<circle cx="93.83333" cy="33.5"  id="svg_4" opacity="0.7" r="2.82843"  stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="3"/>\n\t<circle cx="94.2201" cy="49.05119"  id="svg_5" opacity="0.7" r="2.82843"  stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="3"/>\n\t<circle cx="94.3847" cy="64.51913"  id="svg_6" opacity="0.7" r="2.82843"  stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="3"/>\n\t<circle cx="94.17787" cy="81.27198"  id="svg_7" opacity="0.7" r="2.82843"  stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="3"/>\n </g>\n '}
function za(){return'\n\t<g id="iconColor" class="layer" stroke="#DDDD00" fill="#DDDD00" transform="translate( 36,27) scale( 0.60) ">\n\t <rect height="31"   stroke-opacity="0" stroke-width="5" width="20" x="34.5" y="43.5"/>\n\t <path d="m44.125,98.54167c0,-1 -31.75,-25.25 -31.75,-25.25c0,0 65.25,-0.25 65.125,-0.29167c-0.125,-0.04167 -33.375,26.54167 -33.375,25.54167z"  id="svg_4" stroke="#000000" stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-opacity="0" stroke-width="5"/>\n\t <rect fill="#000000" fill-opacity="0" height="11.25" stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="3" width="25.5" x="31.125" y="106.70833"/>\n\t <rect fill="#000000" fill-opacity="0" height="0.25"  stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="3" width="66.5" x="9.625" y="117.95833"/>\n\t</g>\n\t'}
function Aa(){return'\n\t<g id="iconColor" class="layer" stroke="#FFFF00" transform="translate(40,45) scale( 0.50 )">\n\t<title>Layer 1</title>\n\t<path d="m57.08333,72.08333c2,8 1,18.5 1.5,22.5c0.5,4 -9.5,-1.5 -7.5,5c2,6.5 -12.5,6.5 -10.58333,-0.58333c1.91667,-7.08333 -3.41667,0.58333 -6.41667,-2.41667c-3,-3 5.5,-27 -3.58333,-33.08333c-9.08333,-6.08333 -11.91667,-12.41667 -8.91667,-26.91667c3,-14.5 7,-15 18,-18.5c11,-3.5 18,0 26.91667,9.91667c8.91667,9.91667 7.08333,14.58333 5.08333,24.58333c-2,10 -16.5,11.5 -14.5,19.5z" fill="#000000" fill-opacity="0" id="svg_3" opacity="0.7"  stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="3"/>\n\t<line fill="none" fill-opacity="0"  opacity="0.7"  stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="3" x1="33.58333" x2="58.58333" y1="86.08333" y2="86.08333"/>\n\t<line fill="none" fill-opacity="0"  opacity="0.7"  stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="3" transform="rotate(-1.16913 45.8333 96.3333)" x1="34.08333" x2="57.58333" y1="96.58333" y2="96.08333"/>\n\t </g>\n\t '}
function fa(a){var c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.setAttribute("width",66);c.setAttribute("height",66);c.setAttribute("viewBox","-10 0 150 150");c.innerHTML='\n\t\t\t\t<defs>\n\t\t\t\t<radialGradient id="gradient-0n" gradientUnits="userSpaceOnUse" cx="32.806" cy="38.359" r="31.21" gradientTransform="matrix(0.556701, 0.060335, -0.061948, 0.571572, 35.942307, 40.952184)"><stop offset="0" style="stop-color: rgba(255, 249, 249, 0.72);"></stop><stop offset="1" style="stop-color: rgba(255, 255, 255, 0);"></stop></radialGradient>\n\t\t\t\t<radialGradient id="gradient-1n" gradientUnits="userSpaceOnUse" cx="37.916" cy="50.156" r="31.21" gradientTransform="matrix(1.665372, 0.004509, -0.004806, 1.773443, -10.723868, -25.421527)"><stop offset="0" style="stop-color: rgba(227, 227, 227, 0);"></stop><stop offset="1" style="stop-color: rgba(0, 0, 0, 0.45);"></stop></radialGradient>\n\t\t\t\t<radialGradient id="gradient-2n" gradientUnits="userSpaceOnUse" cx="35.259" cy="46.687" r="31.21" gradientTransform="matrix(1.490671, 0.00387, 0.00009, 1.829344, 1.658628, -19.147887)"><stop offset="0" style="stop-color: rgba(246, 243, 243, 0);"></stop><stop offset="1" style=""></stop></radialGradient>\n\t\t\t\t<linearGradient id="gradient-4n" gradientUnits="userSpaceOnUse" x1="47.355" y1="12.732" x2="47.355" y2="74.298" gradientTransform="matrix(0.770686, -0.637215, 0.374193, 0.45257, 22.306562, 74.687881)"><stop offset="0" style="stop-color: rgba(227, 227, 227, 0.29);"></stop><stop offset="1" style="stop-color: rgba(0, 0, 0, 0.06);"></stop></linearGradient>\n\t\t\t</defs>\n\t\t\t\x3c!--\n\t\t\t<ellipse style="fill: rgb(255, 0, 255);" cx="63.354" cy="78.071" rx="30.93" ry="30.717"></ellipse>\n\t\t\t<ellipse style="fill: rgb(0, 0, 255);" cx="63.354" cy="78.071" rx="30.93" ry="30.717"></ellipse>\n\t\t\t<ellipse style="fill: rgb(128, 0, 0);" cx="63.354" cy="78.071" rx="30.93" ry="30.717"></ellipse>\n\t\t\t<ellipse style="fill: rgb(0, 255, 68);" cx="63.354" cy="78.071" rx="30.93" ry="30.717"></ellipse>\n\t\t\t--\x3e\n\t\t\t<circle style="fill: rgb(225, 195, 135); fill-opacity:0.5" cx="63" cy="78" r="60"></circle>\n\t\t\t<ellipse ID="nodeColor"  style="fill: rgb(255, 255, 0);" cx="63.354" cy="78.071" rx="30.93" ry="30.717"></ellipse>\n\t\t\t<circle   style="fill: url(&quot;#gradient-2n&quot;); fill-opacity: 0.68;" cx="69.539" cy="83.618" r="30.783" transform="matrix(1.062366, 0, 0, 1.046363, -8.38973, -7.437199)"></circle>\n\t\t\t<circle  style="fill: url(&quot;#gradient-0n&quot;); fill-opacity: 0.68;" cx="63.14" cy="78.072" r="30.783"></circle>\n\t\t\t\x3c!--\n\t\t\t<circle style="fill: url(&quot;#gradient-1n&quot;); fill-opacity: 0.68;" cx="63.567" cy="77.218" r="30.783"></circle>\n\t\t\t<circle style="fill: url(&quot;#gradient-4n&quot;);" cx="63.14" cy="78.925" r="30.783" transform="matrix(1.00693, 0, 0, 0.99307, -0.224218, 0.3336)"></circle>\n\t\t\t--\x3e\n\t\t'+
(a?a():"");c.setColor=function(d){var b=c.children.nodeColor;b&&(b.style.fill=d)};c.setIconColor=function(d){var b=c.children.iconColor;b&&(b.style.fill=d,b.style.stroke=d)};return c}function Ia(){function a(){var b=Date.now()/10%500;150>b?b=0:(b-=150,100<b&&250>b?b=100:(250<=b&&(b=350-b),0>b&&(b=0)));c.setSlider(100-b);d=b/100;setTimeout(a,100)}var c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.setAttribute("width",166);c.setAttribute("height",250);c.setAttribute("viewBox","-10 0 150 220");
c.innerHTML='\n\t\t<defs>\n\t\t\t<linearGradient id="gradient-0c" gradientUnits="userSpaceOnUse" x1="37.908" y1="38.388" x2="37.908" y2="76.776"\n\t\t\t\t\tgradientTransform="matrix(0.29251, 0.956262, -1.062492, 0.325005, 98.316635, 28.52927)">\n\t\t\t\t\t<stop offset="0" style="stop-color: rgba(216, 216, 216, 1)"></stop>\n\t\t\t\t\t<stop offset="1" style="stop-color: rgba(165, 165, 165, 1)"></stop>\n\t\t\t</linearGradient>\n\t\t\t<bx-grid x="3.828" y="21.693" width="110.208" height="155.72"></bx-grid>\n\t\t</defs>\n\t\t<rect x="31.67" y="11.879" width="9.597" height="223.023" style="fill: rgb(216, 216, 216);" transform="matrix(1, 0, -0.000002, 1, -14.036083, -4.615945)"></rect>\n\t\t<g style="" transform="matrix(1, 0, 0, 1.070711, -35.728859, 29.265072)">\n\t\t\t<rect x="89.251" y="7.198" width="47.025" height="168.426" style="fill: rgb(216, 216, 216);"></rect><text style="fill: rgb(51, 51, 51); font-size: 11px; white-space: pre;"\n\t\t\t\t\tx="107.966" y="19.673">100</text><text style="fill: rgb(51, 51, 51); font-size: 10px; white-space: pre;" x="114.203"\n\t\t\t\t\ty="85.893" transform="matrix(1, 0, 0, 1, 1.919386, -3.358925)">60<tspan x="114.2030029296875" dy="1em">&#8203;</tspan></text><text\n\t\t\t\t\tstyle="fill: rgb(51, 51, 51); font-size: 10px; white-space: pre;" x="116.342" y="165.32">0</text><text\n\t\t\t\t\tstyle="fill: rgb(51, 51, 51); font-size: 10px; white-space: pre;" x="114.422" y="125.013">30</text><text\n\t\t\t\t\tstyle="fill: rgb(51, 51, 51); font-size: 10px; white-space: pre;" x="114.203" y="85.893" transform="matrix(1, 0, 0, 1, 0.219415, -52.050926)">90<tspan\n\t\t\t\t\t\t\tx="114.2030029296875" dy="1em">&#8203;</tspan></text><text style="fill: rgb(51, 51, 51); font-size: 10px; white-space: pre;"\n\t\t\t\t\tx="113.943" y="152.364">10</text><text style="fill: rgb(51, 51, 51); font-size: 10px; white-space: pre;" x="114.203"\n\t\t\t\t\ty="85.893" transform="matrix(1, 0, 0, 1, 0.699265, 51.595898)">20<tspan x="114.2030029296875" dy="1em">&#8203;</tspan></text><text\n\t\t\t\t\tstyle="fill: rgb(51, 51, 51); font-size: 10px; white-space: pre;" x="114.203" y="85.893" transform="matrix(1, 0, 0, 1, -0.260427, 24.724503)">40<tspan\n\t\t\t\t\t\t\tx="114.2030029296875" dy="1em">&#8203;</tspan></text><text style="fill: rgb(51, 51, 51); font-size: 10px; white-space: pre;"\n\t\t\t\t\tx="114.203" y="85.893" transform="matrix(1, 0, 0, 1, 0.699265, 10.32911)">50<tspan x="114.2030029296875" dy="1em">&#8203;</tspan></text><text\n\t\t\t\t\tstyle="fill: rgb(51, 51, 51); font-size: 10px; white-space: pre;" x="114.203" y="85.893" transform="matrix(1, 0, 0, 1, 0.219419, -19.42137)">70<tspan\n\t\t\t\t\t\t\tx="114.2030029296875" dy="1em">&#8203;</tspan></text><text style="fill: rgb(51, 51, 51); font-size: 10px; white-space: pre;"\n\t\t\t\t\tx="114.203" y="85.893" transform="matrix(1, 0, 0, 1, 0.219419, -36.215992)">80<tspan x="114.2030029296875"\n\t\t\t\t\t\t\tdy="1em">&#8203;</tspan></text><text style="fill: rgb(51, 51, 51); font-size: 10px; white-space: pre; pointer-events: none; visibility: hidden;"\n\t\t\t\t\tx="114.203" y="85.893" transform="matrix(1, 0, 0, 1, 0.219418, -46.772614)">50<tspan x="114.2030029296875"\n\t\t\t\t\t\t\tdy="1em">&#8203;</tspan></text><text transform="matrix(1, 0, 0, 1, 85.63208, -33.816761)" style="fill: rgb(51, 51, 51); font-size: 10px; white-space: pre; visibility: hidden;">\n\t\t\t\t\t<tspan x="114.203" y="85.893" dx="4.319 4.319" dy="7.198">50</tspan>\n\t\t\t\t\t<tspan x="114.203" dy="1em">&#8203;</tspan>\n\t\t\t</text>\n\t\t\t<line style="stroke: rgb(0, 0, 0);" x1="94.53" y1="14.875" x2="107.965" y2="14.395"></line>\n\t\t\t<line style="stroke: rgb(0, 0, 0);" x1="96.449" y1="162.668" x2="112.284" y2="162.188"></line>\n\t\t\t<line style="stroke: rgb(0, 0, 0);" x1="96.449" y1="94.05" x2="113.244" y2="93.57"></line>\n\t\t\t<line style="stroke: rgb(0, 0, 0);" x1="109.792" y1="149.247" x2="101.998" y2="149.586"></line>\n\t\t\t<line style="stroke: rgb(0, 0, 0);" x1="111.825" y1="135.015" x2="103.354" y2="135.354"></line>\n\t\t\t<line style="stroke: rgb(0, 0, 0);" x1="111.487" y1="121.46" x2="105.726" y2="121.46"></line>\n\t\t\t<line style="stroke: rgb(0, 0, 0);" x1="110.809" y1="107.906" x2="104.709" y2="106.212"></line>\n\t\t\t<line style="stroke: rgb(0, 0, 0);" x1="111.148" y1="79.103" x2="104.37" y2="79.442"></line>\n\t\t\t<line style="stroke: rgb(0, 0, 0);" x1="111.148" y1="63.177" x2="104.37" y2="62.499"></line>\n\t\t\t<line style="stroke: rgb(0, 0, 0);" x1="110.809" y1="46.234" x2="104.032" y2="45.895"></line>\n\t\t\t<line style="stroke: rgb(0, 0, 0);" x1="109.115" y1="30.307" x2="99.965" y2="29.968"></line>\n\t\t</g>\n\t\t<g ID="arrow" transform="matrix(1, 0, 0, 1, -13.610993, -12.375999) translate(0,158)">\n\t\t\t<path d="M 49.248 38.071 H 64.916 L 64.916 38.071 L 90.189 55.251 L 64.916 72.431 L 64.916 72.431 H 49.248 V 38.071 Z"\n\t\t\t\t\tdata-bx-shape="arrow 49.248 38.071 40.941 34.36 34.36 25.273 0 1@8e88e44e" style="fill: rgb(223, 32, 32);"\n\t\t\t\t\ttransform="matrix(0.999561, 0.029616, -0.029616, 0.999561, -5.786447, -0.060718)"></path>\n\t\t\t<ellipse style="fill: rgb(216, 216, 216);" cx="38.149" cy="38.868" rx="13.195" ry="4.799"></ellipse>\n\t\t\t<rect x="23.993" y="38.388" width="27.831" height="38.388" style="fill: url(&quot;#gradient-0c&quot;);"></rect>\n\t\t</g> \n\t\t';
c.setSlider=function(b){c.children.arrow.setAttribute("transform",`matrix(1, 0, 0, 1, -13.610993, -12.375999) translate(0,${(100-b)/100*159})`)};var d=0;a();c.getValue=function(){return d};return c}function K(){var a={on:fa(Aa),off:fa(Aa)};a.on.setColor("#0000C0");a.on.setIconColor("#eeeee20");a.off.setColor("#000050");a.off.setIconColor("#000000");return a}function V(){var a={on:fa(za),off:fa(za)};a.on.setColor("#C00000");a.on.setIconColor("#eeeee20");a.off.setColor("#501010");a.off.setIconColor("#000000");
return a}function ja(){var a={on:fa(ya),off:fa(ya)};a.on.setColor("#C00000");a.on.setIconColor("#eeeee20");a.off.setColor("#501010");a.off.setIconColor("#000000");return a}function ca(a,c){function d(b){var e=b.hMenu=na();b.hMenu.appendItem(1,1001,"Add Neuron");b.hMenu.appendItem(1,1011,"Add Oscillator");b.hMenu.appendItem(1,1010,"Add Tick Oscillator");b.hMenu.appendItem(3,b.hMenuComponents=na(),"Add &Component");b.brain.brainStems.forEach(g=>{BuildBrainstemMenus(b.hMenuComponents,g,b.menus,b.connectors,
0)});e.appendItem(4,0,0);e.appendItem(1,1003,"Reset");e.appendItem(1,1002,"RUN");e.appendItem(4,0,0);var f;e.appendItem(3,f=na(),"Zoom");b.menus.push(f);f.appendItem(1,1020,"x1");f.appendItem(1,1021,"x2");f.appendItem(1,1022,"x4");e.appendItem(1,1008,"Default Neuron");e.appendItem(1,1009,"Default Synapse");e.appendItem(1,1012,"Sigmoid Constant")}if(!(this instanceof ca))return new ca(a,c);this.flags={bOwnBrain:!1};this.hMenu;this.hMenuComponents;this.background_methods;this.neuron_methods;this.input_methods;
this.output_methods;this.nerve_methods;this.connectors=[];this.menus=[];this.events={};this.board=new z(c);this.background_methods=L(this);this.neuron_methods=new C(this);this.tick_oscillator_methods=new oa(this);this.oscillator_methods=new pa(this);this.input_methods=new M(this);this.button_input_methods=new aa(this);this.slider_input_methods=new da(this);this.light_output_methods=new ha(this);this.output_methods=new N(this);this.nerve_methods=new T(this);this.brain=a;(function(b){b.InputPeice=null;
b.OutputPeice=null;b.lightOutputPeice=b.board.CreatePeice("light",K(),v.neuron.cells.width,v.neuron.cells.height,(v.neuron.cells.width-1)/2|0,(v.neuron.cells.height-1)/2|0,b.light_output_methods);b.buttonInputPeice=b.board.CreatePeice("button",V(),v.neuron.cells.width,v.neuron.cells.height,(v.neuron.cells.width-1)/2|0,(v.neuron.cells.height-1)/2|0,b.button_input_methods);b.sliderInputPeice=b.board.CreatePeice("slider",ja(),v.neuron.cells.width,v.neuron.cells.height,(v.neuron.cells.width-1)/2|0,(v.neuron.cells.height-
1)/2|0,b.slider_input_methods);b.OscillatorPeice=b.board.CreatePeice("oscil",ia(),v.neuron.cells.width,v.neuron.cells.height,(v.neuron.cells.width-1)/2|0,(v.neuron.cells.height-1)/2|0,b.oscillator_methods);b.TickOscillatorPeice=b.board.CreatePeice("tickosc",ia(),v.neuron.cells.width,v.neuron.cells.height,(v.neuron.cells.width-1)/2|0,(v.neuron.cells.height-1)/2|0,b.tick_oscillator_methods);b.NeuronPeice=b.board.CreatePeice("neuron",ia(),v.neuron.cells.width,v.neuron.cells.height,(v.neuron.cells.width-
1)/2|0,(v.neuron.cells.height-1)/2|0,b.neuron_methods);var e=document.createElement("img");e.src=v.pathway.image;var f=document.createElement("img");f.src=v.pathway.imageNeg;b.NervePeice=b.board.CreateVia("nerve",e,f,b.nerve_methods);b.BackgroundPeice=null;b.board.SetCellSize(16,16);b.brain?b.flags.bOwnBrain=0:(b.flags.bOwnBrain=1,b.brain=new BRAIN);b.board.SetCellSize(v.cell.width,v.cell.height);e=document.createElement("img");e.src=v.background.image;b.BackgroundPeice=b.board.CreatePeice("background",
e,v.background.cells.width,v.background.cells.height,(v.background.cells.width-1)/2|0,(v.background.cells.height-1)/2|0,b.background_methods);b.board.SetBackground(b.BackgroundPeice);b.connectors=[];b.menus.length||d(b);b.DefaultNeuron=b.brain.Neuron();b.DefaultSynapse=b.brain.Synapse()})(this);this.reset=function(){this.board.SetBackground(this.BackgroundPeice);this.board.reset();this.scale=0};this.scale=0}function T(a){if(!(this instanceof T))return new MERVE_METHODS(a);this.brainboard=a;this.synapse=
null}function M(a){if(!(this instanceof M))return new M(a);this.brainboard=a;this.level_colors=[]}function N(a){if(!(this instanceof N))return new N(a);this.brainboard=a;this.level_colors=[]}function C(a){this.brainboard=a;this.c_input=[];this.c_threshold=[];this.connected=[]}function ha(a){if(!(this instanceof ha))return new ha(a);C.call(this,a);this.brainboard=a}function aa(a){if(!(this instanceof aa))return new aa(a);C.call(this,a);this.brainboard=a}function da(a){if(!(this instanceof da))return new da(a);
C.call(this,a);this.brainboard=a}function L(a){if(!(this instanceof L))return new L(a);this.brainboard=a}function pa(a){this.brainboard=a}function oa(a){this.brainboard=a}function na(){var a={items:[],parent:null,container:document.createElement("div"),board:null,appendItem(c,d,b){if(c&4){var e=document.createElement("HR");this.container.appendChild(e)}else{e=document.createElement("A");var f=document.createElement("BR");this.container.appendChild(e);this.container.appendChild(f);e.value=d;e.textContent=
b;e.className="popup";c&2?(d.parent=this,e.addEventListener("mouseover",g=>{var h=e.getBoundingClientRect();console.log("Item is clicked show that.",g.target.value,g.clientX,g.clientY);e.value.show(this.board,g.clientX,h.top-10,this.cb)}),e.addEventListener("mouseout",g=>{var h=e.getBoundingClientRect();console.log("Item is clicked show that.",g.target.value,g.clientX,h.top);g.toElement!==e.value.container&&e.value.hide()})):e.addEventListener("click",g=>{this.cb(g.target.value);console.log("Item is clicked.",
g.target.value);this.hide(!0)})}},hide(c){this.container.style.visibility="hidden";this.parent?c&&this.parent.hide(c):ka.style.visibility="hide"},show(c,d,b,e){this.board=c;this.cb=e;ka.style.visibility="visible";this.container.style.visibility="inherit";this.container.style.left=d;this.container.style.top=b},reset(){console.log("hide everything?")}};ka.appendChild(a.container);a.container.className="popup";a.container.style.zIndex=50;return a}function Ba(a){function c(){var t=b.children.drivePivot,
r=Date.now()/1E3,m;t.setAttribute("cx",m=d.x+20*Math.sin(-r%(1/a)*2*Math.PI*a));t.setAttribute("cy",r=d.y+20*Math.cos(r%(1/a)*2*Math.PI*a));t=r+Math.sqrt(6400-(m-d.x)*(m-d.x));m=`M${m},${r} L${d.x},${t}`;g.setAttribute("d",m);m=`M${d.x},${t} L${d.x},${t+10}`;t+=10;h.setAttribute("d",m);m=140;t>m?(m=t,q=1):q=0;m=`M${d.x-10},${m} L${d.x+10},${m}`;l.setAttribute("d",m);requestAnimationFrame(c)}var d={x:50,y:50},b=document.createElementNS("http://www.w3.org/2000/svg","svg");b.style.width=100;b.style.height=
175;var e=document.createElementNS("http://www.w3.org/2000/svg","circle");e.id="driveRotor";e.setAttribute("r","40");e.setAttribute("cx","50");e.setAttribute("cy","50");e.setAttribute("fill","yellow");var f=document.createElementNS("http://www.w3.org/2000/svg","circle");f.id="drivePivot";f.setAttribute("r","4");f.setAttribute("fill","black");var g=document.createElementNS("http://www.w3.org/2000/svg","path");g.classList.add("switcher");g.id="driveArm";g.setAttribute("stroke","blue");g.setAttribute("stroke-width",
"10");g.setAttribute("stroke-linecap","round");var h=document.createElementNS("http://www.w3.org/2000/svg","path");h.classList.add("switcher");h.id="driveRod";h.setAttribute("stroke","blue");h.setAttribute("stroke-width","5");h.setAttribute("stroke-linecap","round");h.setAttribute("stroke-linecap","round");var l=document.createElementNS("http://www.w3.org/2000/svg","path");l.id="buttonPad";l.setAttribute("stroke","red");l.setAttribute("stroke-width","10");l.setAttribute("stroke-linecap","round");
b.appendChild(e);b.appendChild(f);b.appendChild(g);b.appendChild(h);b.appendChild(l);var q=0;c();b.getValue=function(){return q};return b}function Ja(a,c,d,b){var e=document.createElementNS("http://www.w3.org/2000/svg","path");const f=d-30;e.setAngle=function(g){350<g&&(g=350);2>g&&(g=2);var h=Math.PI/180*g,l=a+Math.sin(h)*f,q=c-Math.cos(h)*f;h=" M "+(a+0)+" "+(c-d)+` A ${d} ${d}, 0, ${180>g?0:1}, 1, ${a+Math.sin(h)*d} ${c-Math.cos(h)*d} `;h=h+` L ${l} ${q}`+` A ${f} ${f}, 0, ${180>g?0:1}, 0, ${a+
0} ${c-f} `;h+="Z";e.setAttribute("d",h)};e.setAngle(0);return e}function Ka(a){function c(){l.setAngle(q);t&&(q-=3);0>q&&(q=0,r=t=!1,a(!0,!1));setTimeout(c,100)}function d(){r?(t=!0,a(!1,!0),h.setAttribute("fill","#f53230")):(t=!1,a(!1,!1),h.setAttribute("fill","#a51210"),q=360)}var b=document.createElementNS("http://www.w3.org/2000/svg","svg");b.style.width=250;b.style.height=125;var e=document.createElementNS("http://www.w3.org/2000/svg","rect");e.setAttribute("x","0");e.setAttribute("y","0");
e.setAttribute("width","200");e.setAttribute("height","125");e.setAttribute("stroke","none");e.setAttribute("fill","#d0c090");b.appendChild(e);e=document.createElementNS("http://www.w3.org/2000/svg","rect");e.setAttribute("x","5");e.setAttribute("y","5");e.setAttribute("width","190");e.setAttribute("height","115");e.setAttribute("stroke","black");e.setAttribute("fill","none");b.appendChild(e);e=document.createElementNS("http://www.w3.org/2000/svg","defs");var f=document.createElementNS("http://www.w3.org/2000/svg",
"pattern");f.id="transformedPattern";f.setAttribute("x",20);f.setAttribute("y",10);f.setAttribute("width",5);f.setAttribute("height",5);f.setAttribute("patternUnits","userSpaceOnUse");f.setAttribute("patternTransform","rotate(15)");e.appendChild(f);var g=document.createElementNS("http://www.w3.org/2000/svg","rect");g.setAttribute("x","0");g.setAttribute("y","0");g.setAttribute("width","30");g.setAttribute("height","2");g.setAttribute("stroke","black");g.setAttribute("fill","none");f.appendChild(g);
g=document.createElementNS("http://www.w3.org/2000/svg","rect");g.setAttribute("x","0");g.setAttribute("y","0");g.setAttribute("width","2");g.setAttribute("height","20");g.setAttribute("fill","black");f.appendChild(g);g=document.createElementNS("http://www.w3.org/2000/svg","circle");g.setAttribute("cx","10");g.setAttribute("cy","10");g.setAttribute("r","10");g.setAttribute("fill","black");b.appendChild(e);var h=document.createElementNS("http://www.w3.org/2000/svg","circle");h.id="testButton";h.setAttribute("r",
"15");h.setAttribute("cx","50");h.setAttribute("cy","50");h.setAttribute("fill","#a51210");h.setAttribute("stroke","white");h.setAttribute("stroke-width","5");b.appendChild(h);e=document.createElementNS("http://www.w3.org/2000/svg","text");e.textContent="TEST";e.setAttribute("x","22");e.setAttribute("y","100");e.setAttribute("font-size","24px");e.setAttribute("font-style","sans-serif");e.setAttribute("stroke","black");b.appendChild(e);var l=Ja(125,60,45);l.setAttribute("fill","red");l.setAttribute("stroke",
"black");l.setAttribute("stroke-width","2");b.appendChild(l);var q=360,t=!1;c();var r=!1;b.addEventListener("click",m=>{m.preventDefault();r=!r;d()});b.reset=function(){q=360;t=!1;a(!1,!1);r=!1;d()};return b}function La(a){function c(){var h,l=Date.now(),q=l-g,t,r=0;e.forEach((m,w)=>{m.history.push({del:q,value:a(w)});r=3==w?45:20;h="M390,"+(r+20+20*w);t=0;for(var B=m.history.length-1;0<B;B--){if(15E3<t){m.history.splice(0,B);break}var G=m.history[B];h+="L"+(390-(t+G.del)/15E3*340)+","+(20+r+20*w-
G.value/10);t+=G.del}m.path.setAttribute("d",h)});f.forEach((m,w)=>{m.history.push({del:q,value:a(4+w)});h="M390,"+(135+20*w);t=0;r=15;for(var B=m.history.length-1;0<B;B--){if(15E3<t){m.history.splice(0,B);break}var G=m.history[B];h+="L"+(390-(t+G.del)/15E3*340)+","+(20+r+115+20*w-G.value/10);t+=G.del}m.path.setAttribute("d",h)});g=l;setTimeout(c,100)}var d=document.createElementNS("http://www.w3.org/2000/svg","svg");d.style.width=420;d.style.height=330;var b=document.createElementNS("http://www.w3.org/2000/svg",
"rect");b.setAttribute("x","0");b.setAttribute("y","0");b.setAttribute("width","420");b.setAttribute("height","230");b.setAttribute("stroke","none");b.setAttribute("fill","#d0c090");d.appendChild(b);b=document.createElementNS("http://www.w3.org/2000/svg","rect");b.setAttribute("x","5");b.setAttribute("y","5");b.setAttribute("width","410");b.setAttribute("height","220");b.setAttribute("stroke","black");b.setAttribute("fill","none");d.appendChild(b);b=document.createElementNS("http://www.w3.org/2000/svg",
"circle");b.id="logicJack";b.setAttribute("r","5");b.setAttribute("cx","22");b.setAttribute("cy","40");b.setAttribute("fill","#657210");b.setAttribute("stroke","#805040");b.setAttribute("stroke-width","2");d.appendChild(b);b=document.createElementNS("http://www.w3.org/2000/svg","circle");b.id="logicJack";b.setAttribute("r","5");b.setAttribute("cx","22");b.setAttribute("cy","60");b.setAttribute("fill","#657210");b.setAttribute("stroke","#805040");b.setAttribute("stroke-width","2");d.appendChild(b);
b=document.createElementNS("http://www.w3.org/2000/svg","circle");b.id="logicJack";b.setAttribute("r","5");b.setAttribute("cx","22");b.setAttribute("cy","80");b.setAttribute("fill","#657210");b.setAttribute("stroke","#805040");b.setAttribute("stroke-width","2");d.appendChild(b);b=document.createElementNS("http://www.w3.org/2000/svg","circle");b.id="logicJack";b.setAttribute("r","5");b.setAttribute("cx","22");b.setAttribute("cy","100");b.setAttribute("fill","#657210");b.setAttribute("stroke","#805040");
b.setAttribute("stroke-width","2");d.appendChild(b);b=document.createElementNS("http://www.w3.org/2000/svg","rect");b.setAttribute("x","45");b.setAttribute("y","15");b.setAttribute("width","350");b.setAttribute("height","200");b.setAttribute("stroke","white");b.setAttribute("fill","black");b.setAttribute("stroke-width","2");d.appendChild(b);var e=[{history:[],path:document.createElementNS("http://www.w3.org/2000/svg","path")},{history:[],path:document.createElementNS("http://www.w3.org/2000/svg",
"path")},{history:[],path:document.createElementNS("http://www.w3.org/2000/svg","path")},{history:[],path:document.createElementNS("http://www.w3.org/2000/svg","path")}],f=[{history:[],path:document.createElementNS("http://www.w3.org/2000/svg","path")},{history:[],path:document.createElementNS("http://www.w3.org/2000/svg","path")},{history:[],path:document.createElementNS("http://www.w3.org/2000/svg","path")},{history:[],path:document.createElementNS("http://www.w3.org/2000/svg","path")}];e.forEach((h,
l)=>{3==l?h.path.setAttribute("stroke","yellow"):h.path.setAttribute("stroke","red");d.appendChild(h.path)});f.forEach((h,l)=>{h.path.setAttribute("stroke","skyblue");d.appendChild(h.path)});var g=Date.now();c();return d}function Ca(a){var c=document.createElement("IMG");c.src=a;c.style.width="100%";return c}function Da(){la.step();setTimeout(Da,1)}function Ea(a,c,d){a=k.board.PutPeice(k.sliderInputPeice,c,d,()=>A[2].getValue());k.events.added&&k.events.added(k.sliderInputPeice,a)}function J(a,c,
d){c=k.board.PutPeice(k.buttonInputPeice,c,d,()=>a<A.length?A[a].getValue():0);k.events.added&&k.events.added(k.buttonInputPeice,c)}function F(a,c,d){a=k.board.PutPeice(k.lightOutputPeice,c,d,b=>b);x.push(a);k.events.added&&k.events.added(k.lightOutputPeice,a)}function Ma(){p.getExpectedValue=()=>100*(A[0].getValue()&A[1].getValue())}function Na(){I.clear();k.reset();x.length=0;F(0,15,10);p.getExpectedValue=()=>100*A[0].getValue();p.getTestValue=()=>100*x[0].value}function Oa(){I.clear();k.reset();
J(0,2,10);x.length=0;F(0,15,10);F(1,15,15);p.getExpectedValue=()=>200*A[0].getValue();p.getTestValue=()=>100*x[0].value+100*x[1].value}function Pa(){I.clear();k.reset();J(0,2,9);J(1,2,15);x.length=0;F(0,15,6);F(1,15,10);F(2,15,14);F(3,15,18);p.getExpectedValue=()=>100*(A[0].getValue()+A[1].getValue());p.getTestValue=()=>50*x[0].value+50*x[1].value+50*x[2].value+50*x[3].value}function Qa(){I.clear();k.reset();Ea(0,2,12);x.length=0;F(0,15,12);p.getExpectedValue=()=>.5<A[2].getValue()?100:0;p.getTestValue=
()=>100*x[0].value}function Ra(){I.clear();k.reset();Ea(0,2,12);x.length=0;F(0,15,6);F(1,15,10);F(2,15,14);F(3,15,18);p.getExpectedValue=()=>.8<A[2].getValue()?200:.6<A[2].getValue()?150:.4<A[2].getValue()?100:.2<A[2].getValue()?50:0;p.getTestValue=()=>50*x[0].value+50*x[1].value+50*x[2].value+50*x[3].value}function Sa(){I.clear();k.reset();x.length=0;J(0,2,9);J(1,2,15);F(0,15,12);p.getExpectedValue=()=>A[0].getValue()||A[1].getValue()?100:0;p.getTestValue=()=>100*x[0].value}function Ta(){I.clear();
k.reset();x.length=0;J(0,2,9);J(1,2,15);F(0,15,12);p.getExpectedValue=()=>A[0].getValue()&&A[1].getValue()?100:0;p.getTestValue=()=>100*x[0].value}function Ua(){I.clear();k.reset();x.length=0;J(0,2,9);J(1,2,15);F(0,15,12);p.getExpectedValue=()=>!A[0].getValue()&&A[1].getValue()?100:0;p.getTestValue=()=>100*x[0].value}function Va(){I.clear();k.reset();x.length=0;J(0,2,9);F(0,15,9);p.getExpectedValue=()=>A[0].getValue()?0:100;p.getTestValue=()=>100*x[0].value}function Wa(){I.clear();k.reset();x.length=
0;J(0,2,9);J(1,2,15);F(0,15,12);p.getExpectedValue=()=>!!A[0].getValue()^!!A[1].getValue()?100:0;p.getTestValue=()=>100*x[0].value}function qa(a,c){function d(){var g;return(g=k.board.GetLayerAt(a,c,null))||(g=k.board.GetLayerAt(a+1,c,null))||(g=k.board.GetLayerAt(a-1,c,null))||(g=k.board.GetLayerAt(a,c+1,null))||(g=k.board.GetLayerAt(a+1,c+1,null))||(g=k.board.GetLayerAt(a-1,c+1,null))||(g=k.board.GetLayerAt(a,c-1,null))||(g=k.board.GetLayerAt(a+1,c-1,null))?g:(g=k.board.GetLayerAt(a-1,c-1,null))?
g:null}var b=d();if(!b)return{x:a,y:c};var e,f;for(f=1;14>f;f++){a+=4;c-=4;b=d();if(!b)break;for(e=0;e<2*f;e++)if(c+=4,b=d(),!b)return{x:a,y:c};for(e=0;e<2*f;e++)if(a-=4,b=d(),!b)return{x:a,y:c};for(e=0;e<2*f;e++)if(c-=4,b=d(),!b)return{x:a,y:c};for(e=0;e<2*f-1;e++)if(a+=4,b=d(),!b)return{x:a,y:c};a+=4}return{x:a,y:c}}function Fa(){k.board.BoardRefresh();requestAnimationFrame(Fa)}function ma(a){if(!(p.progressLocked&&a>p.journalState)){Ga.reset();p.journalState=a;a>p.journalStateMax&&(p.journalStateMax=
a,localStorage.setItem("maxPage",p.journalStateMax));p.progressLocked=W[p.journalState].locked||!1;ba.innerHTML=W[p.journalState].HTML;if(a=ba.querySelector('[id="pageNum"]'))a.textContent=""+(p.journalState+1);W[p.journalState].activate&&W[p.journalState].activate()}}u.algo={digital:0,analog:1,sigmoid:2};Object.seal(u.algo);u.prototype.clone=function(){var a=new u(this.brain);a.threshold=this.threshold;a.cycle=this.cycle;a.type=this.type;return a};u.prototype.output=function(a){switch(this.algorithm){case u.algo.analog:return a-=
this.threshold,1<a&&(a=1),0>a&&(a=0),a;case u.algo.digital:return a>this.threshold?1:0;case u.algo.sigmoid:return a=1/(1+Math.exp(-this.k*(a-this.threshold))),0>=a?a=0:1<a&&(a=1),a}};Object.defineProperty(u.prototype,"value",{get:function(){this.cycle!=this.brain.cycle&&(this.cycle=this.brain.cycle,this.input=this.inputs.reduce((a,c)=>a+(c?c.value:0),0));if(this.input>this.threshold)return this.on=!0,this.output(this.input);this.on=!1;return 0}});u.prototype.attachSynapse=function(a){return void 0!==
a?{nerves:this.inputs,id:a}:{nerves:this.inputs,id:this.inputs.length}};u.prototype.attachSynapseFrom=function(a){return void 0!==a?{nerves:this.outputs,id:a}:{nerves:this.outputs,id:this.outputs.length}};u.prototype.detachSynapse=function(a){var c=this.inputs.findIndex(d=>d===a);0<=c&&(this.inputs[c]=null)};u.prototype.detachSynapseFrom=function(a){var c=this.outputs.findIndex(d=>d===a);0<=c&&(this.outputs[c]=null)};u.prototype.attach=function(a){var c=this.brain.Synapse();this.inputs.push(c);a.outputs.push(c);
c.input=a;c.output=this;this.brain.changed=!0;return c};u.prototype.detach=function(a){if(a){var c=this.inputs.findIndex(b=>b.input===a?!0:!1);if(0>c){if(c=this.outputs.findIndex(b=>b.output===a?!0:!1),0<=c){var d=this.outputs[c];this.outputs.splice(c,1);d.output.inputs.find((b,e)=>b===d?(d.output.inputs.splice(e,1),!0):!1)}}else d=this.inputs[c],this.inputs.splice(c,1),d.input.outputs.find((b,e)=>b===d?(d.input.outputs.splice(e,1),!0):!1)}else{for(;this.inputs.length;)this.detach(this.inputs[0].input);
for(;this.outputs.length;)this.detach(this.outputs[0].output)}this.brain.changed=!0};ea.prototype=Object.create(u);ea.prototype.output=function(a){return 1/(1+Math.exp(-this.k))};ea.prototype.clone=function(){u.prototype.clone.call(this).k=n.k};X.prototype=Object.create(u.prototype);X.prototype.output=function(a){return 1/(1+Math.exp(-this.k))};Object.defineProperty(X.prototype,"value",{get:function(){return Math.sin(2*Math.PI*(this.freq*Date.now()/1E3%1))}});X.prototype.clone=function(){u.prototype.clone.call(this).freq=
this.freq};Y.prototype=Object.create(u.prototype);Y.prototype.output=function(a){return 1/(1+Math.exp(-this.k))};Object.defineProperty(Y.prototype,"value",{get:function(){return Math.sin(2*this.brain.cycle*Math.PI/this.freq)}});Y.prototype.clone=function(){u.prototype.clone.call(this).ticks=n.ticks};U.prototype=Object.create(u.prototype);U.prototype.output=function(a){return a};Object.defineProperty(U.prototype,"value",{get:function(){return this.inputs=this.cb()}});U.prototype.clone=function(){return new U(this.brain,
this.cb)};Z.prototype=Object.create(u.prototype);Z.prototype.output=function(a){a=this.cb(a);this.on=!!a;return a};Z.prototype.clone=function(){return new Z(this.brain,this.cb)};var Ha=Object.freeze({__proto__:null,Neuron:u,Sigmoid:ea,Oscillator:X,TickOscillator:Y,External:U,Exporter:Z,"default":{Neuron:u,Oscillator:X,TickOscillator:Y,External:U,Exporter:Z}});Object.defineProperty(R.prototype,"value",{get:function(){return this.input?this.gain*this.input.value:0}});R.prototype.clone=function(){var a=
new R;a.gain=this.gain;return a};R.prototype.AttachSource=function(a,c){if(!c&&a)for(var d=0;!(c=a.AttachSynapse(d))&&d<MAX_NERVES;d++);return!this.input&&a&&c?(c.nerves[c.id]=this,this.input=a,!0):!1};R.prototype.AttachDestination=function(a,c){if(!c&&a)for(var d=0;!(c=a.AttachSynapse(d))&&d<MAX_NERVES;d++);return!this.output&&a&&c?(c.nerves[c.id]=this,this.output=a,!0):!1};R.prototype.DetachDestination=function(){var a=this.output;a&&(this.output=null,a.detachSynapse(this))};R.prototype.DetachSource=
function(){var a=this.input;a&&(this.input=null,a.detachSynapseFrom(this))};var v={cell:{width:48,height:48},background:{cells:{width:5,height:5},image:"board/images/background2.gif"},neuron:{cells:{width:3,height:3},image:"board/images/neuron.png",colors:[[240,0,15790080],[15728640,7566195,61440]]},input:{cells:{width:3,height:3},image:"board/images/input.gif"},output:{cells:{width:3,height:3},image:"board/images/output.gif"},pathway:{cells:{width:7,height:7},image:"board/images/AlphaNerves.png",
imageNeg:"board/images/AlphaNerves-neg.png"}};const D={NOWHERE:-1,UP:0,UP_RIGHT:1,RIGHT:2,DOWN_RIGHT:3,DOWN:4,DOWN_LEFT:5,LEFT:6,UP_LEFT:7};Object.freeze(D);const O=[{x:0,y:-1},{x:1,y:-1},{x:1,y:0},{x:1,y:1},{x:0,y:1},{x:-1,y:1},{x:-1,y:0},{x:-1,y:-1}];Object.freeze(O);O.forEach(a=>Object.freeze(a));S.prototype.getimage=function(){return this.image};S.prototype.getcell=function(a,c){this.lastCell.coords=this.grid[a%this.size.cols][c%this.size.rows];return this.lastCell};S.prototype.getCellSize=function(){return this.cellSize};
S.prototype.getsize=function(){return this.size};S.prototype.gethotspot=function(){return this.hot};P.prototype=Object(S.prototype);P.prototype.constructor=P;P.prototype.GetViaEnd=function(a,c){switch(a){case 7:return this.getcell(2,2,c);case 0:return this.getcell(3,2,c);case 1:return this.getcell(4,2,c);case 2:return this.getcell(4,3,c);case 3:return this.getcell(4,4,c);case 4:return this.getcell(3,4,c);case 5:return this.getcell(2,4,c);case 6:return this.getcell(2,3,c);case -1:return this.getcell(3,
3,c)}return null};P.prototype.GetViaFill1=function(a,c,d,b){a={x:0,y:0,cell:null};switch(d){case 7:a.x=0;a.y=-1;a.cell=this.getcell(5,0,b);break;case 3:a.x=1;a.y=0;a.cell=this.getcell(5,0,b);break;case 1:a.x=0;a.y=-1;a.cell=this.getcell(1,0,b);break;case 5:a.x=-1,a.y=0,a.cell=this.getcell(1,0,b)}return a};P.prototype.GetViaFill2=function(a,c,d,b){a={x:0,y:0,cell:null};switch(d){case 7:return a.x=-1,a.y=0,a.cell=this.getcell(4,1,b),a;case 3:return a.x=0,a.y=1,a.cell=this.getcell(4,1,b),a;case 1:return a.x=
1,a.y=0,a.cell=this.getcell(2,1,b),a;case 5:return a.x=0,a.y=1,a.cell=this.getcell(2,1,b),a}return null};P.prototype.GetViaStart=function(a,c){switch(a){case 7:return this.getcell(6,6,c);case 0:return this.getcell(3,5,c);case 1:return this.getcell(0,6,c);case 2:return this.getcell(1,3,c);case 3:return this.getcell(0,0,c);case 4:return this.getcell(3,1,c);case 5:return this.getcell(6,0,c);case 6:return this.getcell(5,3,c);case -1:return this.getcell(3,3,c)}return null};P.prototype.GetViaFromTo=function(a,
c,d){if(-1==a)return this.GetViaStart(c,d);if(-1==c)return this.GetViaEnd(a,d);switch(a|c<<4){case 22:case 97:return this.getcell(4,6,d);case 38:case 98:return this.getcell(3,0,d);case 39:case 114:return this.getcell(2,6,d);case 54:case 99:return this.getcell(4,0,d);case 55:case 115:return this.getcell(5,1,d);case 48:case 3:return this.getcell(0,4,d);case 71:case 116:return this.getcell(6,2,d);case 64:case 4:return this.getcell(0,3,d);case 65:case 20:return this.getcell(0,2,d);case 80:case 5:return this.getcell(6,
4,d);case 81:case 21:return this.getcell(1,1,d);case 82:case 37:return this.getcell(2,0,d)}return null};P.prototype.Move=function(){return 0};P.prototype.Stop=function(){return 0};y.prototype.Move=function(){return!1};y.prototype.Stop=function(){return!1};y.prototype.name=function(){return"default methods"};y.prototype.SetPeice=function(a){this.master=a};y.prototype.getimage=function(){return this.master.getimage()};y.prototype.getcell=function(a,c){return this.master.getcell(a,c)};y.prototype.getimage=
function(a){return this.master.getimage(a)};y.prototype.getcell=function(a,c,d){return this.master.getcell(a,c,d)};y.prototype.gethotspot=function(){return this.master.gethotspot()};y.prototype.getsize=function(){return this.master.getsize()};y.prototype.Create=function(a){return 0};y.prototype.Disconnect=function(a){return 0};y.prototype.Destroy=function(a){};y.prototype.Update=function(a,c){};y.prototype.OnMove=function(a){};y.prototype.ConnectBegin=function(a,c,d,b,e){return!1};y.prototype.ConnectEnd=
function(a,c,d,b,e){return!1};y.prototype.OnClick=function(a,c,d){return!1};y.prototype.OnRightClick=function(a,c,d){return!1};y.prototype.OnDoubleClick=function(a,c,d){return!1};y.prototype.Draw=function(a,c,d,b,e){d.drawImage(a.image,b,e,this.master.size.cols*this.brainboard.board.cellSize.width,this.master.size.rows*this.brainboard.board.cellSize.height)};y.prototype.DrawCell=function(a,c,d,b,e,f){"on"in this.master.image?d.drawImage(this.master.image.on,b.coords.x,b.coords.y,b.size.width,b.size.height,
e,f,this.brainboard.board.cellSize.width,this.brainboard.board.cellSize.height):d.drawImage(this.master.image,b.coords.x,b.coords.y,b.size.width,b.size.height,e,f,this.brainboard.board.cellSize.width,this.brainboard.board.cellSize.height)};Q.prototype=Object(y.prototype);Q.prototype.constructor=Q();Q.prototype.Move=function(){return 0};Q.prototype.Stop=function(){return 0};Q.prototype.OnClick=function(a,c,d){console.log("GENERATE DISCONNECT!");this.master.board.UnendPath();return 0};Q.prototype.OnRightClick=
function(a,c,d){return 0};Q.prototype.OnDoubleClick=function(a,c,d){return 0};E.prototype.IsLayerAt=function(a,c){var d,b;if(this.flags.bRoot||this.min_x+this.w<=a||this.min_y+this.h<=c||this.min_x>a||this.min_y>c)return null;if(!this.flags.bRoute)return{x:a-this.x,y:c-this.y};for(b=0;d=this.pds_path[this.pds_path.length-1-b];b++)if(d.x+this.x==a&&d.y+this.y==c)return{x:d.x,y:d.y};return null};E.prototype.link_top=function(){var a;if(a=this.board.rootLayer){if(this.next=a.next)this.next.prior=this;
this.prior=null;a.next||(a.prior=this);a.next=this}};E.prototype.Link=function(a,c,d,b){void 0===d&&(d=0);void 0===b&&(b=0);this.linked.push(a);switch(c){case 0:a.route_start_layer.layer=this;a.route_start_layer.x=d;a.route_start_layer.y=b;break;case 1:a.flags.bEnded=!0,a.route_end_layer.layer=this,a.route_end_layer.x=d,a.route_end_layer.y=b}};E.prototype.Unlink=function(){if(this.route_end_layer.layer){this.flags.bEnded=!1;var a=this.route_end_layer.layer.linked.findIndex(c=>c===this);0<=a&&this.route_end_layer.layer.linked.splice(a,
1);this.route_end_layer.layer=null}else this.route_start_layer.layer&&(a=this.route_start_layer.layer.linked.findIndex(c=>c===this),0<=a&&this.route_start_layer.layer.linked.splice(a,1),this.route_start_layer.layer=null)};E.prototype.Draw=function(a,c,d,b){if(!this.flags.bRoot){this.scale=a.GetScale();a.GetSize();var e=a.GetCellSize();if(this.flags.bRoute){var f=this.peice;this.pds_path.forEach(r=>{var m;a.selected===this.psvInstance&&c.fillRect(d+r.x*e.width,b+r.y*e.height,e.width,e.height);(m=f.GetViaFromTo(r.flags.BackDir,
r.flags.ForeDir,void 0))&&this.peice.methods.DrawCell(this.peice,this.psvInstance,c,m,d+r.x*e.width,b+r.y*e.height);(m=f.GetViaFill1(void 0,void 0,r.flags.ForeDir,void 0))&&m.cell&&this.peice.methods.DrawCell(this.peice,this.psvInstance,c,m.cell,d+(r.x+m.x)*e.width,b+(r.y+m.y)*e.height);(m=f.GetViaFill2(void 0,void 0,r.flags.ForeDir,void 0))&&m.cell&&this.peice.methods.DrawCell(this.peice,this.psvInstance,c,m.cell,d+(r.x+m.x)*e.width,b+(r.y+m.y)*e.height)})}else{var g,h,l=this.peice.gethotspot(),
q=this.peice.getsize();for(g=-l.x;g<q.cols-l.x;g++)for(h=-l.y;h<q.rows-l.y;h++){var t=this.peice.methods.master.getcell(g+l.x,h+l.y);a.selected===this.psvInstance&&c.fillRect(d+g*e.width,b+h*e.height,e.width,e.height);this.peice.methods.DrawCell(this.peice,this.psvInstance,c,t,d+g*e.width,b+h*e.height)}}}};E.prototype.GetPeice=function(){return this.peice};E.prototype.FindLayer=function(a){return pool.find(c=>c.iLayer==-a?c:0)};E.prototype.BeginPath=function(a,c,d){void 0===d&&(d=D.NOWHERE);var b=
sa();this.x=a;this.y=c;this.min_x=a;this.min_y=c;this.h=this.w=1;this.pds_path.length=0;b.x=0;b.y=0;b.flags.BackDir=D.NOWHERE;d==D.NOWHERE?(this.flags.bForced=0,b.flags.bForced=0,b.flags.ForeDir=D.NOWHERE):(this.flags.bForced=1,b.flags.bForced=1,b.flags.ForeDir=d);this.pds_path.push(b)};E.prototype.LayPath=function(a,c){var d=0;var b=this.pds_path[this.pds_path.length-1];a-=this.x;c-=this.y;if(b){if(b.x==a&&b.y==c)return;if(100<Math.abs(b.x-a)||100<Math.abs(b.y-c))DebugBreak(),console.log("Laying a LONG path - is this okay?!")}for(b=
this.pds_path[this.pds_path.length-1];b;){var e=this.FindDirection(b.x,b.y,a,c);if(e==D.NOWHERE)break;if(b.flags.BackDir==D.NOWHERE){if(b.flags.ForeDir!=e&&this.flags.bForced){console.log("Have a forced begin point, and no way to get there from here....");DebugBreak();10==wa(b.flags.ForeDir,e)?(console.log("MUST go %d , have to go %d from here.  Go nowhere.",b.flags.ForeDir,e),console.log("Okay - consider a arbitrary jump to go forward... until we can go backward.")):console.log("It's just not quite right... return, a less radical assumption may be made.");
break}b.flags.ForeDir=e}else if(10!=wa(e,b.flags.BackDir+4&7))b.flags.ForeDir=e;else{console.log("Unlay path cause we can't get there from here.");b=this.UnlayPath(d+1);d=1;continue}var f;var g=b.x+O[b.flags.ForeDir].x;e=b.y+O[b.flags.ForeDir].y;(f=this.Overlaps(g,e))?(console.log("Unlaying path %d steps to overlap",f),b=this.UnlayPath(f)):(f=new sa,f.flags.bForced=!1,f.flags.ForeDir=D.NOWHERE,f.flags.BackDir=b.flags.ForeDir+4&7,f.x=g,f.y=e,b=g+this.x,e+=this.y,b<this.min_x&&(this.w+=this.min_x-b,
this.min_x=b),b>=this.min_x+this.w&&(this.w=b-this.min_x+1),e<this.min_y&&(this.h+=this.min_y-e,this.min_y=e),e>=this.min_y+this.h&&(this.h=e-this.min_y+1),this.pds_path.push(f),d++,b=this.pds_path[this.pds_path.length-1])}};E.prototype.isolate=function(){if(!this.flags.bRoot){var a=this.board.rootLayer;this.next?this.next.prior=this.prior:a.prior=this.prior;this.prior?this.prior.next=this.next:a.next=this.next}};E.prototype.GetLastBackDirection=function(){var a;return(a=this.pds_path[this.pds_path.length-
1])?a.flags.BackDir:D.NOWHERE};E.prototype.GetLastForeDirection=function(){var a;return(a=this.pds_path[this.pds_path.length-1])?a.flags.ForeDir:D.NOWHERE};E.prototype.Overlaps=function(a,c){var d,b;for(b=1;d=this.pds_path[this.pds_path.length-b];b++){if(d.x==a&&d.y==c)return b;var e=this.peice;if(e.GetViaFill1(void 0,void 0,d.flags.ForeDir)&&d.x+void 0==a&&d.y+void 0==c)return console.log("hit via fill1 of node %d,%d",void 0,void 0),b;if(e.GetViaFill2(void 0,void 0,d.flags.ForeDir)&&d.x+void 0==
a&&d.y+void 0==c)return console.log("hit via fill2 of node %d,%d",void 0,void 0),b;if(e.GetViaFill1(void 0,void 0,d.flags.BackDir)&&d.x+void 0==a&&d.y+void 0==c)return console.log("hit via fill1 of node back %d,%d",void 0,void 0),b;if(e.GetViaFill2(void 0,void 0,d.flags.BackDir)&&d.x+void 0==a&&d.y+void 0==c)return console.log("hit via fill2 of node back %d,%d",void 0,void 0),b}return 0};E.prototype.UnlayPath=function(a){var c,d;for(c=a;c&&(d=this.pds_path.pop()),c;c--){var b=this.pds_path[this.pds_path.length-
1];if(b&&b.flags.bForced)return DebugBreak(),d.flags.ForeDir=D.NOWHERE,d;d&&d.flags.bForced&&DebugBreak()}if(d){b=this.pds_path[this.pds_path.length-1];if(!b)return d.flags.bForced||(d.flags.ForeDir=D.NOWHERE),this.pds_path.push(d),d;if(!a&&b.flags.bForced&&b.flags.BackDir!=D.NOWHERE){debugger;if(b.flags.bTry&&(d=this.pds_path.pop(),!d.flags.bFlopped))return d.flags.bFlopped=1,a=d.flags.BackDir+4&7,d.flags.ForeDir=a&1?a-1&7:a+1&7,d;b.flags.bForced=0}else b.flags.ForeDir=D.NOWHERE,console.log("this node itself is okay...");
return b}return null};E.prototype.FindDirection=function(a,c,d,b){return a<d?c>b?D.UP_RIGHT:c<b?D.DOWN_RIGHT:D.RIGHT:a>d?c>b?D.UP_LEFT:c<b?D.DOWN_LEFT:D.LEFT:c>b?D.UP:c==b?D.NOWHERE:D.DOWN};E.prototype.move=function(a,c){this.x+=a;this.y+=c;this.min_x+=a;this.min_y+=c;this.linked.forEach(d=>{if(d.flags.bRoute){if(d.route_end_layer.layer==this&&d.route_start_layer.layer!=this){var b=d.pds_path[d.pds_path.length-1];d.LayPath(d.x+(b?b.x:0)+a,d.y+(b?b.y:0)+c)}if(d.route_start_layer.layer==this)if(b=d.pds_path[d.pds_path.length-
1],d.route_end_layer.layer){var e=b.x+d.x;b=b.y+d.y;d.BeginPath(d.x+a,d.y+c);d.LayPath(e,b)}else console.log("This via should have been deleted?!")}})};z.prototype.select=function(a){this.selected=a;this.BoardRefresh()};z.prototype.GetCellSize=function(){return this.cellSize};z.prototype.SetScale=function(a){0>a||2<a||(this.cellSize.width=this._cell_width>>a,this.cellSize.height=this._cell_height>>a,this.scale=a)};z.prototype.SetCellSize=function(a,c){this.cellSize.width=this._cell_width=a;this.cellSize.height=
this._cell_height=c};z.prototype.DrawLayer=function(a){this.selected==a.psvInstance&&(this.ctx.fillStyle="#20c01040");a.Draw(this,this.ctx,8+(this.board_origin_x+a.x)*this.cellSize.width,8+(this.board_origin_y+a.y)*this.cellSize.height)};z.prototype.reset=function(){this.board_origin_y=this.board_origin_x=0;this.layerPool=ta()};z.prototype.GetScale=function(){return this.scale};z.prototype.SetBackground=function(a){this.default_peice=a;this.default_peice_instance=this.default_peice.methods.Create(a.psvCreate);
this.rootLayer=new E(this,this.default_peice);a.image.addEventListener("load",()=>{this.BoardRefresh()})};z.prototype.BeginPath=function(a,c,d,b){if(this.mouse_current_layer){c=new E(this,a);c.flags.bRoute=!0;if(!this.mouse_current_layer.peice.methods.ConnectBegin(this.mouse_current_layer.psvInstance,this.wX-this.mouse_current_layer.x,this.wY-this.mouse_current_layer.y,a,c.psvInstance))return!1;this.mouse_current_layer.Link(c,0,this.wX-this.mouse_current_layer.x,this.wY-this.mouse_current_layer.y);
this.route_current_layer=c;c.BeginPath(this.wX,this.wY);c.link_top(this.rootLayer)}return!0};z.prototype.GetLayerAt=function(a,c,d){for(var b=this.rootLayer;b;){var e;if(b!==d&&(e=b.IsLayerAt(a,c)))return{layer:b,at:e};b=b.next}return null};z.prototype.GetLayerDataAt=function(a,c,d){return(a=this.GetLayerAt(a,c,d))?a:null};z.prototype.EndPath=function(a,c){if(a=this.GetLayerAt(a,c,this.route_current_layer)){if(this.flags.bLeftChanged){if(a.layer.peice.methods.ConnectEnd(a.layer.psvInstance,this.wX-
a.layer.x,this.wY-a.layer.y,this.route_current_layer.peice,this.route_current_layer.psvInstance))return console.log("Heh guess we should do something when connect succeeds?"),a.layer.Link(this.route_current_layer,1,this.wX-a.at.x,this.wY-a.at.y),this.route_current_layer=null,!0;this.route_current_layer.Unlink();this.route_current_layer.isolate();this.route_current_layer.peice.methods.Disconnect(this.route_current_layer.psvInstance);this.route_current_layer=null;this.BoardRefresh();return!1}}else if(this.route_current_layer&&
this.flags.bLeftChanged&&!this.flags.bLeft)return this.route_current_layer.Unlink(),this.route_current_layer.isolate(),this.route_current_layer.peice.methods.Disconnect(this.route_current_layer.psvInstance),this.route_current_layer=null,console.log("route current layer goes to null..."),this.route_current_layer=null,this.BoardRefresh(),!1;return this.LayPathTo(this.wX,this.wY)};z.prototype.UnendPath=function(){this.mouse_current_layer.peice.methods.Disconnect(this.mouse_current_layer.psvInstance)&&
(this.mouse_current_layer.Unlink(),this.mouse_current_layer.isolate(),this.mouse_current_layer.link_top(),this.route_current_layer=this.mouse_current_layer)};z.prototype.PutPeice=function(a,c,d,b){if(a){var e=a.getsize(),f=a.gethotspot();console.log("hotspot offset of created cell is %d,%d so layer covers from %d,%d to %d,%d,",f.x,f.y,c-f.x,d-f.y,c-f.x+e.cols,d-f.y+e.rows);a.psvCreate=b;a=new E(this,a,c,d,e.cols,e.rows,f.x,f.y);a.link_top(this.rootLayer);this.BoardRefresh();return a.psvInstance}console.log("PEICE IS null!")};
var Xa=0;z.prototype.BoardRefresh=function(){var a,c;const d=this.ctx,b=this.canvas;d.clearRect(0,0,b.width,b.height);this.board_width=(b.width-16+(this.cellSize.width-1))/this.cellSize.width;this.board_height=(b.height-16+(this.cellSize.height-1))/this.cellSize.height;try{if(this.default_peice){var e=this.default_peice.getsize();var f=0<=this.board_origin_x?this.board_origin_x%e.cols:-(-this.board_origin_x%e.cols);0<=f&&(f-=e.cols);var g=0<=this.board_origin_y?this.board_origin_y%e.rows:-(-this.board_origin_y%
e.rows);0<=g&&(g-=e.rows);for(a=f;a<this.board_width;a+=e.cols)for(c=g;c<this.board_height;c+=e.rows)this.default_peice.methods.Draw(this.default_peice,this.default_peice_instance,d,a*this.cellSize.width+8,c*this.cellSize.height+8)}if(this.rootLayer)for(var h=this.rootLayer;h&&(h=h.prior);)this.DrawLayer(h)}catch(l){10>Xa++&&console.log("(try again later) FAILED:",l)}};z.prototype.LayPathTo=function(a,c){this.route_current_layer.LayPath(a,c);this.BoardRefresh();return!0};z.prototype.SCRN_TO_GRID_X=
function(a){return(a-8)/this.cellSize.width-this.board_origin_x};z.prototype.SCRN_TO_GRID_Y=function(a){return(a-8)/this.cellSize.height-this.board_origin_y};z.prototype.DoMouse=function(a,c,d){this.wX=Math.floor(this.SCRN_TO_GRID_X(a));this.wY=Math.floor(this.SCRN_TO_GRID_Y(c));this.flags.bLeftChanged=this.flags.bLeft^0!=(d&1);this.flags.bRightChanged=this.flags.bRight^0!=(d&2);this.flags.bLeft=0!=(d&1);this.flags.bRight=0!=(d&2);if(this.flags.bRightChanged&&!this.flags.bRight&&!this.route_current_layer)if(c=
this.GetLayerDataAt(this.wX,this.wY)){if(console.log("Okay it's on a layer, and it's at %d,%d on the layer",this.wX,this.wY),!c.layer.peice.methods.OnRightClick(c.layer.psvInstance,this.wX,this.wY))return}else if(this.default_peice&&!this.default_peice.methods.OnRightClick(null,this.wX,this.wY))return;if(this.flags.bSliding)if(this.flags.bLockLeft&&this.flags.bLeft||this.flags.bLockRight&&this.flags.bRight){if(this.wX!=this.xStart||this.wY!=this.yStart)this.board_origin_x+=this.wX-this.xStart,this.board_origin_y+=
this.wY-this.yStart,this.wX=this.xStart,this.wY=this.yStart,this.BoardRefresh()}else this.flags.bSliding=!1,this.flags.bLockLeft=!1,this.flags.bLockRight=!1;else this.move_current_layer?this.flags.bLeft?(this.move_current_layer.move(this.wX-this.xStart,this.wY-this.yStart),this.xStart=this.wX,this.yStart=this.wY,this.BoardRefresh(),this.move_current_layer.peice.methods.OnMove(this.move_current_layer.psvInstance)):this.move_current_layer=null:this.flags.bLeft?(a=this.GetLayerAt(this.wX,this.wY,this.route_current_layer),
this.route_current_layer?(this.flags.bLeftChanged&&(a||this.default_peice.methods.OnClick(null,this.wX,this.wY)),this.LayPathTo(this.wX,this.wY)):a?(c=a,this.mouse_current_layer=a.layer,c.layer.peice.methods.OnClick(c.layer.psvInstance,a.at.x,a.at.y),this.mouse_current_layer=null):this.default_peice&&this.default_peice.methods.OnClick(null,this.wX,this.wY)):this.route_current_layer&&this.EndPath(this.wX,this.wY)};z.prototype.LockDrag=function(){if(this.flags.bLeft||this.flags.bRight)this.xStart=this.wX,
this.yStart=this.wY,this.flags.bSliding=!0,this.flags.bLeft?(this.flags.bLockRight=!1,this.flags.bLockLeft=!0):(this.flags.bLockRight=!0,this.flags.bLockLeft=!1)};z.prototype.LockPeiceDrag=function(){if(this.flags.bLeft||this.flags.bRight)this.xStart=this.wX,this.yStart=this.wY,this.flags.bDragging=!0,this.move_current_layer=this.mouse_current_layer,this.flags.bLeft?(this.flags.bLockRight=!1,this.flags.bLockLeft=!0):(this.flags.bLockRight=!0,this.flags.bLockLeft=!1)};z.prototype.destroy=function(){canvas.remote()};
z.prototype.GetSize=function(){return{cols:this.board_width,rows:this.board_height}};z.prototype.CreatePeice=function(a,c,d,b,e,f,g,h){a=S(this,a,c,d,b,e,f,!0,!1,g,h);this.peices.push(a);return a};z.prototype.CreateVia=function(a,c,d,b,e){a=new P(this,a,c,d,b,e);this.peices.push(a);return a};z.prototype.forEachPeice=function(a){this.peices.forEach(a)};z.prototype.GetPeice=function(a){return this.peices.find(c=>c.name===a)};ca.prototype.select=function(a){this.board.select(a)};ca.prototype.addEventListener=
function(a,c){this.events[a]=c};ca.prototype.BuildBrainstemMenus=function(a,c,d,b,e){this.comp_menu=na();var f;a.appendItem(3,comp_menu,c.name());this.menus.push(comp_menu);comp_menu.appendItem(3,f=CreatePopup(),"inputs");this.menus.push(f);c.Inputs.list.forEach(g=>{b.push(g);f.appendItem(1,5E3+(b.lenght-1),g.name())});comp_menu.appendItem(3,f=CreatePopup(),"outputs");this.menus.push(f);c.Outputs.list.forEach(g=>{b.push(g);f.appendItem(1,6E3+(b.length-1),g.name())});comp_menu.appendItem(3,f=CreatePopup(),
"module");this.menus.push(f);for(a=c.first_module();a;e++,a=c.next_module())BuildBrainstemMenus(f,a,d,b,e)};ca.prototype.RebuildComponentPopups=function(){this.hMenuComponents.reset();this.brain.brainStems.forEach(a=>{BuildBrainstemMenus(this.hMenuComponents,a,this.menus,this.connectors,0)})};T.prototype=Object.create(Q.prototype);T.prototype.constructor=T;T.prototype.Create=function(a){return this.brainboard.brain.dupSynapse(this.brainboard.DefaultSynapse)};T.prototype.Destroy=function(a){this.brainboard.brain.ReleaseSynapse(a)};
T.prototype.Disconnect=function(a){this.brainboard.brain.UnLinkSynapseTo(a);return!0};T.prototype.OnRightClick=function(a,c,d){console.log("Show Synapse in Statuses");return 1};T.prototype.DrawCell=function(a,c,d,b,e,f){0<=c.gain?d.drawImage(this.master.image.on,b.coords.x,b.coords.y,b.size.width,b.size.height,e,f,this.brainboard.board.cellSize.width,this.brainboard.board.cellSize.height):d.drawImage(this.master.image.off,b.coords.x,b.coords.y,b.size.width,b.size.height,e,f,this.brainboard.board.cellSize.width,
this.brainboard.board.cellSize.height)};M.prototype=Object.create(y.prototype);M.prototype.constructor=M;M.prototype.Create=function(a){console.log("Creating a new input (peice instance)");return a};M.prototype.SetColors=function(a,c,d){this.level_colors[0]=a;this.level_colors[1]=c;this.level_colors[2]=d};M.prototype.Draw=function(a,c,d,b,e){a=a.conn.get();console.log("input value is %g",a);a=0>a?ColorAverage(level_colors[1],level_colors[0],-(1200*a)|0,1E3):ColorAverage(level_colors[1],level_colors[2],
1200*a|0,1E3);BlotImageShaded(c,d,b,e,a)};M.prototype.ConnectEnd=function(a,c,d,b,e){return!1};M.prototype.ConnectBegin=function(a,c,d,b,e){for(b=0;8>b&&(O[b].x!=c||O[b].y!=d);b++);return 8>b?this.brainboard.brain.LinkSynapseFrom(e,a.neuron,b):!1};M.prototype.OnRightClick=function(a,c,d){return 1};M.prototype.OnClick=function(a,c,d){console.log("click on input! at %d,%d",c,d);if(0==c&&0==d)return this.brainboard.board.LockPeiceDrag(),!0;brainboard.board.BeginPath(brainboard.NervePeice,brainboard);
return!1};N.prototype=Object.create(y.prototype);N.prototype.constructor=N;N.prototype.Create=function(a){console.log("Creating a new output (peice instance)");a.neuron=this.brainboard.brain.GetOutputNeuron(a.conn);return a};N.prototype.Draw=function(a,c,d,b,e){a=a.get();a=0>a?ColorAverage(this.level_colors[1],this.level_colors[0],int-1200*a,1E3):ColorAverage(this.level_colors[1],this.level_colors[2],int(1200*a),1E3);BlotImageShaded(c,d,b,e,a)};N.prototype.SetColors=function(a,c,d){this.level_colors[0]=
a;this.level_colors[1]=c;this.level_colors[2]=d};N.prototype.ConnectEnd=function(a,c,d,b,e){for(b=0;8>b&&(O[b].x!=c||O[b].y!=d);b++);return 8>b?a=this.brainboard.brain.LinkSynapseTo(e,a.neuron,b):!1};N.prototype.ConnectBegin=function(a,c,d,b,e){return!1};N.prototype.OnRightClick=function(a,c,d){return 1};N.prototype.OnClick=function(a,c,d){console.log("click on neuron! at %d,%d",c,d);if(0==c&&0==d)return this.brainboard.board.LockPeiceDrag(),!0;this.brainboard.board.BeginPath(this.brainboard.NervePeice,
brainboard);return!1};C.prototype=Object.create(y.prototype);C.prototype.constructor=C;C.prototype.SetColors=function(a,c,d,b){a?(this.c_input[0]=c,this.c_input[1]=d,this.c_input[2]=b):(this.c_threshold[0]=c,this.c_threshold[1]=d,this.c_threshold[2]=b)};C.prototype.Create=function(a){console.log("Creating a new neuron (peice instance)");return this.brainboard.brain.dupNeuron(this.brainboard.DefaultNeuron)};C.prototype.Destroy=function(a){this.brainboard.brain.ReleaseNeuron(a)};C.prototype.DrawCell=
function(a,c,d,b,e,f){c.value?d.drawImage(this.master.image.on,b.coords.x,b.coords.y,b.size.width,b.size.height,e,f,this.brainboard.board.cellSize.width,this.brainboard.board.cellSize.height):d.drawImage(this.master.image.off,b.coords.x,b.coords.y,b.size.width,b.size.height,e,f,this.brainboard.board.cellSize.width,this.brainboard.board.cellSize.height)};C.prototype.Update=function(a,c){console.log("updating color information for a neuron...")};C.prototype.ConnectEnd=function(a,c,d,b,e){for(b=0;8>
b&&(O[b].x!=c||O[b].y!=d);b++);return 8>b?this.brainboard.brain.LinkSynapseTo(e,a,b):!1};C.prototype.ConnectBegin=function(a,c,d,b,e){this.brainboard.events.added&&this.brainboard.events.added(this.brainboard.NervePeice,e);for(b=0;8>b&&(O[b].x!=c||O[b].y!=d);b++);return 8>b?this.brainboard.brain.LinkSynapseFrom(e,a,b):!1};C.prototype.OnRightClick=function(a,c,d){console.log("Show in info panel?");return 1};C.prototype.OnClick=function(a,c,d){this.brainboard.events.select&&this.brainboard.events.select(a);
console.log("click on neuron! at %d,%d",c,d);if(0==c&&0==d)return this.brainboard.board.LockPeiceDrag(),!0;this.brainboard.board.BeginPath(this.brainboard.NervePeice,this.brainboard);return!1};ha.prototype=Object.create(C.prototype);ha.prototype.constructor=aa;ha.prototype.Create=function(a){console.log("Creating a new output (peice instance)");return new this.brainboard.brain.Exporter(this.brainboard.brain,a)};aa.prototype=Object.create(C.prototype);aa.prototype.constructor=aa;aa.prototype.Create=
function(a){console.log("Creating a new input (peice instance)");return new this.brainboard.brain.External(this.brainboard.brain,a)};da.prototype=Object.create(C.prototype);da.prototype.constructor=da;da.prototype.Create=function(a){console.log("Creating a new input (peice instance)");return new this.brainboard.brain.External(this.brainboard.brain,a)};L.prototype=Object.create(y.prototype);L.prototype.constructor=L;L.prototype.Create=function(){return!0};L.prototype.Destroy=function(){};L.prototype.Connect=
function(a,c,d,b,e,f){return 0};L.prototype.Update=function(a,c){console.log("Update background - nothing to do.")};L.prototype.OnClick=function(a,c,d){this.brainboard.board.LockDrag();return!0};L.prototype.OnRightClick=function(a,c,d){this.brainboard.RebuildComponentPopups(this);this.brainboard.hMenu.show(this.brainboard.board,this.brainboard.board.mousePos.x,this.brainboard.board.mousePos.y,b=>{if(void 0!==b){var e=this.brainboard;if(5E3<=b&&6E3>b){console.log("Put input peice at %d,%d",c,d);var f=
new OUPUT_INPUT(e);f.conn=e.connectors[b-5E3];f.neuron=f.brain.GetInputNeuron(f.conn);e.board.PutPeice(e.InputPeice,c,d,f)}else if(6E3<=b&&6999>=b)console.log("Put output peice at %d,%d",c,d),f=new OUPUT_INPUT(e),f.conn=e.connectors[b-6E3],e.board.PutPeice(e.OutputPeice,c,d,f);else switch(b){case 1001:return console.log("Put neuron peice at %d,%d",c,d),b=e.board.PutPeice(e.NeuronPeice,c,d,0),e.events.added&&e.events.added(e.NeuronPeice,b),!0;case 1011:return console.log("Put osc peice at %d,%d",c,
d),b=e.board.PutPeice(e.OscillatorPeice,c,d,0),e.events.added&&e.events.added(e.OscillatorPeice,b),!0;case 1010:return console.log("Put tickosc peice at %d,%d",c,d),b=e.board.PutPeice(e.TickOscillatorPeice,c,d,0),e.events.added&&e.events.added(e.TickOscillatorPeice,b),!0;case 1020:case 1021:case 1022:e.scale=b-1020;e.board.SetScale(b-1020);break;case 1004:(b=PickBoardName(null,!1))&&e.board.Save(null,b);break;case 1005:(b=PickBoardName(null,!0))&&e.board.Load(null,b);break;case 1040:return!1}}});
return!0};L.prototype.OnDoubleClick=function(a,c,d){result=TrackPopup(brainboard.hMenu,null);return!0};pa.prototype=Object.create(C.prototype);pa.prototype.constructor=C;pa.prototype.Create=function(a){console.log("Creating a new neuron (peice instance)");return this.brainboard.brain.Oscillator()};oa.prototype=Object.create(C.prototype);oa.prototype.constructor=C;oa.prototype.Create=function(a){console.log("Creating a new tick Oscillator (peice instance)");return new this.brainboard.brain.TickOscillator(this.brainboard.brain,
1E3)};var ka=document.getElementById("mouseCatcher");ka.addEventListener("click",a=>{ka.style.visibility="hidden"});const W=[{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">1</SPAN>\n\t\t<BR>\n        \t<CENTER>Observations<BR>\n                on<BR>Certain Properties<BR>\n                of<BR>\n                Components<BR>\n                of<BR>\n                Synthetic Brains<BR>\n                <BR><BR><BR>\n                [Click on right side of this<BR>\n\t\tjounral page to go to next page]<BR>\n          ',
activate:()=>{Ma()}},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">1</SPAN>\n\t\t<BR>\n        \tI have returned to the lab to continue<BR>\n                my experiments on the brain components<BR>\n                <BR>\n                They are constructing a bug in the<BR>\n                workshop.  Once it is completed I will be<BR>\n                able to use my knowledge of synthetic<br>\n                brains to control it.<BR>\n                <BR>\n                I plan to do a series of experiments.<BR>\n                Each will involve creating a brain to<BR>\n                perform a specific function.  The brains<BR>\n                will be built on the brain board<BR>\n                <BR>\n                [Click on left side of this journal page<BR>\n                to return to previous page]<BR>\n        '},
{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">1</SPAN>\n\t\t<BR>\n        \tTool Panel<BR>\n                <BR>\n                The blue region at the top contains<BR>\n                some of the items you will use to complete<BR>\n                the goals.<BR>\n                <BR>\n                Clicking on them will automatically place<BR>\n                a copy on the board.  Click the large green<BR>\n                circle which is a Neuron.<BR>\n                <BR>\n                Don\'t worry about making a mess, the<BR>\n                board will be cleared and setup with the<BR>\n                 inputs and outputs to and from the brain<BR>\n                 respectively.<BR>\n                <BR>\n                <BR>\n                <DIV ID="jim1" > </DIV><BR>\n                <BR>\n                <BR>\n         ',
inserts:{jim1:ia()}},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">1</SPAN>\n\t\t<BR>\n        \tThe recycle can...<BR>\n                <DIV ID="jim1"> </DIV><BR>\n                <BR>\n                can be used to clear the board.<BR>\n                <BR>\n                If you accientally clear the test<BR>\n\t\tinputs and outputs, you can restore them<BR>\n\t\tby going to the previous journal page,<BR>\n\t\tand foward again, which will setup<BR>\n                for the current test.<BR>\n                <BR>\n                Red nodes are Inputs, and blue<BR>\n                nodes are outputs.<BR>\n                <BR>\n\t\tThe red node with Yellow arrow<br>\n                downward is the first button pushing<BR>\n                rotary wheel<BR>\n                <BR>\n\t\tThe red node with Yellow arrow<br>\n                to the right is the slider input<BR>\n                that ranges from 0-1 smoothly.<BR>\n                <BR>\n                <BR>\n         ',
inserts:{jim1:xa()}},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">1</SPAN>\n\t\t<BR>\n        \tThis is an example of clicking\n\t\tOn the edge of a peice, and dragging\n\t\taway one space.  The connection does\n\t\tnot show until the destination is different\n\t\tthan the source<BR>\n\t\t<BR>\n\t\t\n                <DIV ID="jim1"> </DIV><BR>\n                <BR>\n                Have fun, be creative...<BR>\n                <BR>\n                <DIV ID="jim2"> </DIV><BR>\n                <BR>\n         ',
inserts:{jim1:Ca("images/first-drag.jpg"),jim2:Ca("images/PathPicture.jpg")}},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">1</SPAN>\n\t\t<BR>\n        \tMonitoring Equpment<BR>\n                <BR>\n                The brain will be used to control lights in<BR>\n                response to inputs from switches.<BR>\n                <BR>\n                THe input from the switches and the<BR>\n                output to the lights will be monitored by<BR>\n                a Logic Analyzer.  It shows the level of the<BR>\n                output in blue.<BR>\n                <BR>\n                It can be preprogrammed with the<BR>\n                expected output (shown in gold during<BR>\n                a test) and will signal if the actal output<BR>\n                is wrong.<BR>\n         '},
{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">1</SPAN>\n\t\t<BR>\n        \t<BR>\n                <BR>\n                To test a brain, press the "Test" Button<BR>\n                then flip the switch to "Run".  If the<BR>\n                brain has done what it should while the<BR>\n                timer ticks to zero, the experiment is a<BR>\n                success.<BR>\n                <BR>\n                Testing can begin at any time, and may be<BR>\n\t\tstopped and reset at any time by clicking<BR>\n                the test button again.<BR>\n                <BR>\n         '},
{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">1</SPAN>\n\t\t<BR>\n        \tSignals and Lines<BR>\n                I have discovered that bug brains<BR>\n                operate on signals which range from<BR>\n                0(off) to 1(on).<BR>\n                <BR>\n                The signals enter the brain through the<BR>\n                input nodes, travel along lines and exit<BR>\n                through output nodes.<BR>\n                <BR>\n                Input Node - Line - Output Node<BR>\n                <DIV ID="jim1"> </DIV><BR>\n                A line is made by grabbing the edge of a<BR>\n                node and dragging it out.  Drop the line<BR>\n                on the edge of the target node.<BR>\n                \n         ',
activate:()=>{Na()},inserts:{jim1:K()}},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n\t\t<BR>\n        \tExperiment 1: The Start<BR>\n                I have connected the input node to an<BR>\n                automatic switch.  The output node<BR>\n                goes to the light.  To confirm my theory<BR>\n                on the previous page, I will attempt to<BR>\n                make a brain where the light will com<BR>\n                on when the switch is on.<BR>\n                <BR>\n                <SPAN ID="jim1"></SPAN><SPAN style="line-height:400%;vertical-align:top">Input from switch</SPAN><BR>\n                <SPAN ID="jim2"></SPAN><SPAN style="line-height:400%;vertical-align:top">Output to light</SPAN><BR>\n                <BR>\n                [Build a brain on the Brain Board]<BR>\n                [To test, press Test and wait for timer<BR>\n                to expire]<BR>\n                [Go to the next page when successful]<BR>\n         ',
activate:()=>{I.clear();k.reset();J(0,2,10);x.length=0;F(0,15,10)},inserts:{jim1:V(),jim2:K()},locked:!0},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n\t\t<BR>\n\t\tA Success!!!!!<BR>\n\t\t<BR>\n\t\tThey have started work on the bug in the<BR>\n\t\tworkshop.  I had beter hurry up and<BR>\n\t\tcomplete these experiments.<BR>\n\t\t<BR>\n\t\tThere seems to be a space for connecting<BR>\n\t\tup to 8 lines to the input node.  In<BR>\n\t\ttheory then I should be able to drive<BR>\n\t\tmore than one light from the same input.<BR>\n\t\tI\'ll have to test this.<BR>\n\t\t<BR>\n\t\t<BR>\n\t\t<BR>\n\t\t<BR>\n         '},
{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n\t\t<BR>\n\t\tExperiment 2: Two Lights<BR>\n\t\tI have connected the input node to an<BR>\n\t\tautomatic switch.  There are two output<BR>\n\t\tnodes - each goes to a light.  I will<BR>\n\t\tattempt to make a brain where both<BR>\n\t\tlights come on when the switch is on.<BR>\n\t\t<BR>\n\t\t<BR>\n                <SPAN ID="jim1"></SPAN><SPAN style="line-height:400%;vertical-align:top">Input from switch</SPAN><BR>\n                <SPAN ID="jim2"></SPAN><SPAN style="line-height:400%;vertical-align:top">Output to lights 1 and 2</SPAN><BR>\n         ',
activate:()=>{Oa()},inserts:{jim1:V(),jim2:K()},locked:!0},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n\t\t<BR>\n\t\tTwo in a row!!<BR>\n\t\t<BR>\n\t\tMuch excitement.  Having a party<BR>\n\t\tto celebrate.  Maybe I could set<BR>\n\t\tup some lights???<BR>\n\t\t<BR>\n\t\tMight as well do it as an<BR>\n\t\texperiment...<BR>\n\t\t<BR>\n\t\t<BR>\n\t\t<BR>\n\t\t<BR>\n\t\t<BR>\n         '},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n\t\t<BR>\n\t\tExperiment 3: Disco<BR>\n\t\tI have set up a second faster automatic<BR>\n\t\tswitch and there are now four lights.<BR>\n\t\tI want lights 1 and 3 to swtich slowly<BR>\n\t\tand lights 2 and 4 to switch quickly.<BR>\n\t\t<BR>\n                <SPAN ID="jim1"></SPAN><SPAN style="line-height:400%;vertical-align:top">Input from 1 and 2</SPAN><BR>\n                <SPAN ID="jim2"></SPAN><SPAN style="line-height:400%;vertical-align:top">Output to lights 1,2,3 and 4.</SPAN><BR>\n\t\t[Lines can be removed by grabbing<BR>\n\t\tthem in one of the 8 grid squares<BR>\n\t\tthat surround the node then dragging<BR>\n\t\tthem away and dropping them]<BR>\n         ',
activate:()=>{Pa()},inserts:{jim1:V(),jim2:K()},locked:!0},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n\t\t<BR>\n                Neurons<BR>\n                The large green spheres are neurons.<BR>\n                Neurons are the thinking part of a brain.<BR>\n                these seem to be simplified versions of<BR>\n                real neurons.  Neurons in general have a<BR>\n                threshold.  If the input to the neuron is <BR>\n                below the threshold the neuron is off<BR>\n                (output 0).  If the input to the neuron<BR>\n                 is at or above the threshold the neuron is<BR>\n                 on (output 1).<BR>\n                 <BR>\n                 If this is true for these neurons the I<BR>\n                 could make a brain which switches on a<BR>\n                 light when the input is above some value.<BR>\n                <BR>\n                \n         '},
{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n                <BR>\n                Experiment 4: Neuron Threshold<BR>\n                The input now comes from a slider.<BR>\n                The slider produces a variable signal in<BR>\n                the range from 0 to 1.  I want the light to<BR>\n                switch on when the signal is 80 or above.<BR>\n                <BR>\n                <SPAN ID="jim1"></SPAN><SPAN style="line-height:400%;vertical-align:top"> Input from slider : 0 to 1</SPAN><BR>\n                <SPAN ID="jim2"></SPAN><SPAN style="line-height:400%;vertical-align:top">Output to light</SPAN><BR>\n                <BR>\n                [Click waste bin to clear the brain]<BR>\n                [Click large egreen button to add neuron]<BR>\n                [Neuron shows in table with slider to set\n                threshold]<BR>\n         ',
activate:()=>{Qa()},inserts:{jim1:ja(),jim2:K()},locked:!0},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n                <BR>\n                I have noticed that music equipment<BR>\n                uses a seris of lights to indicate sound<BR>\n                volume.  When the volume gets larger<BR>\n                thre are more lights lit.<BR>\n                <BR>\n                It should be possible to duplicate this<BR>\n                using several neurons.<BR>\n                <BR>\n                [On the Logic Analyzer, the blue line<BR>\n                shows the output and the gold line shows<BR>\n                the expected output.  The blue line should<BR>\n                overlay the gold line.  If you can see a gold<BR>\n                line the otuput is wrong and the test <BR>\n                will fail]\n         '},
{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n                <BR>\n                Experiment 5: Light Scale<BR>\n                The input comes from the slider.<BR>\n                There are four lights that should be lit<BR>\n                at equally spaced intervals to show the<BR>\n                value of the input.  The more light son,<BR>\n                the higher the input.<BR>\n                <BR>\n                <SPAN ID="jim1"></SPAN><SPAN style="line-height:400%;vertical-align:top"> Input from slider : 0 to 1</SPAN><BR>\n                <SPAN ID="jim2"></SPAN><SPAN style="line-height:400%;vertical-align:top">Output to lights 1,2,3 and 4</SPAN><BR>\n                <BR>\n                <BR>\n                <BR>\n                <BR>\n         ',
activate:()=>{Ra()},inserts:{jim1:ja(),jim2:K()},locked:!0},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n                <BR>\n                Synapses<BR>\n                The input to a neuron comes through a<BR>\n                synapse (shown as a blue or red blob<BR>\n                on the neuron).  Each synapse has a<BR>\n                weight between -1 and 1.  This is<BR>\n                the percent of the signal the synapse<BR>\n                passes through to the neuron.<BR>\n                <BR>\n                If there is mroe than one input to a<BR>\n                neuron, then the input signal is the sum<BR>\n                of each input signal times the weight of<BR>\n                its synapse.  If this sum exceeds the<BR>\n                threshold the neuron switches on.<BR>\n                <BR>\n                [Right click on a synapse to set the weight]<BR>\n         '},
{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n                <BR>\n                Computing with Neurons<BR>\n                By setting the synapse weights and the<BR>\n                neuron threshold it should be possible<BR>\n                to perform logic operation with<BR>\n                neurons.<BR>\n                <BR>\n                These logic operations are the building<BR>\n                blocks for digital computers. In<BR>\n                computers, signals are either 0 or 1.<BR>\n                The equivalent signals in Bug Brain are<BR>\n                0 (light off) and 1(light on).<BR>\n                <BR>\n                <BR>\n                <BR>\n                <BR>\n         '},
{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n                <BR>\n                Experiment 6: Or<BR>\n                The light should go on if switch 1 OR<BR>\n                switch 2 is on (or both are on).<BR>\n                <BR>\n                <BR>\n                <SPAN ID="jim1"></SPAN><SPAN style="line-height:400%;vertical-align:top">Input from switches 1 and 2</SPAN><BR>\n                <SPAN ID="jim2"></SPAN><SPAN style="line-height:400%;vertical-align:top">Output to light</SPAN><BR>\n                <BR>\n         ',
activate:()=>{Sa()},inserts:{jim1:ja(),jim2:K()},locked:!0},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n                <BR>\n                Experiment 7: And<BR>\n                The light should go on if switch 1 AND<BR>\n                switch 2 are on.<BR>\n                <BR>\n                <BR>\n                <SPAN ID="jim1"></SPAN><SPAN style="line-height:400%;vertical-align:top">Input from switches 1 and 2</SPAN><BR>\n                <SPAN ID="jim2"></SPAN><SPAN style="line-height:400%;vertical-align:top">Output to light</SPAN><BR>\n                <BR>\n         ',
inserts:{jim1:V(),jim2:K()},activate:()=>{Ta()},locked:!0},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n                <BR>\n                Experiment 8: Inhibition <BR>\n                Synapses can have negative weights.<BR>\n                A negative input is subtracted from<BR>\n                the input sum, so these synapses<BR>\n                inhibit the neuron.<BR>\n                <BR>\n                In this experiment the light should<BR>\n                be on when switch 2 is on and<BR>\n                switch 1 is off.<BR>\n                <BR>\n                <BR>\n                <SPAN ID="jim1"></SPAN><SPAN style="line-height:400%;vertical-align:top">Input from switches 1 and 2</SPAN><BR>\n                <SPAN ID="jim2"></SPAN><SPAN style="line-height:400%;vertical-align:top">Output to light</SPAN><BR>\n                <BR>\n         ',
inserts:{jim1:V(),jim2:K()},activate:()=>{Ua()},locked:!0},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n\t\t<BR>\n                Experiment 9: Inverter <BR>\n                There is a single input and output. The<BR>\n                light should go on if the switch is NOT<BR>\n                on.<BR>\n                <BR>\n                <BR>\n                <SPAN ID="jim1"></SPAN><SPAN style="line-height:400%;vertical-align:top">Input from switch</SPAN><BR>\n                <SPAN ID="jim2"></SPAN><SPAN style="line-height:400%;vertical-align:top">Output to light</SPAN><BR>\n                <BR>\n         ',
inserts:{jim1:V(),jim2:K()},activate:()=>{Va()},locked:!0},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n                <BR>\n                Exclusive Or (Xor)<BR>\n                The output is on if one or other of the<BR>\n                inputs is on but not if both are on.<BR>\n                <BR>\n                This is a function with a bit of history.<BR>\n                Minsky and Papert showed that a single<BR>\n                neuron could not do it.  They are<BR>\n                generally credited with stpping<BR>\n                anyone working on neuron networks<BR>\n                during the 1970\'s.  Interest returned in<BR>\n                the 1980\'s with the introduction of the<BR>\n                idea of multiple layers of neurons.<BR>\n                <BR>\n         '},
{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n                <BR>\n                Experiment 10: Xor<BR>\n                The light should be on if one of the<BR>\n                switches is on but not if both are on.<BR>\n                <BR>\n                <BR>\n                <SPAN ID="jim1"></SPAN><SPAN style="line-height:400%;vertical-align:top">Input from switches 1 and 2</SPAN><BR>\n                <SPAN ID="jim2"></SPAN><SPAN style="line-height:400%;vertical-align:top">Output to light</SPAN><BR>\n                <BR>\n         ',
inserts:{jim1:V(),jim2:K()},activate:()=>{Wa()},locked:!0},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n                <BR>\n                Success<BR>\n                <BR>\n                The lady bug is complete.<BR>\n                It is time to leave the lab<BR>\n                and go into the real world.<BR>\n                <BR>\n                <BR>\n                <BR>\n                <BR>\n                <BR>\n                <BR>\n                <BR>\n         ',
locked:!0},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n\t\t<BR>\n         '}];var p={journalState:0,journalStateMax:0,progressLocked:!1,getExpectedValue:null,getTestValue:null,expectedAccum:0,testing:!1},I=function(a){function c(g,h,l,q){function t(){w.innerText=G.threshold;var H=G.value;H=void 0!==H?H.toFixed(3):"???";B.innerText=H;setTimeout(t,250)}g.addEventListener("click",()=>{f.select(l);k.select(l)});h.addEventListener("click",()=>{f.select(l);k.select(l)});
var r=h.insertCell();g.insertCell().innerText=q.name+":"+l.type;h=h.insertCell();h.colSpan=2;var m=document.createElement("input");m.type="range";m.min=-100;m.max=100;m.value=100*l.threshold;h.appendChild(m);m.addEventListener("input",()=>{l.threshold=m.value/100});h=document.createElement("select");h.add(q=document.createElement("option"));q.text="digital";q.value=u.algo.digital;h.appendChild(q);h.add(q=document.createElement("option"));q.text="analog";q.value=u.algo.analog;h.appendChild(q);h.add(q=
document.createElement("option"));q.text="sigmoid";q.value=u.algo.sigmoid;h.appendChild(q);h.addEventListener("change",H=>{H=H.target.options[H.target.selectedIndex];console.log("Right?",H);l.algorithm=+H.value});r.appendChild(h);var w=g.insertCell();w.innerText="123";w.align="right";w.width="25%";var B=g.insertCell();B.innerText="bbb";B.align="right";B.width="25%";var G=l;t()}function d(g,h,l){function q(){r.innerText=w.gain;var B=w.value.toFixed(3);m.innerText=B;setTimeout(q,250)}g.addEventListener("click",
()=>{f.select(l);k.select(l)});h.addEventListener("click",()=>{f.select(l);k.select(l)});h.insertCell();g.insertCell().innerText="synapse";h=h.insertCell();h.colSpan=2;var t=document.createElement("input");t.type="range";t.min=-100;t.max=100;t.value=100*l.gain;h.appendChild(t);t.addEventListener("input",()=>{l.gain=t.value/100});var r=g.insertCell();r.innerText="123";r.align="right";r.width="25%";var m=g.insertCell();m.innerText="bbb";m.align="right";m.width="25%";var w=l;q()}var b=new WeakMap,e=
null,f={table:a,clear(){for(var g;g=this.table.querySelector("tr:nth-of-type(2)");)g.remove()},select(g){var h=b.get(g);h&&(e&&e.forEach(l=>l.className=""),h.forEach(l=>l.className="selected"),e=h);k.select(g)},addNeuron(g,h){var l=this.table.insertRow(),q=this.table.insertRow();c(l,q,h,g);b.set(h,[l,q])},addSynapse(g,h){g=this.table.insertRow();var l=this.table.insertRow();d(g,l,h);b.set(h,[g,l])}};f.clear();return f}(document.getElementById("statusTable")),Ya=document.getElementById("boardFrame"),
la=function(){const a=[],c=[];var d={cycle:0,k:1,changed:!1,Synapse:R,brainStems:[],step(){this.cycle++;this.changed?(c.length=0,a.forEach(b=>{b.cycle!=this.cycle&&(c.push(b),b.value)}),this.changed=!1):c.forEach(b=>b.value)},dupNeuron(b){b=b.clone();a.push(b);return b},dupSynapse(b){return b.clone()},UnLinkSynapse(b){b.output?b.DetachDestination():b.input&&b.DetachSource()},UnLinkSynapseTo(b){b.DetachDestination()},UnLinkSynapseFrom(b){b.DetachSource()},LinkSynapseFrom(b,e,f){return b.AttachSource(e,
e.attachSynapseFrom(f))},LinkSynapseTo(b,e,f){return b.AttachDestination(e,e.attachSynapse(f))},toJson(){}};Object.keys(Ha).forEach(b=>d[b]=Ha[b]);return d}();Da();var k=new ca(la,Ya);k.addEventListener("added",(a,c)=>{c instanceof la.Neuron&&I.addNeuron(a,c);c instanceof la.Synapse&&I.addSynapse(a,c)});k.addEventListener("select",a=>{a instanceof la.Neuron&&I.select(a)});var ba=document.getElementById("notebookPanel");ba.addEventListener("click",a=>{100<a.offsetX?ma(p.journalState+1):p.journalState&&
ma(p.journalState-1)});ba.innerHTML=W[p.journalState].HTML;var A=[],x=[],Ga=null;(function(){var a=document.getElementById("boardToolsFrame"),c;a.appendChild((c=ia()).on);c.on.addEventListener("click",()=>{var d=qa(10*(1<<k.scale)-k.board.board_origin_x,10*(1<<k.scale)-k.board.board_origin_y);d=k.board.PutPeice(k.NeuronPeice,d.x,d.y,0);k.events.added&&k.events.added(k.NeuronPeice,d)});a.appendChild(c=xa());c.addEventListener("click",()=>{I.clear();k.reset()});a.appendChild((c=V()).on);c.on.addEventListener("click",
()=>{var d=qa(10*(1<<k.scale)-k.board.board_origin_x,10*(1<<k.scale)-k.board.board_origin_y);J(0,d.x,d.y)});a.appendChild((c=K()).on);c.on.addEventListener("click",()=>{var d=qa(10*(1<<k.scale)-k.board.board_origin_x,10*(1<<k.scale)-k.board.board_origin_y);F(0,d.x,d.y)});a.appendChild((c=ja()).on);c.on.addEventListener("click",()=>{var d=qa(10*(1<<k.scale)-k.board.board_origin_x,10*(1<<k.scale)-k.board.board_origin_y);d=k.board.PutPeice(k.sliderInputPeice,d.x,d.y,()=>A[2].getValue());k.events.added&&
k.events.added(k.sliderInputPeice,d)})})();(function(){var a=document.getElementById("boardMonitorFrame");a.style.padding=8;var c;a.appendChild(Ga=c=Ka((d,b)=>{!d&&(p.testing=b)&&(p.expectedAccum=0);console.log("Test Button:",d,b);if(d&&!b){if(1>p.expectedAccum)return p.progressLocked=W[p.journalState].locked=!1,ma(p.journalState+1),!0;console.log("Failed.");return!1}}));c.style.verticalAlign="top";c.style.height="66";c.style.width="25%";c.style.top="5";c.setAttribute("viewBox","0 100 200 40");c.setAttribute("preserveAspectRatio",
"xMaxYMax");a.appendChild(c=Ba(.75));A.push(c);c.style.verticalAlign="top";c.style.height="64";c.style.width="48";c.setAttribute("viewBox","0 00 100 175");a.appendChild(c=Ba(.223));A.push(c);c.style.verticalAlign="top";c.style.height="64";c.style.width="48";c.setAttribute("viewBox","0 00 100 175");a.appendChild(c=Ia());A.push(c);c.style.height="128";c.style.width="96";c.setAttribute("viewBox","0 00 100 255");c.setAttribute("transform","rotate(-90 0 -25)");a.appendChild(c=La(d=>{if(4<=d)return x[d-
4]?100*x[d-4].value:0;if(3==d)return p.getExpectedValue?(d=p.getExpectedValue(),p.testing&&p.getTestValue&&(p.expectedAccum+=Math.abs(d-p.getTestValue())),d):0;if(d<A.length)return 100*A[d].getValue()}));c.style.position="relative";c.style.top=-65;c.style.zIndex=3;c.style.height="150";c.style.width="328";c.setAttribute("viewBox","0 00 450 235")})();Fa();(function(){W.forEach(a=>{ba.innerHTML=a.HTML;var c=ba.querySelector('[id="pageNum"]');c&&(c.textContent=""+(p.journalState+1),a.inserts&&Object.keys(a.inserts).forEach(d=>
{var b;(b=ba.querySelector(`[id="${d}"]`))&&("on"in a.inserts[d]?b.appendChild(a.inserts[d].on):b.appendChild(a.inserts[d]))}));a.HTML=ba.innerHTML})})();(function(){var a=Number(localStorage.getItem("maxPage"));a?(W.forEach((c,d)=>{d<a&&(W[d].locked=!1)}),ma(a)):ma(0)})()})();
