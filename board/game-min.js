'use strict';(function(){function l(a){if(!(this instanceof l))return new l(this);this.brain=a;this.threshold=.5;this.algorithm=0;this.k=.2;this.input=0;this.on=!1;this.cycle=a.cycle-1;this.type="Neuron";this.inputs=[];this.outputs=[]}function X(a){if(!(this instanceof X))return new X(this);l.call(this,a);this.type="Sigmoid";this.k=this.brain.k;return n}function Q(a){if(!(this instanceof Q))return new Q(this);l.call(this,a);this.type="Oscillator";this.freq=1}function R(a,b){if(!(this instanceof R))return new R(this);
l.call(this,a);this.type="TickOscillator";this.freq=b||1E3}function N(a,b){if(!(this instanceof N))return new N(this,a);l.call(this,a);this.cb=b;this.type="External"}function S(a,b){if(!(this instanceof S))return new S(this,a);l.call(this,a);this.cb=b;this.type="Exporter"}function K(){if(!(this instanceof K))return new K(this);this.output=this.input=null;this.gain=1}function L(a,b,d,c,e,f,k,q,g,h,B){if(!(this instanceof L))return new L(a,b,d,c,e,f,k,q,g,h,B);this.flags={block:0,viaset:0};this.scaled=
[];this.current_scale;this.isBlock=q;this.isRoute=g;this.cellSize=a.GetCellSize();this.size={rows:c,cols:e};this.cellSize={width:0,height:0};this.hot={x:f,y:k};this.board=a;this.name=b;this.image=this.original=d;"on"in d?d=d.on:this.image=d;if(d){a=function(){var a=this.image;"on"in a&&(a=a.on);if("number"===typeof a.width){var c=a.width/this.size.cols;a=a.height/this.size.rows}else c=66/this.size.cols,a=66/this.size.rows;var b=[];this.cellSize.width=c;this.cellSize.height=a;for(var d=0;d<this.size.cols;d++){b[d]=
[];for(var e=0;e<this.size.rows;e++)b[d].push({x:d*c,y:e*a})}this.grid=b};this.grid=null;this.lastCell={coords:null,size:this.cellSize};if("IMG"===d.nodeName)d.addEventListener("load",a.bind(this)),d.width&&a.call(this);else if("svg"===d.nodeName){d=function(a){var c=(new XMLSerializer).serializeToString(a);c="data:image/svg+xml,"+encodeURI(c).replace(/#/g,"%23");m=document.createElement("img");m.width=a.getAttribute("width");m.height=a.getAttribute("height");m.src=c;return m};var m;this.original.on=
d(this.original.on);this.original.off=d(this.original.off);"range"in this.original&&(this.original.range=this.original.range.map(d));this.image=this.original;a.call(this)}this.current_scale=0}this.psvCreate=B;this.methods=h?h:new t(this);this.methods.SetPeice(this)}function I(a,b,d,c,e,f){L.call(this,a,b,{on:d,off:c},7,7,0,0,!1,!0,e,f)}function t(a){if(!(this instanceof t))return new t;this.master=a}function J(){if(!(this instanceof J))return new J}function ka(){return{x:0,y:0,cellx:0,celly:0,isAbove:null,
isBelow:null,flags:{BackDir:0,ForeDir:0,bForced:0,bFlopped:0,bTry:0,bRight:0}}}function y(a,b,d,c,e,f,k,q){if(!(this instanceof y))return new y(a,b,d,c,e,f,k,q);this.board=a;this.peice=b||null;this.psvInstance=b?b.methods.Create(b.psvCreate):null;this.iLayer;this.linked=[];this.route_start_layer={layer:null,x:0,y:0};this.route_end_layer={layer:null,x:0,y:0};this.flags={bForced:0,bEnded:0,bRoute:0,bRoot:0};this.prior=this.next=null;this.flags.bRoot=!a.rootLayer;this.pds_path=[];this.flags.bRoute=b.isRoute;
this.x=d||0;this.y=c||0;this.min_x=d-k||0;this.min_y=c-q||0;this.w=e||1;this.h=f||1;this.peice=b;if(!this.flags.bRoute)for(a=0;a<this.peice.size.cols;a++)for(b=0;b<this.peice.size.rows;b++)d=new ka,d.x=this.x+a-this.peice.hot.x,d.y=this.y+b-this.peice.hot.y,d.cellx=a,d.celly=b,this.pds_path.push(d)}function oa(a,b){return a==b?0:a==(b+1&7)?-1:a==(b-1&7)?1:10}function la(a){var b=[];return{get(d,c,e,f,k,q,g,h){var m=b.pop();m||(m=y(a,d,c,e,f,k,q,g,h));return m},drop(a){b.push(a)}}}function u(a){if(!(this instanceof
u))return new u(a);var b=this.canvas=document.createElement("canvas");b.width=1024;b.height=1024;b.style.width="100%";b.style.height="100%";this.ctx=b.getContext("2d");a.appendChild(b);var d=this,c=0;b.addEventListener("mousemove",function(e){e.preventDefault();d.mousePos.x=e.clientX;d.mousePos.y=e.clientY;var f=a.getBoundingClientRect();d.DoMouse(e.offsetX*b.width/f.width,e.offsetY*b.height/f.height,c)});b.addEventListener("mouseup",function(e){e.preventDefault();c=e.buttons;d.mousePos.x=e.clientX;
d.mousePos.y=e.clientY;var f=a.getBoundingClientRect();d.DoMouse(e.offsetX*b.width/f.width,e.offsetY*b.height/f.height,c)});b.addEventListener("mousedown",function(e){e.preventDefault();c=e.buttons;d.mousePos.x=e.clientX;d.mousePos.y=e.clientY;var f=a.getBoundingClientRect();d.DoMouse(e.offsetX*b.width/f.width,e.offsetY*b.height/f.height,c)});a.addEventListener("contextmenu",(a)=>{a.preventDefault();return!1},!1);document.body.addEventListener("contextmenu",(a)=>{a.preventDefault();return!1},!1);
b.addEventListener("contextmenu",(a)=>{a.preventDefault();return!1},!1);this.cellSize={width:16,height:16};this._cell_height=this._cell_width=0;this.default_peice_instance;this.default_peice;this.OnClose;this.psvClose;this.peices=[];this.layerPool=la();this.mouse_current_layer;this.route_current_layer;this.move_current_layer;this.mousePos={x:0,y:0};this.wY=this.wX=this.yStart=this.xStart=0;this.board_height=this.board_width=50;this.board_origin_y=this.board_origin_x=0;this.flags={bSliding:0,bDragging:0,
bLockLeft:0,bLockRight:0,bLeft:0,bRight:0,bLeftChanged:0,bRightChanged:0};this.scale=0;this.current_path={viaset:null,_x:0,_y:0};this.selected=null;this.peices=[];this.scale=this.board_origin_y=this.board_origin_x=0;this.move_current_layer=this.route_current_layer=this.mouse_current_layer=this.default_peice=null;this.flags.bSliding=0;this.flags.bDragging=0;this.flags.bLockLeft=0;this.flags.bLeftChanged=0;this.flags.bLeft=0;this.flags.bLockRight=0;this.flags.bRightChanged=0;this.flags.bRight=null;
this.layerPool=la();this.OnClose=null}function ma(a,b,d){d=d||"0";a=a.toString(16);return a.length>=b?a:Array(b-a.length+1).join(d)+a}function aa(){for(var a={on:na(),off:na(),range:[]},b=0;8>b;b++)a.range[b]=na(),a.range[b].setColor(`#${ma(0,2)}${ma(223*(8-b)/8,2)}${ma(0,2)}`);a.off.setColor("#707070");return a}function na(){var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("width",66);a.setAttribute("height",66);a.setAttribute("viewBox","-2 -2 68 68");a.innerHTML=
'\n\t\t<defs>\n\t\t\t<radialGradient id="gradient-0" gradientUnits="userSpaceOnUse" cx="-38.806" cy="-32.359" r="31.21" gradientTransform="matrix(0.556701, 0.060335, -0.061948, 0.571572, 35.942307, 40.952184)"><stop offset="0" style="stop-color: rgba(255, 249, 249, 0.72);"></stop><stop offset="1" style="stop-color: rgba(255, 255, 255, 0);"></stop></radialGradient>\n\t\t\t<radialGradient id="gradient-1" gradientUnits="userSpaceOnUse" cx="7.916" cy="20.156" r="31.21" gradientTransform="matrix(1.665372, 0.004509, -0.004806, 1.773443, -10.723868, -25.421527)"><stop offset="0" style="stop-color: rgba(227, 227, 227, 0);"></stop><stop offset="1" style="stop-color: rgba(0, 0, 0, 0.45);"></stop></radialGradient>\n\t\t\t<radialGradient id="gradient-2" gradientUnits="userSpaceOnUse" cx="5.259" cy="16.687" r="31.21" gradientTransform="matrix(1.490671, 0.00387, 0.00009, 1.829344, 1.658628, -19.147887)"><stop offset="0" style="stop-color: rgba(246, 243, 243, 0);"></stop><stop offset="1" style=""></stop></radialGradient>\n\t\t\t<linearGradient id="gradient-4" gradientUnits="userSpaceOnUse" x1="17.355" y1="-22.732" x2="17.355" y2="44.298" gradientTransform="matrix(0.770686, -0.637215, 0.374193, 0.45257, 22.306562, 74.687881)"><stop offset="0" style="stop-color: rgba(227, 227, 227, 0.29);"></stop><stop offset="1" style="stop-color: rgba(0, 0, 0, 0.06);"></stop></linearGradient>\n\t\t</defs>\n\t\t\x3c!--\n\t\t<ellipse style="fill: rgb(255, 0, 255);" cx="63.354" cy="78.071" rx="30.93" ry="30.717"></ellipse>\n\t\t<ellipse style="fill: rgb(0, 0, 255);" cx="63.354" cy="78.071" rx="30.93" ry="30.717"></ellipse>\n\t\t<ellipse style="fill: rgb(128, 0, 0);" cx="63.354" cy="78.071" rx="30.93" ry="30.717"></ellipse>\n\t\t--\x3e\n\t\t<circle ID="nodeColor" style="fill: rgb(35, 232, 0);" cx="32" cy="32" r="30"></circle>\n\t\t<circle style="fill:url(&quot;#gradient-2&quot;); fill-opacity: 0.28;" cx="39" cy="39" r="30" transform="matrix(1.062366, 0, 0, 1.046363, -8.38973, -7.437199)"></circle>\n\t\t<circle style="fill: url(&quot;#gradient-0&quot;); fill-opacity: 0.78;" cx="32" cy="32"  r="30"></circle>\n\t\t<circle style="fill:  url(&quot;#gradient-1&quot;); fill-opacity: 0.68;" cx="32" cy="32" r="30"></circle>\n\t\t<circle style="fill: url(&quot;#gradient-4&quot;);" cx="32" cy="32"  r="30" transform="matrix(1.00693, 0, 0, 0.99307, -0.224218, 0.3336)"></circle>\n\t';
a.setColor=function(b){var d=a.children.nodeColor;d&&(d.style.fill=b)};return a}function pa(){var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("width",66);a.setAttribute("height",66);a.setAttribute("viewBox","100 -5 130 170");a.innerHTML='   \n\t\t\t\t<ellipse cx="164.18392" cy="128.5" fill="#ffffff" id="svg_26" rx="41.17323" ry="12" stroke="#7f7f7f" stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="6"/>\n\t\t\t\t<ellipse cx="164.18392" cy="123.5" fill="#ffffff" id="svg_27" rx="41.17323" ry="12" stroke="#ffffff" stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="6"/>\n\t\t\t\t<ellipse cx="163.35715" cy="120.75" fill="#4558e8" id="svg_24" rx="35.07874" ry="11.25" stroke="#4558e8" stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="6"/>\n\t\t\t\t<rect fill="#4558e8" height="65" id="svg_25" stroke="#cccccc" stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-opacity="0" stroke-width="6" width="75.81102" x="125.62486" y="55.5"/>\n\t\t\t\t<ellipse cx="163.53037" cy="51.5" fill="#ffffff" id="svg_23" rx="41.17323" ry="12" stroke="#cccccc" stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="2"/>\n\t\t\t\t<ellipse cx="163.93392" cy="45.25" fill="#b2b2b2" id="svg_21" rx="41.17323" ry="12" stroke="#cccccc" stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="2"/>\n\n\t\t\t';
return a}function qa(){return'\n\t<g id="iconColor" class="layer" stroke="#DDDD00" fill="#DDDD00" transform="translate( 28,40) scale( 0.60)">\n\t<title>Layer 1</title>\n\t<rect  height="15" id="svg_1" opacity="0.7"  stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="3" width="33" x="17.83333" y="48.5"/>\n\t<path d="m52.033,77.5l-1.033,-42.5c0,0 24.58544,20.66514 25.82504,19.88532c1.2396,-0.77982 -24.79204,22.61468 -24.79204,22.61468z"  id="svg_3" opacity="0.7"  stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="3"/>\n\t<circle cx="93.83333" cy="33.5"  id="svg_4" opacity="0.7" r="2.82843"  stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="3"/>\n\t<circle cx="94.2201" cy="49.05119"  id="svg_5" opacity="0.7" r="2.82843"  stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="3"/>\n\t<circle cx="94.3847" cy="64.51913"  id="svg_6" opacity="0.7" r="2.82843"  stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="3"/>\n\t<circle cx="94.17787" cy="81.27198"  id="svg_7" opacity="0.7" r="2.82843"  stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="3"/>\n </g>\n '}
function ra(){return'\n\t<g id="iconColor" class="layer" stroke="#DDDD00" fill="#DDDD00" transform="translate( 36,27) scale( 0.60) ">\n\t <rect height="31"   stroke-opacity="0" stroke-width="5" width="20" x="34.5" y="43.5"/>\n\t <path d="m44.125,98.54167c0,-1 -31.75,-25.25 -31.75,-25.25c0,0 65.25,-0.25 65.125,-0.29167c-0.125,-0.04167 -33.375,26.54167 -33.375,25.54167z"  id="svg_4" stroke="#000000" stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-opacity="0" stroke-width="5"/>\n\t <rect fill="#000000" fill-opacity="0" height="11.25" stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="3" width="25.5" x="31.125" y="106.70833"/>\n\t <rect fill="#000000" fill-opacity="0" height="0.25"  stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="3" width="66.5" x="9.625" y="117.95833"/>\n\t</g>\n\t'}
function sa(){return'\n\t<g id="iconColor" class="layer" stroke="#FFFF00" transform="translate(40,45) scale( 0.50 )">\n\t<title>Layer 1</title>\n\t<path d="m57.08333,72.08333c2,8 1,18.5 1.5,22.5c0.5,4 -9.5,-1.5 -7.5,5c2,6.5 -12.5,6.5 -10.58333,-0.58333c1.91667,-7.08333 -3.41667,0.58333 -6.41667,-2.41667c-3,-3 5.5,-27 -3.58333,-33.08333c-9.08333,-6.08333 -11.91667,-12.41667 -8.91667,-26.91667c3,-14.5 7,-15 18,-18.5c11,-3.5 18,0 26.91667,9.91667c8.91667,9.91667 7.08333,14.58333 5.08333,24.58333c-2,10 -16.5,11.5 -14.5,19.5z" fill="#000000" fill-opacity="0" id="svg_3" opacity="0.7"  stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="3"/>\n\t<line fill="none" fill-opacity="0"  opacity="0.7"  stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="3" x1="33.58333" x2="58.58333" y1="86.08333" y2="86.08333"/>\n\t<line fill="none" fill-opacity="0"  opacity="0.7"  stroke-dasharray="null" stroke-linecap="null" stroke-linejoin="null" stroke-width="3" transform="rotate(-1.16913 45.8333 96.3333)" x1="34.08333" x2="57.58333" y1="96.58333" y2="96.08333"/>\n\t </g>\n\t '}
function Y(a){var b=document.createElementNS("http://www.w3.org/2000/svg","svg");b.setAttribute("width",66);b.setAttribute("height",66);b.setAttribute("viewBox","-10 0 150 150");b.innerHTML='\n\t\t\t\t<defs>\n\t\t\t\t<radialGradient id="gradient-0n" gradientUnits="userSpaceOnUse" cx="32.806" cy="38.359" r="31.21" gradientTransform="matrix(0.556701, 0.060335, -0.061948, 0.571572, 35.942307, 40.952184)"><stop offset="0" style="stop-color: rgba(255, 249, 249, 0.72);"></stop><stop offset="1" style="stop-color: rgba(255, 255, 255, 0);"></stop></radialGradient>\n\t\t\t\t<radialGradient id="gradient-1n" gradientUnits="userSpaceOnUse" cx="37.916" cy="50.156" r="31.21" gradientTransform="matrix(1.665372, 0.004509, -0.004806, 1.773443, -10.723868, -25.421527)"><stop offset="0" style="stop-color: rgba(227, 227, 227, 0);"></stop><stop offset="1" style="stop-color: rgba(0, 0, 0, 0.45);"></stop></radialGradient>\n\t\t\t\t<radialGradient id="gradient-2n" gradientUnits="userSpaceOnUse" cx="35.259" cy="46.687" r="31.21" gradientTransform="matrix(1.490671, 0.00387, 0.00009, 1.829344, 1.658628, -19.147887)"><stop offset="0" style="stop-color: rgba(246, 243, 243, 0);"></stop><stop offset="1" style=""></stop></radialGradient>\n\t\t\t\t<linearGradient id="gradient-4n" gradientUnits="userSpaceOnUse" x1="47.355" y1="12.732" x2="47.355" y2="74.298" gradientTransform="matrix(0.770686, -0.637215, 0.374193, 0.45257, 22.306562, 74.687881)"><stop offset="0" style="stop-color: rgba(227, 227, 227, 0.29);"></stop><stop offset="1" style="stop-color: rgba(0, 0, 0, 0.06);"></stop></linearGradient>\n\t\t\t</defs>\n\t\t\t\x3c!--\n\t\t\t<ellipse style="fill: rgb(255, 0, 255);" cx="63.354" cy="78.071" rx="30.93" ry="30.717"></ellipse>\n\t\t\t<ellipse style="fill: rgb(0, 0, 255);" cx="63.354" cy="78.071" rx="30.93" ry="30.717"></ellipse>\n\t\t\t<ellipse style="fill: rgb(128, 0, 0);" cx="63.354" cy="78.071" rx="30.93" ry="30.717"></ellipse>\n\t\t\t<ellipse style="fill: rgb(0, 255, 68);" cx="63.354" cy="78.071" rx="30.93" ry="30.717"></ellipse>\n\t\t\t--\x3e\n\t\t\t<circle style="fill: rgb(225, 195, 135); fill-opacity:0.5" cx="63" cy="78" r="60"></circle>\n\t\t\t<ellipse ID="nodeColor"  style="fill: rgb(255, 255, 0);" cx="63.354" cy="78.071" rx="30.93" ry="30.717"></ellipse>\n\t\t\t<circle   style="fill: url(&quot;#gradient-2n&quot;); fill-opacity: 0.68;" cx="69.539" cy="83.618" r="30.783" transform="matrix(1.062366, 0, 0, 1.046363, -8.38973, -7.437199)"></circle>\n\t\t\t<circle  style="fill: url(&quot;#gradient-0n&quot;); fill-opacity: 0.68;" cx="63.14" cy="78.072" r="30.783"></circle>\n\t\t\t\x3c!--\n\t\t\t<circle style="fill: url(&quot;#gradient-1n&quot;); fill-opacity: 0.68;" cx="63.567" cy="77.218" r="30.783"></circle>\n\t\t\t<circle style="fill: url(&quot;#gradient-4n&quot;);" cx="63.14" cy="78.925" r="30.783" transform="matrix(1.00693, 0, 0, 0.99307, -0.224218, 0.3336)"></circle>\n\t\t\t--\x3e\n\t\t'+
(a?a():"");b.setColor=function(a){var c=b.children.nodeColor;c&&(c.style.fill=a)};b.setIconColor=function(a){var c=b.children.iconColor;c&&(c.style.fill=a,c.style.stroke=a)};return b}function Aa(){function a(){var c=Date.now()/10%500;150>c?c=0:(c-=150,100<c&&250>c?c=100:(250<=c&&(c=350-c),0>c&&(c=0)));b.setSlider(100-c);d=c/100;setTimeout(a,100)}var b=document.createElementNS("http://www.w3.org/2000/svg","svg");b.setAttribute("width",166);b.setAttribute("height",250);b.setAttribute("viewBox","-10 0 150 220");
b.innerHTML='\n\t\t<defs>\n\t\t\t<linearGradient id="gradient-0c" gradientUnits="userSpaceOnUse" x1="37.908" y1="38.388" x2="37.908" y2="76.776"\n\t\t\t\t\tgradientTransform="matrix(0.29251, 0.956262, -1.062492, 0.325005, 98.316635, 28.52927)">\n\t\t\t\t\t<stop offset="0" style="stop-color: rgba(216, 216, 216, 1)"></stop>\n\t\t\t\t\t<stop offset="1" style="stop-color: rgba(165, 165, 165, 1)"></stop>\n\t\t\t</linearGradient>\n\t\t\t<bx-grid x="3.828" y="21.693" width="110.208" height="155.72"></bx-grid>\n\t\t</defs>\n\t\t<rect x="31.67" y="11.879" width="9.597" height="223.023" style="fill: rgb(216, 216, 216);" transform="matrix(1, 0, -0.000002, 1, -14.036083, -4.615945)"></rect>\n\t\t<g style="" transform="matrix(1, 0, 0, 1.070711, -35.728859, 29.265072)">\n\t\t\t<rect x="89.251" y="7.198" width="47.025" height="168.426" style="fill: rgb(216, 216, 216);"></rect><text style="fill: rgb(51, 51, 51); font-size: 11px; white-space: pre;"\n\t\t\t\t\tx="107.966" y="19.673">100</text><text style="fill: rgb(51, 51, 51); font-size: 10px; white-space: pre;" x="114.203"\n\t\t\t\t\ty="85.893" transform="matrix(1, 0, 0, 1, 1.919386, -3.358925)">60<tspan x="114.2030029296875" dy="1em">&#8203;</tspan></text><text\n\t\t\t\t\tstyle="fill: rgb(51, 51, 51); font-size: 10px; white-space: pre;" x="116.342" y="165.32">0</text><text\n\t\t\t\t\tstyle="fill: rgb(51, 51, 51); font-size: 10px; white-space: pre;" x="114.422" y="125.013">30</text><text\n\t\t\t\t\tstyle="fill: rgb(51, 51, 51); font-size: 10px; white-space: pre;" x="114.203" y="85.893" transform="matrix(1, 0, 0, 1, 0.219415, -52.050926)">90<tspan\n\t\t\t\t\t\t\tx="114.2030029296875" dy="1em">&#8203;</tspan></text><text style="fill: rgb(51, 51, 51); font-size: 10px; white-space: pre;"\n\t\t\t\t\tx="113.943" y="152.364">10</text><text style="fill: rgb(51, 51, 51); font-size: 10px; white-space: pre;" x="114.203"\n\t\t\t\t\ty="85.893" transform="matrix(1, 0, 0, 1, 0.699265, 51.595898)">20<tspan x="114.2030029296875" dy="1em">&#8203;</tspan></text><text\n\t\t\t\t\tstyle="fill: rgb(51, 51, 51); font-size: 10px; white-space: pre;" x="114.203" y="85.893" transform="matrix(1, 0, 0, 1, -0.260427, 24.724503)">40<tspan\n\t\t\t\t\t\t\tx="114.2030029296875" dy="1em">&#8203;</tspan></text><text style="fill: rgb(51, 51, 51); font-size: 10px; white-space: pre;"\n\t\t\t\t\tx="114.203" y="85.893" transform="matrix(1, 0, 0, 1, 0.699265, 10.32911)">50<tspan x="114.2030029296875" dy="1em">&#8203;</tspan></text><text\n\t\t\t\t\tstyle="fill: rgb(51, 51, 51); font-size: 10px; white-space: pre;" x="114.203" y="85.893" transform="matrix(1, 0, 0, 1, 0.219419, -19.42137)">70<tspan\n\t\t\t\t\t\t\tx="114.2030029296875" dy="1em">&#8203;</tspan></text><text style="fill: rgb(51, 51, 51); font-size: 10px; white-space: pre;"\n\t\t\t\t\tx="114.203" y="85.893" transform="matrix(1, 0, 0, 1, 0.219419, -36.215992)">80<tspan x="114.2030029296875"\n\t\t\t\t\t\t\tdy="1em">&#8203;</tspan></text><text style="fill: rgb(51, 51, 51); font-size: 10px; white-space: pre; pointer-events: none; visibility: hidden;"\n\t\t\t\t\tx="114.203" y="85.893" transform="matrix(1, 0, 0, 1, 0.219418, -46.772614)">50<tspan x="114.2030029296875"\n\t\t\t\t\t\t\tdy="1em">&#8203;</tspan></text><text transform="matrix(1, 0, 0, 1, 85.63208, -33.816761)" style="fill: rgb(51, 51, 51); font-size: 10px; white-space: pre; visibility: hidden;">\n\t\t\t\t\t<tspan x="114.203" y="85.893" dx="4.319 4.319" dy="7.198">50</tspan>\n\t\t\t\t\t<tspan x="114.203" dy="1em">&#8203;</tspan>\n\t\t\t</text>\n\t\t\t<line style="stroke: rgb(0, 0, 0);" x1="94.53" y1="14.875" x2="107.965" y2="14.395"></line>\n\t\t\t<line style="stroke: rgb(0, 0, 0);" x1="96.449" y1="162.668" x2="112.284" y2="162.188"></line>\n\t\t\t<line style="stroke: rgb(0, 0, 0);" x1="96.449" y1="94.05" x2="113.244" y2="93.57"></line>\n\t\t\t<line style="stroke: rgb(0, 0, 0);" x1="109.792" y1="149.247" x2="101.998" y2="149.586"></line>\n\t\t\t<line style="stroke: rgb(0, 0, 0);" x1="111.825" y1="135.015" x2="103.354" y2="135.354"></line>\n\t\t\t<line style="stroke: rgb(0, 0, 0);" x1="111.487" y1="121.46" x2="105.726" y2="121.46"></line>\n\t\t\t<line style="stroke: rgb(0, 0, 0);" x1="110.809" y1="107.906" x2="104.709" y2="106.212"></line>\n\t\t\t<line style="stroke: rgb(0, 0, 0);" x1="111.148" y1="79.103" x2="104.37" y2="79.442"></line>\n\t\t\t<line style="stroke: rgb(0, 0, 0);" x1="111.148" y1="63.177" x2="104.37" y2="62.499"></line>\n\t\t\t<line style="stroke: rgb(0, 0, 0);" x1="110.809" y1="46.234" x2="104.032" y2="45.895"></line>\n\t\t\t<line style="stroke: rgb(0, 0, 0);" x1="109.115" y1="30.307" x2="99.965" y2="29.968"></line>\n\t\t</g>\n\t\t<g ID="arrow" transform="matrix(1, 0, 0, 1, -13.610993, -12.375999) translate(0,158)">\n\t\t\t<path d="M 49.248 38.071 H 64.916 L 64.916 38.071 L 90.189 55.251 L 64.916 72.431 L 64.916 72.431 H 49.248 V 38.071 Z"\n\t\t\t\t\tdata-bx-shape="arrow 49.248 38.071 40.941 34.36 34.36 25.273 0 1@8e88e44e" style="fill: rgb(223, 32, 32);"\n\t\t\t\t\ttransform="matrix(0.999561, 0.029616, -0.029616, 0.999561, -5.786447, -0.060718)"></path>\n\t\t\t<ellipse style="fill: rgb(216, 216, 216);" cx="38.149" cy="38.868" rx="13.195" ry="4.799"></ellipse>\n\t\t\t<rect x="23.993" y="38.388" width="27.831" height="38.388" style="fill: url(&quot;#gradient-0c&quot;);"></rect>\n\t\t</g> \n\t\t';
b.setSlider=function(a){b.children.arrow.setAttribute("transform",`matrix(1, 0, 0, 1, -13.610993, -12.375999) translate(0,${(100-a)/100*159})`)};var d=0;a();b.getValue=function(){return d};return b}function D(){var a={on:Y(sa),off:Y(sa)};a.on.setColor("#0000C0");a.on.setIconColor("#eeeee20");a.off.setColor("#000050");a.off.setIconColor("#000000");return a}function O(){var a={on:Y(ra),off:Y(ra)};a.on.setColor("#C00000");a.on.setIconColor("#eeeee20");a.off.setColor("#501010");a.off.setIconColor("#000000");
return a}function ba(){var a={on:Y(qa),off:Y(qa)};a.on.setColor("#C00000");a.on.setIconColor("#eeeee20");a.off.setColor("#501010");a.off.setIconColor("#000000");return a}function V(a,b){function d(a){var c=a.hMenu=fa();a.hMenu.appendItem(1,1001,"Add Neuron");a.hMenu.appendItem(1,1011,"Add Oscillator");a.hMenu.appendItem(1,1010,"Add Tick Oscillator");a.hMenu.appendItem(3,a.hMenuComponents=fa(),"Add &Component");a.brain.brainStems.forEach((c)=>{BuildBrainstemMenus(a.hMenuComponents,c,a.menus,a.connectors,
0)});c.appendItem(4,0,0);c.appendItem(1,1003,"Reset");c.appendItem(1,1002,"RUN");c.appendItem(4,0,0);var b;c.appendItem(3,b=fa(),"Zoom");a.menus.push(b);b.appendItem(1,1020,"x1");b.appendItem(1,1021,"x2");b.appendItem(1,1022,"x4");c.appendItem(1,1008,"Default Neuron");c.appendItem(1,1009,"Default Synapse");c.appendItem(1,1012,"Sigmoid Constant")}if(!(this instanceof V))return new V(a,b);this.flags={bOwnBrain:!1};this.hMenu;this.hMenuComponents;this.background_methods;this.neuron_methods;this.input_methods;
this.output_methods;this.nerve_methods;this.connectors=[];this.menus=[];this.events={};this.board=new u(b);this.background_methods=E(this);this.neuron_methods=new w(this);this.tick_oscillator_methods=new ha(this);this.oscillator_methods=new ia(this);this.input_methods=new F(this);this.button_input_methods=new T(this);this.slider_input_methods=new W(this);this.light_output_methods=new Z(this);this.output_methods=new G(this);this.nerve_methods=new M(this);this.brain=a;(function(a){a.InputPeice=null;
a.OutputPeice=null;a.lightOutputPeice=a.board.CreatePeice("light",D(),p.neuron.cells.width,p.neuron.cells.height,(p.neuron.cells.width-1)/2|0,(p.neuron.cells.height-1)/2|0,a.light_output_methods);a.buttonInputPeice=a.board.CreatePeice("button",O(),p.neuron.cells.width,p.neuron.cells.height,(p.neuron.cells.width-1)/2|0,(p.neuron.cells.height-1)/2|0,a.button_input_methods);a.sliderInputPeice=a.board.CreatePeice("slider",ba(),p.neuron.cells.width,p.neuron.cells.height,(p.neuron.cells.width-1)/2|0,(p.neuron.cells.height-
1)/2|0,a.slider_input_methods);a.OscillatorPeice=a.board.CreatePeice("oscil",aa(),p.neuron.cells.width,p.neuron.cells.height,(p.neuron.cells.width-1)/2|0,(p.neuron.cells.height-1)/2|0,a.oscillator_methods);a.TickOscillatorPeice=a.board.CreatePeice("tickosc",aa(),p.neuron.cells.width,p.neuron.cells.height,(p.neuron.cells.width-1)/2|0,(p.neuron.cells.height-1)/2|0,a.tick_oscillator_methods);a.NeuronPeice=a.board.CreatePeice("neuron",aa(),p.neuron.cells.width,p.neuron.cells.height,(p.neuron.cells.width-
1)/2|0,(p.neuron.cells.height-1)/2|0,a.neuron_methods);var b=document.createElement("img");b.src=p.pathway.image;var c=document.createElement("img");c.src=p.pathway.imageNeg;a.NervePeice=a.board.CreateVia("nerve",b,c,a.nerve_methods);a.BackgroundPeice=null;a.board.SetCellSize(16,16);a.brain?a.flags.bOwnBrain=0:(a.flags.bOwnBrain=1,a.brain=new BRAIN);a.board.SetCellSize(p.cell.width,p.cell.height);b=document.createElement("img");b.src=p.background.image;a.BackgroundPeice=a.board.CreatePeice("background",
b,p.background.cells.width,p.background.cells.height,(p.background.cells.width-1)/2|0,(p.background.cells.height-1)/2|0,a.background_methods);a.board.SetBackground(a.BackgroundPeice);a.connectors=[];a.menus.length||d(a);a.DefaultNeuron=a.brain.Neuron();a.DefaultSynapse=a.brain.Synapse()})(this);this.reset=function(){this.board.SetBackground(this.BackgroundPeice);this.board.reset();this.scale=0};this.scale=0}function M(a){if(!(this instanceof M))return new MERVE_METHODS(a);this.brainboard=a;this.synapse=
null}function F(a){if(!(this instanceof F))return new F(a);this.brainboard=a;this.level_colors=[]}function G(a){if(!(this instanceof G))return new G(a);this.brainboard=a;this.level_colors=[]}function w(a){this.brainboard=a;this.c_input=[];this.c_threshold=[];this.connected=[]}function Z(a){if(!(this instanceof Z))return new Z(a);w.call(this,a);this.brainboard=a}function T(a){if(!(this instanceof T))return new T(a);w.call(this,a);this.brainboard=a}function W(a){if(!(this instanceof W))return new W(a);
w.call(this,a);this.brainboard=a}function E(a){if(!(this instanceof E))return new E(a);this.brainboard=a}function ia(a){this.brainboard=a}function ha(a){this.brainboard=a}function fa(){var a={items:[],parent:null,container:document.createElement("div"),board:null,appendItem(a,d,c){if(a&4){var b=document.createElement("HR");this.container.appendChild(b)}else{b=document.createElement("A");var f=document.createElement("BR");this.container.appendChild(b);this.container.appendChild(f);b.value=d;b.textContent=
c;b.className="popup";a&2?(d.parent=this,b.addEventListener("mouseover",(a)=>{var c=b.getBoundingClientRect();console.log("Item is clicked show that.",a.target.value,a.clientX,a.clientY);b.value.show(this.board,a.clientX,c.top-10,this.cb)}),b.addEventListener("mouseout",(a)=>{var c=b.getBoundingClientRect();console.log("Item is clicked show that.",a.target.value,a.clientX,c.top);a.toElement!==b.value.container&&b.value.hide()})):b.addEventListener("click",(a)=>{this.cb(a.target.value);console.log("Item is clicked.",
a.target.value);this.hide(!0)})}},hide(a){this.container.style.visibility="hidden";this.parent?a&&this.parent.hide(a):ca.style.visibility="hide"},show(a,d,c,e){this.board=a;this.cb=e;ca.style.visibility="visible";this.container.style.visibility="inherit";this.container.style.left=d;this.container.style.top=c},reset(){console.log("hide everything?")}};ca.appendChild(a.container);a.container.className="popup";a.container.style.zIndex=50;return a}function ta(a){function b(){var e=c.children.drivePivot,
f=Date.now()/1E3,m;e.setAttribute("cx",m=d.x+20*Math.sin(-f%(1/a)*2*Math.PI*a));e.setAttribute("cy",f=d.y+20*Math.cos(f%(1/a)*2*Math.PI*a));e=f+Math.sqrt(6400-(m-d.x)*(m-d.x));m=`M${m},${f} L${d.x},${e}`;k.setAttribute("d",m);m=`M${d.x},${e} L${d.x},${e+10}`;e+=10;q.setAttribute("d",m);m=140;e>m?(m=e,h=1):h=0;m=`M${d.x-10},${m} L${d.x+10},${m}`;g.setAttribute("d",m);requestAnimationFrame(b)}var d={x:50,y:50},c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.style.width=100;c.style.height=
175;var e=document.createElementNS("http://www.w3.org/2000/svg","circle");e.id="driveRotor";e.setAttribute("r","40");e.setAttribute("cx","50");e.setAttribute("cy","50");e.setAttribute("fill","yellow");var f=document.createElementNS("http://www.w3.org/2000/svg","circle");f.id="drivePivot";f.setAttribute("r","4");f.setAttribute("fill","black");var k=document.createElementNS("http://www.w3.org/2000/svg","path");k.classList.add("switcher");k.id="driveArm";k.setAttribute("stroke","blue");k.setAttribute("stroke-width",
"10");k.setAttribute("stroke-linecap","round");var q=document.createElementNS("http://www.w3.org/2000/svg","path");q.classList.add("switcher");q.id="driveRod";q.setAttribute("stroke","blue");q.setAttribute("stroke-width","5");q.setAttribute("stroke-linecap","round");q.setAttribute("stroke-linecap","round");var g=document.createElementNS("http://www.w3.org/2000/svg","path");g.id="buttonPad";g.setAttribute("stroke","red");g.setAttribute("stroke-width","10");g.setAttribute("stroke-linecap","round");
c.appendChild(e);c.appendChild(f);c.appendChild(k);c.appendChild(q);c.appendChild(g);var h=0;b();c.getValue=function(){return h};return c}function Ba(a,b,d,c){var e=document.createElementNS("http://www.w3.org/2000/svg","path");const f=d-30;e.setAngle=function(c){350<c&&(c=350);2>c&&(c=2);var k=Math.PI/180*c,g=a+Math.sin(k)*f,h=b-Math.cos(k)*f,B=" M "+(a+0)+" "+(b-d);B+=` A ${d} ${d}, 0, ${180>c?0:1}, 1, ${a+Math.sin(k)*d} ${b-Math.cos(k)*d} `;B+=` L ${g} ${h}`;B+=` A ${f} ${f}, 0, ${180>c?0:1}, 0, ${a+
0} ${b-f} `;B+="Z";e.setAttribute("d",B)};e.setAngle(0);return e}function Ca(a){function b(){g.setAngle(h);B&&(h-=3);0>h&&(h=0,l=B=!1,a(!0,!1));setTimeout(b,100)}function d(){l?(B=!0,a(!1,!0),q.setAttribute("fill","#f53230")):(B=!1,a(!1,!1),q.setAttribute("fill","#a51210"),h=360)}var c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.style.width=250;c.style.height=125;var e=document.createElementNS("http://www.w3.org/2000/svg","rect");e.setAttribute("x","0");e.setAttribute("y","0");
e.setAttribute("width","200");e.setAttribute("height","125");e.setAttribute("stroke","none");e.setAttribute("fill","#d0c090");c.appendChild(e);e=document.createElementNS("http://www.w3.org/2000/svg","rect");e.setAttribute("x","5");e.setAttribute("y","5");e.setAttribute("width","190");e.setAttribute("height","115");e.setAttribute("stroke","black");e.setAttribute("fill","none");c.appendChild(e);e=document.createElementNS("http://www.w3.org/2000/svg","defs");var f=document.createElementNS("http://www.w3.org/2000/svg",
"pattern");f.id="transformedPattern";f.setAttribute("x",20);f.setAttribute("y",10);f.setAttribute("width",5);f.setAttribute("height",5);f.setAttribute("patternUnits","userSpaceOnUse");f.setAttribute("patternTransform","rotate(15)");e.appendChild(f);var k=document.createElementNS("http://www.w3.org/2000/svg","rect");k.setAttribute("x","0");k.setAttribute("y","0");k.setAttribute("width","30");k.setAttribute("height","2");k.setAttribute("stroke","black");k.setAttribute("fill","none");f.appendChild(k);
k=document.createElementNS("http://www.w3.org/2000/svg","rect");k.setAttribute("x","0");k.setAttribute("y","0");k.setAttribute("width","2");k.setAttribute("height","20");k.setAttribute("fill","black");f.appendChild(k);k=document.createElementNS("http://www.w3.org/2000/svg","circle");k.setAttribute("cx","10");k.setAttribute("cy","10");k.setAttribute("r","10");k.setAttribute("fill","black");c.appendChild(e);var q=document.createElementNS("http://www.w3.org/2000/svg","circle");q.id="testButton";q.setAttribute("r",
"15");q.setAttribute("cx","50");q.setAttribute("cy","50");q.setAttribute("fill","#a51210");q.setAttribute("stroke","white");q.setAttribute("stroke-width","5");c.appendChild(q);e=document.createElementNS("http://www.w3.org/2000/svg","text");e.textContent="TEST";e.setAttribute("x","22");e.setAttribute("y","100");e.setAttribute("font-size","24px");e.setAttribute("font-style","sans-serif");e.setAttribute("stroke","black");c.appendChild(e);var g=Ba(125,60,45,90);g.setAttribute("fill","red");g.setAttribute("stroke",
"black");g.setAttribute("stroke-width","2");c.appendChild(g);var h=360,B=!1;b();var l=!1;c.addEventListener("click",(a)=>{a.preventDefault();l=!l;d()});c.reset=function(){h=360;B=!1;a(!1,!1);l=!1;d()};return c}function Da(a){function b(){var c,d=Date.now(),g=d-k,h,l=0;e.forEach((b,d)=>{b.history.push({del:g,value:a(d)});l=3==d?45:20;c="M390,"+(l+20+20*d);h=0;for(var e=b.history.length-1;0<e;e--){if(15E3<h){b.history.splice(0,e);break}var f=b.history[e];c+="L"+(390-(h+f.del)/15E3*340)+","+(20+l+20*
d-f.value/10);h+=f.del}b.path.setAttribute("d",c)});f.forEach((b,d)=>{b.history.push({del:g,value:a(4+d)});c="M390,"+(135+20*d);h=0;l=15;for(var e=b.history.length-1;0<e;e--){if(15E3<h){b.history.splice(0,e);break}var f=b.history[e];c+="L"+(390-(h+f.del)/15E3*340)+","+(20+l+115+20*d-f.value/10);h+=f.del}b.path.setAttribute("d",c)});k=d;setTimeout(b,100)}var d=document.createElementNS("http://www.w3.org/2000/svg","svg");d.style.width=420;d.style.height=330;var c=document.createElementNS("http://www.w3.org/2000/svg",
"rect");c.setAttribute("x","0");c.setAttribute("y","0");c.setAttribute("width","420");c.setAttribute("height","230");c.setAttribute("stroke","none");c.setAttribute("fill","#d0c090");d.appendChild(c);c=document.createElementNS("http://www.w3.org/2000/svg","rect");c.setAttribute("x","5");c.setAttribute("y","5");c.setAttribute("width","410");c.setAttribute("height","220");c.setAttribute("stroke","black");c.setAttribute("fill","none");d.appendChild(c);c=document.createElementNS("http://www.w3.org/2000/svg",
"circle");c.id="logicJack";c.setAttribute("r","5");c.setAttribute("cx","22");c.setAttribute("cy","40");c.setAttribute("fill","#657210");c.setAttribute("stroke","#805040");c.setAttribute("stroke-width","2");d.appendChild(c);c=document.createElementNS("http://www.w3.org/2000/svg","circle");c.id="logicJack";c.setAttribute("r","5");c.setAttribute("cx","22");c.setAttribute("cy","60");c.setAttribute("fill","#657210");c.setAttribute("stroke","#805040");c.setAttribute("stroke-width","2");d.appendChild(c);
c=document.createElementNS("http://www.w3.org/2000/svg","circle");c.id="logicJack";c.setAttribute("r","5");c.setAttribute("cx","22");c.setAttribute("cy","80");c.setAttribute("fill","#657210");c.setAttribute("stroke","#805040");c.setAttribute("stroke-width","2");d.appendChild(c);c=document.createElementNS("http://www.w3.org/2000/svg","circle");c.id="logicJack";c.setAttribute("r","5");c.setAttribute("cx","22");c.setAttribute("cy","100");c.setAttribute("fill","#657210");c.setAttribute("stroke","#805040");
c.setAttribute("stroke-width","2");d.appendChild(c);c=document.createElementNS("http://www.w3.org/2000/svg","rect");c.setAttribute("x","45");c.setAttribute("y","15");c.setAttribute("width","350");c.setAttribute("height","200");c.setAttribute("stroke","white");c.setAttribute("fill","black");c.setAttribute("stroke-width","2");d.appendChild(c);var e=[{history:[],path:document.createElementNS("http://www.w3.org/2000/svg","path")},{history:[],path:document.createElementNS("http://www.w3.org/2000/svg",
"path")},{history:[],path:document.createElementNS("http://www.w3.org/2000/svg","path")},{history:[],path:document.createElementNS("http://www.w3.org/2000/svg","path")}],f=[{history:[],path:document.createElementNS("http://www.w3.org/2000/svg","path")},{history:[],path:document.createElementNS("http://www.w3.org/2000/svg","path")},{history:[],path:document.createElementNS("http://www.w3.org/2000/svg","path")},{history:[],path:document.createElementNS("http://www.w3.org/2000/svg","path")}];e.forEach((a,
b)=>{3==b?a.path.setAttribute("stroke","yellow"):a.path.setAttribute("stroke","red");d.appendChild(a.path)});f.forEach((a,b)=>{a.path.setAttribute("stroke","skyblue");d.appendChild(a.path)});var k=Date.now();b();return d}function ua(a){var b=document.createElement("IMG");b.src=a;b.style.width="100%";return b}function va(){da.step();setTimeout(va,1)}function wa(a,b,d){a=g.board.PutPeice(g.sliderInputPeice,b,d,()=>v[2].getValue());g.events.added&&g.events.added(g.sliderInputPeice,a)}function C(a,b,
d){b=g.board.PutPeice(g.buttonInputPeice,b,d,()=>a<v.length?v[a].getValue():0);g.events.added&&g.events.added(g.buttonInputPeice,b)}function z(a,b,d){a=g.board.PutPeice(g.lightOutputPeice,b,d,(a)=>a);r.push(a);g.events.added&&g.events.added(g.lightOutputPeice,a)}function Ea(){h.getExpectedValue=()=>100*(v[0].getValue()&v[1].getValue())}function Fa(){A.clear();g.reset();r.length=0;z(0,15,10);h.getExpectedValue=()=>100*v[0].getValue();h.getTestValue=()=>100*r[0].value}function Ga(){A.clear();g.reset();
C(0,2,10);r.length=0;z(0,15,10);z(1,15,15);h.getExpectedValue=()=>200*v[0].getValue();h.getTestValue=()=>100*r[0].value+100*r[1].value}function Ha(){A.clear();g.reset();C(0,2,9);C(1,2,15);r.length=0;z(0,15,6);z(1,15,10);z(2,15,14);z(3,15,18);h.getExpectedValue=()=>100*(v[0].getValue()+v[1].getValue());h.getTestValue=()=>50*r[0].value+50*r[1].value+50*r[2].value+50*r[3].value}function Ia(){A.clear();g.reset();wa(0,2,12);r.length=0;z(0,15,12);h.getExpectedValue=()=>.5<v[2].getValue()?100:0;h.getTestValue=
()=>100*r[0].value}function Ja(){A.clear();g.reset();wa(0,2,12);r.length=0;z(0,15,6);z(1,15,10);z(2,15,14);z(3,15,18);h.getExpectedValue=()=>.8<v[2].getValue()?200:.6<v[2].getValue()?150:.4<v[2].getValue()?100:.2<v[2].getValue()?50:0;h.getTestValue=()=>50*r[0].value+50*r[1].value+50*r[2].value+50*r[3].value}function Ka(){A.clear();g.reset();r.length=0;C(0,2,9);C(1,2,15);z(0,15,12);h.getExpectedValue=()=>v[0].getValue()||v[1].getValue()?100:0;h.getTestValue=()=>100*r[0].value}function La(){A.clear();
g.reset();r.length=0;C(0,2,9);C(1,2,15);z(0,15,12);h.getExpectedValue=()=>v[0].getValue()&&v[1].getValue()?100:0;h.getTestValue=()=>100*r[0].value}function Ma(){A.clear();g.reset();r.length=0;C(0,2,9);C(1,2,15);z(0,15,12);h.getExpectedValue=()=>!v[0].getValue()&&v[1].getValue()?100:0;h.getTestValue=()=>100*r[0].value}function Na(){A.clear();g.reset();r.length=0;C(0,2,9);z(0,15,9);h.getExpectedValue=()=>v[0].getValue()?0:100;h.getTestValue=()=>100*r[0].value}function Oa(){A.clear();g.reset();r.length=
0;C(0,2,9);C(1,2,15);z(0,15,12);h.getExpectedValue=()=>!!v[0].getValue()^!!v[1].getValue()?100:0;h.getTestValue=()=>100*r[0].value}function ja(a,b){function d(){var c;return(c=g.board.GetLayerAt(a,b,null))||(c=g.board.GetLayerAt(a+1,b,null))||(c=g.board.GetLayerAt(a-1,b,null))||(c=g.board.GetLayerAt(a,b+1,null))||(c=g.board.GetLayerAt(a+1,b+1,null))||(c=g.board.GetLayerAt(a-1,b+1,null))||(c=g.board.GetLayerAt(a,b-1,null))||(c=g.board.GetLayerAt(a+1,b-1,null))?c:(c=g.board.GetLayerAt(a-1,b-1,null))?
c:null}var c=d();if(!c)return{x:a,y:b};var e,f;for(f=1;14>f;f++){a+=4;b-=4;c=d();if(!c)break;for(e=0;e<2*f;e++)if(b+=4,c=d(),!c)return{x:a,y:b};for(e=0;e<2*f;e++)if(a-=4,c=d(),!c)return{x:a,y:b};for(e=0;e<2*f;e++)if(b-=4,c=d(),!c)return{x:a,y:b};for(e=0;e<2*f-1;e++)if(a+=4,c=d(),!c)return{x:a,y:b};a+=4}return{x:a,y:b}}function xa(){g.board.BoardRefresh();requestAnimationFrame(xa)}function ea(a){if(!(h.progressLocked&&a>h.journalState)){ya.reset();h.journalState=a;a>h.journalStateMax&&(h.journalStateMax=
a,localStorage.setItem("maxPage",h.journalStateMax));h.progressLocked=P[h.journalState].locked||!1;U.innerHTML=P[h.journalState].HTML;if(a=U.querySelector('[id="pageNum"]'))a.textContent=""+(h.journalState+1);P[h.journalState].activate&&P[h.journalState].activate()}}l.algo={digital:0,analog:1,sigmoid:2};Object.seal(l.algo);l.prototype.clone=function(){var a=new l(this.brain);a.threshold=this.threshold;a.cycle=this.cycle;a.type=this.type;return a};l.prototype.output=function(a){switch(this.algorithm){case l.algo.analog:return a-=
this.threshold,1<a&&(a=1),0>a&&(a=0),a;case l.algo.digital:return a>this.threshold?1:0;case l.algo.sigmoid:return a=1/(1+Math.exp(-this.k*(a-this.threshold))),0>=a?a=0:1<a&&(a=1),a}};Object.defineProperty(l.prototype,"value",{get:function(){this.cycle!=this.brain.cycle&&(this.cycle=this.brain.cycle,this.input=this.inputs.reduce((a,b)=>a+(b?b.value:0),0));if(this.input>this.threshold)return this.on=!0,this.output(this.input);this.on=!1;return 0}});l.prototype.attachSynapse=function(a){return void 0!==
a?{nerves:this.inputs,id:a}:{nerves:this.inputs,id:this.inputs.length}};l.prototype.attachSynapseFrom=function(a){return void 0!==a?{nerves:this.outputs,id:a}:{nerves:this.outputs,id:this.outputs.length}};l.prototype.detachSynapse=function(a){var b=this.inputs.findIndex((b)=>b===a);0<=b&&(this.inputs[b]=null)};l.prototype.detachSynapseFrom=function(a){var b=this.outputs.findIndex((b)=>b===a);0<=b&&(this.outputs[b]=null)};l.prototype.attach=function(a){var b=this.brain.Synapse();this.inputs.push(b);
a.outputs.push(b);b.input=a;b.output=this;this.brain.changed=!0;return b};l.prototype.detach=function(a){if(a){var b=this.inputs.findIndex((c)=>c.input===a?!0:!1);if(0>b){if(b=this.outputs.findIndex((c)=>c.output===a?!0:!1),0<=b){var d=this.outputs[b];this.outputs.splice(b,1);d.output.inputs.find((a,b)=>a===d?(d.output.inputs.splice(b,1),!0):!1)}}else d=this.inputs[b],this.inputs.splice(b,1),d.input.outputs.find((a,b)=>a===d?(d.input.outputs.splice(b,1),!0):!1)}else{for(;this.inputs.length;)this.detach(this.inputs[0].input);
for(;this.outputs.length;)this.detach(this.outputs[0].output)}this.brain.changed=!0};X.prototype=Object.create(l);X.prototype.output=function(a){return 1/(1+Math.exp(-this.k))};X.prototype.clone=function(){l.prototype.clone.call(this).k=n.k};Q.prototype=Object.create(l.prototype);Q.prototype.output=function(a){return 1/(1+Math.exp(-this.k))};Object.defineProperty(Q.prototype,"value",{get:function(){return Math.sin(2*Math.PI*(this.freq*Date.now()/1E3%1))}});Q.prototype.clone=function(){l.prototype.clone.call(this).freq=
this.freq};R.prototype=Object.create(l.prototype);R.prototype.output=function(a){return 1/(1+Math.exp(-this.k))};Object.defineProperty(R.prototype,"value",{get:function(){return Math.sin(2*this.brain.cycle*Math.PI/this.freq)}});R.prototype.clone=function(){l.prototype.clone.call(this).ticks=n.ticks};N.prototype=Object.create(l.prototype);N.prototype.output=function(a){return a};Object.defineProperty(N.prototype,"value",{get:function(){return this.inputs=this.cb()}});N.prototype.clone=function(){return new N(this.brain,
this.cb)};S.prototype=Object.create(l.prototype);S.prototype.output=function(a){a=this.cb(a);this.on=!!a;return a};S.prototype.clone=function(){return new S(this.brain,this.cb)};var za=Object.freeze({Neuron:l,Sigmoid:X,Oscillator:Q,TickOscillator:R,External:N,Exporter:S,default:{Neuron:l,Oscillator:Q,TickOscillator:R,External:N,Exporter:S}});Object.defineProperty(K.prototype,"value",{get:function(){return this.input?this.gain*this.input.value:0}});K.prototype.clone=function(){var a=new K;a.gain=this.gain;
return a};K.prototype.AttachSource=function(a,b){if(!b&&a)for(var d=0;!(b=a.AttachSynapse(d))&&d<MAX_NERVES;d++);return!this.input&&a&&b?(b.nerves[b.id]=this,this.input=a,!0):!1};K.prototype.AttachDestination=function(a,b){if(!b&&a)for(var d=0;!(b=a.AttachSynapse(d))&&d<MAX_NERVES;d++);return!this.output&&a&&b?(b.nerves[b.id]=this,this.output=a,!0):!1};K.prototype.DetachDestination=function(){var a=this.output;a&&(this.output=null,a.detachSynapse(this))};K.prototype.DetachSource=function(){var a=
this.input;a&&(this.input=null,a.detachSynapseFrom(this))};var p={cell:{width:48,height:48},background:{cells:{width:5,height:5},image:"board/images/background2.gif"},neuron:{cells:{width:3,height:3},image:"board/images/neuron.png",colors:[[240,0,15790080],[15728640,7566195,61440]]},input:{cells:{width:3,height:3},image:"board/images/input.gif"},output:{cells:{width:3,height:3},image:"board/images/output.gif"},pathway:{cells:{width:7,height:7},image:"board/images/AlphaNerves.png",imageNeg:"board/images/AlphaNerves-neg.png"}};
const x={NOWHERE:-1,UP:0,UP_RIGHT:1,RIGHT:2,DOWN_RIGHT:3,DOWN:4,DOWN_LEFT:5,LEFT:6,UP_LEFT:7};Object.freeze(x);const H=[{x:0,y:-1},{x:1,y:-1},{x:1,y:0},{x:1,y:1},{x:0,y:1},{x:-1,y:1},{x:-1,y:0},{x:-1,y:-1}];Object.freeze(H);H.forEach((a)=>Object.freeze(a));L.prototype.getimage=function(){return this.image};L.prototype.getcell=function(a,b){this.lastCell.coords=this.grid[a%this.size.cols][b%this.size.rows];return this.lastCell};L.prototype.getCellSize=function(){return this.cellSize};L.prototype.getsize=
function(){return this.size};L.prototype.gethotspot=function(){return this.hot};I.prototype=Object(L.prototype);I.prototype.constructor=I;I.prototype.GetViaEnd=function(a,b){switch(a){case 7:return this.getcell(2,2,b);case 0:return this.getcell(3,2,b);case 1:return this.getcell(4,2,b);case 2:return this.getcell(4,3,b);case 3:return this.getcell(4,4,b);case 4:return this.getcell(3,4,b);case 5:return this.getcell(2,4,b);case 6:return this.getcell(2,3,b);case -1:return this.getcell(3,3,b)}return null};
I.prototype.GetViaFill1=function(a,b,d,c){a={x:0,y:0,cell:null};switch(d){case 7:a.x=0;a.y=-1;a.cell=this.getcell(5,0,c);break;case 3:a.x=1;a.y=0;a.cell=this.getcell(5,0,c);break;case 1:a.x=0;a.y=-1;a.cell=this.getcell(1,0,c);break;case 5:a.x=-1,a.y=0,a.cell=this.getcell(1,0,c)}return a};I.prototype.GetViaFill2=function(a,b,d,c){a={x:0,y:0,cell:null};switch(d){case 7:return a.x=-1,a.y=0,a.cell=this.getcell(4,1,c),a;case 3:return a.x=0,a.y=1,a.cell=this.getcell(4,1,c),a;case 1:return a.x=1,a.y=0,a.cell=
this.getcell(2,1,c),a;case 5:return a.x=0,a.y=1,a.cell=this.getcell(2,1,c),a}return null};I.prototype.GetViaStart=function(a,b){switch(a){case 7:return this.getcell(6,6,b);case 0:return this.getcell(3,5,b);case 1:return this.getcell(0,6,b);case 2:return this.getcell(1,3,b);case 3:return this.getcell(0,0,b);case 4:return this.getcell(3,1,b);case 5:return this.getcell(6,0,b);case 6:return this.getcell(5,3,b);case -1:return this.getcell(3,3,b)}return null};I.prototype.GetViaFromTo=function(a,b,d){if(-1==
a)return this.GetViaStart(b,d);if(-1==b)return this.GetViaEnd(a,d);switch(a|b<<4){case 22:case 97:return this.getcell(4,6,d);case 38:case 98:return this.getcell(3,0,d);case 39:case 114:return this.getcell(2,6,d);case 54:case 99:return this.getcell(4,0,d);case 55:case 115:return this.getcell(5,1,d);case 48:case 3:return this.getcell(0,4,d);case 71:case 116:return this.getcell(6,2,d);case 64:case 4:return this.getcell(0,3,d);case 65:case 20:return this.getcell(0,2,d);case 80:case 5:return this.getcell(6,
4,d);case 81:case 21:return this.getcell(1,1,d);case 82:case 37:return this.getcell(2,0,d)}return null};I.prototype.Move=function(){return 0};I.prototype.Stop=function(){return 0};t.prototype.Move=function(){return!1};t.prototype.Stop=function(){return!1};t.prototype.name=function(){return"default methods"};t.prototype.SetPeice=function(a){this.master=a};t.prototype.getimage=function(){return this.master.getimage()};t.prototype.getcell=function(a,b){return this.master.getcell(a,b)};t.prototype.getimage=
function(a){return this.master.getimage(a)};t.prototype.getcell=function(a,b,d){return this.master.getcell(a,b,d)};t.prototype.gethotspot=function(){return this.master.gethotspot()};t.prototype.getsize=function(){return this.master.getsize()};t.prototype.Create=function(a){return 0};t.prototype.Disconnect=function(a){return 0};t.prototype.Destroy=function(a){};t.prototype.Update=function(a,b){};t.prototype.OnMove=function(a){};t.prototype.ConnectBegin=function(a,b,d,c,e){return!1};t.prototype.ConnectEnd=
function(a,b,d,c,e){return!1};t.prototype.OnClick=function(a,b,d){return!1};t.prototype.OnRightClick=function(a,b,d){return!1};t.prototype.OnDoubleClick=function(a,b,d){return!1};t.prototype.Draw=function(a,b,d,c,e){d.drawImage(a.image,c,e,this.master.size.cols*this.brainboard.board.cellSize.width,this.master.size.rows*this.brainboard.board.cellSize.height)};t.prototype.DrawCell=function(a,b,d,c,e,f){"on"in this.master.image?d.drawImage(this.master.image.on,c.coords.x,c.coords.y,c.size.width,c.size.height,
e,f,this.brainboard.board.cellSize.width,this.brainboard.board.cellSize.height):d.drawImage(this.master.image,c.coords.x,c.coords.y,c.size.width,c.size.height,e,f,this.brainboard.board.cellSize.width,this.brainboard.board.cellSize.height)};J.prototype=Object(t.prototype);J.prototype.constructor=J();J.prototype.Move=function(){return 0};J.prototype.Stop=function(){return 0};J.prototype.OnClick=function(a,b,d){console.log("GENERATE DISCONNECT!");this.master.board.UnendPath();return 0};J.prototype.OnRightClick=
function(a,b,d){return 0};J.prototype.OnDoubleClick=function(a,b,d){return 0};y.prototype.IsLayerAt=function(a,b){var d,c;if(this.flags.bRoot||this.min_x+this.w<=a||this.min_y+this.h<=b||this.min_x>a||this.min_y>b)return null;if(!this.flags.bRoute)return{x:a-this.x,y:b-this.y};for(c=0;d=this.pds_path[this.pds_path.length-1-c];c++)if(d.x+this.x==a&&d.y+this.y==b)return{x:d.x,y:d.y};return null};y.prototype.link_top=function(){var a;if(a=this.board.rootLayer){if(this.next=a.next)this.next.prior=this;
this.prior=null;a.next||(a.prior=this);a.next=this}};y.prototype.Link=function(a,b,d,c){void 0===d&&(d=0);void 0===c&&(c=0);this.linked.push(a);switch(b){case 0:a.route_start_layer.layer=this;a.route_start_layer.x=d;a.route_start_layer.y=c;break;case 1:a.flags.bEnded=!0,a.route_end_layer.layer=this,a.route_end_layer.x=d,a.route_end_layer.y=c}};y.prototype.Unlink=function(){if(this.route_end_layer.layer){this.flags.bEnded=!1;var a=this.route_end_layer.layer.linked.findIndex((a)=>a===this);0<=a&&this.route_end_layer.layer.linked.splice(a,
1);this.route_end_layer.layer=null}else this.route_start_layer.layer&&(a=this.route_start_layer.layer.linked.findIndex((a)=>a===this),0<=a&&this.route_start_layer.layer.linked.splice(a,1),this.route_start_layer.layer=null)};y.prototype.Draw=function(a,b,d,c){if(!this.flags.bRoot){this.scale=a.GetScale();a.GetSize();var e=a.GetCellSize();if(this.flags.bRoute){var f=this.peice;this.pds_path.forEach((g)=>{var h;a.selected===this.psvInstance&&b.fillRect(d+g.x*e.width,c+g.y*e.height,e.width,e.height);
(h=f.GetViaFromTo(g.flags.BackDir,g.flags.ForeDir,void 0))&&this.peice.methods.DrawCell(this.peice,this.psvInstance,b,h,d+g.x*e.width,c+g.y*e.height);(h=f.GetViaFill1(void 0,void 0,g.flags.ForeDir,void 0))&&h.cell&&this.peice.methods.DrawCell(this.peice,this.psvInstance,b,h.cell,d+(g.x+h.x)*e.width,c+(g.y+h.y)*e.height);(h=f.GetViaFill2(void 0,void 0,g.flags.ForeDir,void 0))&&h.cell&&this.peice.methods.DrawCell(this.peice,this.psvInstance,b,h.cell,d+(g.x+h.x)*e.width,c+(g.y+h.y)*e.height)})}else{var g,
h,m=this.peice.gethotspot(),l=this.peice.getsize();for(g=-m.x;g<l.cols-m.x;g++)for(h=-m.y;h<l.rows-m.y;h++){var p=this.peice.methods.master.getcell(g+m.x,h+m.y);a.selected===this.psvInstance&&b.fillRect(d+g*e.width,c+h*e.height,e.width,e.height);this.peice.methods.DrawCell(this.peice,this.psvInstance,b,p,d+g*e.width,c+h*e.height)}}}};y.prototype.GetPeice=function(){return this.peice};y.prototype.FindLayer=function(a){return pool.find((b)=>b.iLayer==-a?b:0)};y.prototype.BeginPath=function(a,b,d){void 0===
d&&(d=x.NOWHERE);var c=ka();this.x=a;this.y=b;this.min_x=a;this.min_y=b;this.h=this.w=1;this.pds_path.length=0;c.x=0;c.y=0;c.flags.BackDir=x.NOWHERE;d==x.NOWHERE?(this.flags.bForced=0,c.flags.bForced=0,c.flags.ForeDir=x.NOWHERE):(this.flags.bForced=1,c.flags.bForced=1,c.flags.ForeDir=d);this.pds_path.push(c)};y.prototype.LayPath=function(a,b){var d=0;var c=this.pds_path[this.pds_path.length-1];a-=this.x;b-=this.y;if(c){if(c.x==a&&c.y==b)return;if(100<Math.abs(c.x-a)||100<Math.abs(c.y-b))DebugBreak(),
console.log("Laying a LONG path - is this okay?!")}for(c=this.pds_path[this.pds_path.length-1];c;){var e=this.FindDirection(c.x,c.y,a,b);if(e==x.NOWHERE)break;if(c.flags.BackDir==x.NOWHERE){if(c.flags.ForeDir!=e&&this.flags.bForced){console.log("Have a forced begin point, and no way to get there from here....");DebugBreak();10==oa(c.flags.ForeDir,e)?(console.log("MUST go %d , have to go %d from here.  Go nowhere.",c.flags.ForeDir,e),console.log("Okay - consider a arbitrary jump to go forward... until we can go backward.")):
console.log("It's just not quite right... return, a less radical assumption may be made.");break}c.flags.ForeDir=e}else if(10!=oa(e,c.flags.BackDir+4&7))c.flags.ForeDir=e;else{console.log("Unlay path cause we can't get there from here.");c=this.UnlayPath(d+1);d=1;continue}var f;var g=c.x+H[c.flags.ForeDir].x;e=c.y+H[c.flags.ForeDir].y;(f=this.Overlaps(g,e))?(console.log("Unlaying path %d steps to overlap",f),c=this.UnlayPath(f)):(f=new ka,f.flags.bForced=!1,f.flags.ForeDir=x.NOWHERE,f.flags.BackDir=
c.flags.ForeDir+4&7,f.x=g,f.y=e,c=g+this.x,e+=this.y,c<this.min_x&&(this.w+=this.min_x-c,this.min_x=c),c>=this.min_x+this.w&&(this.w=c-this.min_x+1),e<this.min_y&&(this.h+=this.min_y-e,this.min_y=e),e>=this.min_y+this.h&&(this.h=e-this.min_y+1),this.pds_path.push(f),d++,c=this.pds_path[this.pds_path.length-1])}};y.prototype.isolate=function(){if(!this.flags.bRoot){var a=this.board.rootLayer;this.next?this.next.prior=this.prior:a.prior=this.prior;this.prior?this.prior.next=this.next:a.next=this.next}};
y.prototype.GetLastBackDirection=function(){var a;return(a=this.pds_path[this.pds_path.length-1])?a.flags.BackDir:x.NOWHERE};y.prototype.GetLastForeDirection=function(){var a;return(a=this.pds_path[this.pds_path.length-1])?a.flags.ForeDir:x.NOWHERE};y.prototype.Overlaps=function(a,b){var d,c;for(c=1;d=this.pds_path[this.pds_path.length-c];c++){if(d.x==a&&d.y==b)return c;var e=this.peice;if(e.GetViaFill1(void 0,void 0,d.flags.ForeDir)&&d.x+void 0==a&&d.y+void 0==b)return console.log("hit via fill1 of node %d,%d",
void 0,void 0),c;if(e.GetViaFill2(void 0,void 0,d.flags.ForeDir)&&d.x+void 0==a&&d.y+void 0==b)return console.log("hit via fill2 of node %d,%d",void 0,void 0),c;if(e.GetViaFill1(void 0,void 0,d.flags.BackDir)&&d.x+void 0==a&&d.y+void 0==b)return console.log("hit via fill1 of node back %d,%d",void 0,void 0),c;if(e.GetViaFill2(void 0,void 0,d.flags.BackDir)&&d.x+void 0==a&&d.y+void 0==b)return console.log("hit via fill2 of node back %d,%d",void 0,void 0),c}return 0};y.prototype.UnlayPath=function(a){var b,
d;for(b=a;b&&(d=this.pds_path.pop()),b;b--){var c=this.pds_path[this.pds_path.length-1];if(c&&c.flags.bForced)return DebugBreak(),d.flags.ForeDir=x.NOWHERE,d;d&&d.flags.bForced&&DebugBreak()}if(d){c=this.pds_path[this.pds_path.length-1];if(!c)return d.flags.bForced||(d.flags.ForeDir=x.NOWHERE),this.pds_path.push(d),d;if(!a&&c.flags.bForced&&c.flags.BackDir!=x.NOWHERE){debugger;if(c.flags.bTry&&(d=this.pds_path.pop(),!d.flags.bFlopped))return d.flags.bFlopped=1,a=d.flags.BackDir+4&7,d.flags.ForeDir=
a&1?a-1&7:a+1&7,d;c.flags.bForced=0}else c.flags.ForeDir=x.NOWHERE,console.log("this node itself is okay...");return c}return null};y.prototype.FindDirection=function(a,b,d,c){return a<d?b>c?x.UP_RIGHT:b<c?x.DOWN_RIGHT:x.RIGHT:a>d?b>c?x.UP_LEFT:b<c?x.DOWN_LEFT:x.LEFT:b>c?x.UP:b==c?x.NOWHERE:x.DOWN};y.prototype.move=function(a,b){this.x+=a;this.y+=b;this.min_x+=a;this.min_y+=b;this.linked.forEach((d)=>{if(d.flags.bRoute){if(d.route_end_layer.layer==this&&d.route_start_layer.layer!=this){var c=d.pds_path[d.pds_path.length-
1];d.LayPath(d.x+(c?c.x:0)+a,d.y+(c?c.y:0)+b)}if(d.route_start_layer.layer==this)if(c=d.pds_path[d.pds_path.length-1],d.route_end_layer.layer){var e=c.x+d.x;c=c.y+d.y;d.BeginPath(d.x+a,d.y+b);d.LayPath(e,c)}else console.log("This via should have been deleted?!")}})};u.prototype.select=function(a){this.selected=a;this.BoardRefresh()};u.prototype.GetCellSize=function(){return this.cellSize};u.prototype.SetScale=function(a){0>a||2<a||(this.cellSize.width=this._cell_width>>a,this.cellSize.height=this._cell_height>>
a,this.scale=a)};u.prototype.SetCellSize=function(a,b){this.cellSize.width=this._cell_width=a;this.cellSize.height=this._cell_height=b};u.prototype.DrawLayer=function(a){this.selected==a.psvInstance&&(this.ctx.fillStyle="#20c01040");a.Draw(this,this.ctx,8+(this.board_origin_x+a.x)*this.cellSize.width,8+(this.board_origin_y+a.y)*this.cellSize.height)};u.prototype.reset=function(){this.board_origin_y=this.board_origin_x=0;this.layerPool=la()};u.prototype.GetScale=function(){return this.scale};u.prototype.SetBackground=
function(a){this.default_peice=a;this.default_peice_instance=this.default_peice.methods.Create(a.psvCreate);this.rootLayer=new y(this,this.default_peice);a.image.addEventListener("load",()=>{this.BoardRefresh()})};u.prototype.BeginPath=function(a,b,d,c){if(this.mouse_current_layer){b=new y(this,a);b.flags.bRoute=!0;if(!this.mouse_current_layer.peice.methods.ConnectBegin(this.mouse_current_layer.psvInstance,this.wX-this.mouse_current_layer.x,this.wY-this.mouse_current_layer.y,a,b.psvInstance))return!1;
this.mouse_current_layer.Link(b,0,this.wX-this.mouse_current_layer.x,this.wY-this.mouse_current_layer.y);this.route_current_layer=b;b.BeginPath(this.wX,this.wY);b.link_top(this.rootLayer)}return!0};u.prototype.GetLayerAt=function(a,b,d){for(var c=this.rootLayer;c;){var e;if(c!==d&&(e=c.IsLayerAt(a,b)))return{layer:c,at:e};c=c.next}return null};u.prototype.GetLayerDataAt=function(a,b,d){return(a=this.GetLayerAt(a,b,d))?a:null};u.prototype.EndPath=function(a,b){if(a=this.GetLayerAt(a,b,this.route_current_layer)){if(this.flags.bLeftChanged){if(a.layer.peice.methods.ConnectEnd(a.layer.psvInstance,
this.wX-a.layer.x,this.wY-a.layer.y,this.route_current_layer.peice,this.route_current_layer.psvInstance))return console.log("Heh guess we should do something when connect succeeds?"),a.layer.Link(this.route_current_layer,1,this.wX-a.at.x,this.wY-a.at.y),this.route_current_layer=null,!0;this.route_current_layer.Unlink();this.route_current_layer.isolate();this.route_current_layer.peice.methods.Disconnect(this.route_current_layer.psvInstance);this.route_current_layer=null;this.BoardRefresh();return!1}}else if(this.route_current_layer&&
this.flags.bLeftChanged&&!this.flags.bLeft)return this.route_current_layer.Unlink(),this.route_current_layer.isolate(),this.route_current_layer.peice.methods.Disconnect(this.route_current_layer.psvInstance),this.route_current_layer=null,console.log("route current layer goes to null..."),this.route_current_layer=null,this.BoardRefresh(),!1;return this.LayPathTo(this.wX,this.wY)};u.prototype.UnendPath=function(){this.mouse_current_layer.peice.methods.Disconnect(this.mouse_current_layer.psvInstance)&&
(this.mouse_current_layer.Unlink(),this.mouse_current_layer.isolate(),this.mouse_current_layer.link_top(),this.route_current_layer=this.mouse_current_layer)};u.prototype.PutPeice=function(a,b,d,c){if(a){var e=a.getsize(),f=a.gethotspot();console.log("hotspot offset of created cell is %d,%d so layer covers from %d,%d to %d,%d,",f.x,f.y,b-f.x,d-f.y,b-f.x+e.cols,d-f.y+e.rows);a.psvCreate=c;a=new y(this,a,b,d,e.cols,e.rows,f.x,f.y);a.link_top(this.rootLayer);this.BoardRefresh();return a.psvInstance}console.log("PEICE IS null!")};
var Pa=0;u.prototype.BoardRefresh=function(){var a,b;const d=this.ctx,c=this.canvas;d.clearRect(0,0,c.width,c.height);this.board_width=(c.width-16+(this.cellSize.width-1))/this.cellSize.width;this.board_height=(c.height-16+(this.cellSize.height-1))/this.cellSize.height;try{if(this.default_peice){var e=this.default_peice.getsize();var f=0<=this.board_origin_x?this.board_origin_x%e.cols:-(-this.board_origin_x%e.cols);0<=f&&(f-=e.cols);var g=0<=this.board_origin_y?this.board_origin_y%e.rows:-(-this.board_origin_y%
e.rows);0<=g&&(g-=e.rows);for(a=f;a<this.board_width;a+=e.cols)for(b=g;b<this.board_height;b+=e.rows)this.default_peice.methods.Draw(this.default_peice,this.default_peice_instance,d,a*this.cellSize.width+8,b*this.cellSize.height+8)}if(this.rootLayer)for(var h=this.rootLayer;h&&(h=h.prior);)this.DrawLayer(h)}catch(m){10>Pa++&&console.log("(try again later) FAILED:",m)}};u.prototype.LayPathTo=function(a,b){this.route_current_layer.LayPath(a,b);this.BoardRefresh();return!0};u.prototype.SCRN_TO_GRID_X=
function(a){return(a-8)/this.cellSize.width-this.board_origin_x};u.prototype.SCRN_TO_GRID_Y=function(a){return(a-8)/this.cellSize.height-this.board_origin_y};u.prototype.DoMouse=function(a,b,d){this.wX=Math.floor(this.SCRN_TO_GRID_X(a));this.wY=Math.floor(this.SCRN_TO_GRID_Y(b));this.flags.bLeftChanged=this.flags.bLeft^0!=(d&1);this.flags.bRightChanged=this.flags.bRight^0!=(d&2);this.flags.bLeft=0!=(d&1);this.flags.bRight=0!=(d&2);if(this.flags.bRightChanged&&!this.flags.bRight&&!this.route_current_layer)if(b=
this.GetLayerDataAt(this.wX,this.wY)){if(console.log("Okay it's on a layer, and it's at %d,%d on the layer",this.wX,this.wY),!b.layer.peice.methods.OnRightClick(b.layer.psvInstance,this.wX,this.wY))return}else if(this.default_peice&&!this.default_peice.methods.OnRightClick(null,this.wX,this.wY))return;if(this.flags.bSliding)if(this.flags.bLockLeft&&this.flags.bLeft||this.flags.bLockRight&&this.flags.bRight){if(this.wX!=this.xStart||this.wY!=this.yStart)this.board_origin_x+=this.wX-this.xStart,this.board_origin_y+=
this.wY-this.yStart,this.wX=this.xStart,this.wY=this.yStart,this.BoardRefresh()}else this.flags.bSliding=!1,this.flags.bLockLeft=!1,this.flags.bLockRight=!1;else this.move_current_layer?this.flags.bLeft?(this.move_current_layer.move(this.wX-this.xStart,this.wY-this.yStart),this.xStart=this.wX,this.yStart=this.wY,this.BoardRefresh(),this.move_current_layer.peice.methods.OnMove(this.move_current_layer.psvInstance)):this.move_current_layer=null:this.flags.bLeft?(a=this.GetLayerAt(this.wX,this.wY,this.route_current_layer),
this.route_current_layer?(this.flags.bLeftChanged&&(a||this.default_peice.methods.OnClick(null,this.wX,this.wY)),this.LayPathTo(this.wX,this.wY)):a?(b=a,this.mouse_current_layer=a.layer,b.layer.peice.methods.OnClick(b.layer.psvInstance,a.at.x,a.at.y),this.mouse_current_layer=null):this.default_peice&&this.default_peice.methods.OnClick(null,this.wX,this.wY)):this.route_current_layer&&this.EndPath(this.wX,this.wY)};u.prototype.LockDrag=function(){if(this.flags.bLeft||this.flags.bRight)this.xStart=this.wX,
this.yStart=this.wY,this.flags.bSliding=!0,this.flags.bLeft?(this.flags.bLockRight=!1,this.flags.bLockLeft=!0):(this.flags.bLockRight=!0,this.flags.bLockLeft=!1)};u.prototype.LockPeiceDrag=function(){if(this.flags.bLeft||this.flags.bRight)this.xStart=this.wX,this.yStart=this.wY,this.flags.bDragging=!0,this.move_current_layer=this.mouse_current_layer,this.flags.bLeft?(this.flags.bLockRight=!1,this.flags.bLockLeft=!0):(this.flags.bLockRight=!0,this.flags.bLockLeft=!1)};u.prototype.destroy=function(){canvas.remote()};
u.prototype.GetSize=function(){return{cols:this.board_width,rows:this.board_height}};u.prototype.CreatePeice=function(a,b,d,c,e,f,g,h){a=L(this,a,b,d,c,e,f,!0,!1,g,h);this.peices.push(a);return a};u.prototype.CreateVia=function(a,b,d,c,e){a=new I(this,a,b,d,c,e);this.peices.push(a);return a};u.prototype.forEachPeice=function(a){this.peices.forEach(a)};u.prototype.GetPeice=function(a){return this.peices.find((b)=>b.name===a)};V.prototype.select=function(a){this.board.select(a)};V.prototype.addEventListener=
function(a,b){this.events[a]=b};V.prototype.BuildBrainstemMenus=function(a,b,d,c,e){this.comp_menu=fa();var f;a.appendItem(3,comp_menu,b.name());this.menus.push(comp_menu);comp_menu.appendItem(3,f=CreatePopup(),"inputs");this.menus.push(f);b.Inputs.list.forEach((a)=>{c.push(a);f.appendItem(1,5E3+(c.lenght-1),a.name())});comp_menu.appendItem(3,f=CreatePopup(),"outputs");this.menus.push(f);b.Outputs.list.forEach((a)=>{c.push(a);f.appendItem(1,6E3+(c.length-1),a.name())});comp_menu.appendItem(3,f=CreatePopup(),
"module");this.menus.push(f);for(a=b.first_module();a;e++,a=b.next_module())BuildBrainstemMenus(f,a,d,c,e)};V.prototype.RebuildComponentPopups=function(){this.hMenuComponents.reset();this.brain.brainStems.forEach((a)=>{BuildBrainstemMenus(this.hMenuComponents,a,this.menus,this.connectors,0)})};M.prototype=Object.create(J.prototype);M.prototype.constructor=M;M.prototype.Create=function(a){return this.brainboard.brain.dupSynapse(this.brainboard.DefaultSynapse)};M.prototype.Destroy=function(a){this.brainboard.brain.ReleaseSynapse(a)};
M.prototype.Disconnect=function(a){this.brainboard.brain.UnLinkSynapseTo(a);return!0};M.prototype.OnRightClick=function(a,b,d){console.log("Show Synapse in Statuses");return 1};M.prototype.DrawCell=function(a,b,d,c,e,f){0<=b.gain?d.drawImage(this.master.image.on,c.coords.x,c.coords.y,c.size.width,c.size.height,e,f,this.brainboard.board.cellSize.width,this.brainboard.board.cellSize.height):d.drawImage(this.master.image.off,c.coords.x,c.coords.y,c.size.width,c.size.height,e,f,this.brainboard.board.cellSize.width,
this.brainboard.board.cellSize.height)};F.prototype=Object.create(t.prototype);F.prototype.constructor=F;F.prototype.Create=function(a){console.log("Creating a new input (peice instance)");return a};F.prototype.SetColors=function(a,b,d){this.level_colors[0]=a;this.level_colors[1]=b;this.level_colors[2]=d};F.prototype.Draw=function(a,b,d,c,e){a=a.conn.get();console.log("input value is %g",a);a=0>a?ColorAverage(level_colors[1],level_colors[0],-(1200*a)|0,1E3):ColorAverage(level_colors[1],level_colors[2],
1200*a|0,1E3);BlotImageShaded(b,d,c,e,a)};F.prototype.ConnectEnd=function(a,b,d,c,e){return!1};F.prototype.ConnectBegin=function(a,b,d,c,e){for(c=0;8>c&&(H[c].x!=b||H[c].y!=d);c++);return 8>c?this.brainboard.brain.LinkSynapseFrom(e,a.neuron,c):!1};F.prototype.OnRightClick=function(a,b,d){return 1};F.prototype.OnClick=function(a,b,d){console.log("click on input! at %d,%d",b,d);if(0==b&&0==d)return this.brainboard.board.LockPeiceDrag(),!0;brainboard.board.BeginPath(brainboard.NervePeice,brainboard);
return!1};G.prototype=Object.create(t.prototype);G.prototype.constructor=G;G.prototype.Create=function(a){console.log("Creating a new output (peice instance)");a.neuron=this.brainboard.brain.GetOutputNeuron(a.conn);return a};G.prototype.Draw=function(a,b,d,c,e){a=a.get();a=0>a?ColorAverage(this.level_colors[1],this.level_colors[0],int-1200*a,1E3):ColorAverage(this.level_colors[1],this.level_colors[2],int(1200*a),1E3);BlotImageShaded(b,d,c,e,a)};G.prototype.SetColors=function(a,b,d){this.level_colors[0]=
a;this.level_colors[1]=b;this.level_colors[2]=d};G.prototype.ConnectEnd=function(a,b,d,c,e){for(c=0;8>c&&(H[c].x!=b||H[c].y!=d);c++);return 8>c?a=this.brainboard.brain.LinkSynapseTo(e,a.neuron,c):!1};G.prototype.ConnectBegin=function(a,b,d,c,e){return!1};G.prototype.OnRightClick=function(a,b,d){return 1};G.prototype.OnClick=function(a,b,d){console.log("click on neuron! at %d,%d",b,d);if(0==b&&0==d)return this.brainboard.board.LockPeiceDrag(),!0;this.brainboard.board.BeginPath(this.brainboard.NervePeice,
brainboard);return!1};w.prototype=Object.create(t.prototype);w.prototype.constructor=w;w.prototype.SetColors=function(a,b,d,c){a?(this.c_input[0]=b,this.c_input[1]=d,this.c_input[2]=c):(this.c_threshold[0]=b,this.c_threshold[1]=d,this.c_threshold[2]=c)};w.prototype.Create=function(a){console.log("Creating a new neuron (peice instance)");return this.brainboard.brain.dupNeuron(this.brainboard.DefaultNeuron)};w.prototype.Destroy=function(a){this.brainboard.brain.ReleaseNeuron(a)};w.prototype.DrawCell=
function(a,b,d,c,e,f){b.value?d.drawImage(this.master.image.on,c.coords.x,c.coords.y,c.size.width,c.size.height,e,f,this.brainboard.board.cellSize.width,this.brainboard.board.cellSize.height):d.drawImage(this.master.image.off,c.coords.x,c.coords.y,c.size.width,c.size.height,e,f,this.brainboard.board.cellSize.width,this.brainboard.board.cellSize.height)};w.prototype.Update=function(a,b){console.log("updating color information for a neuron...")};w.prototype.ConnectEnd=function(a,b,d,c,e){for(c=0;8>
c&&(H[c].x!=b||H[c].y!=d);c++);return 8>c?this.brainboard.brain.LinkSynapseTo(e,a,c):!1};w.prototype.ConnectBegin=function(a,b,d,c,e){this.brainboard.events.added&&this.brainboard.events.added(this.brainboard.NervePeice,e);for(c=0;8>c&&(H[c].x!=b||H[c].y!=d);c++);return 8>c?this.brainboard.brain.LinkSynapseFrom(e,a,c):!1};w.prototype.OnRightClick=function(a,b,d){console.log("Show in info panel?");return 1};w.prototype.OnClick=function(a,b,d){this.brainboard.events.select&&this.brainboard.events.select(a);
console.log("click on neuron! at %d,%d",b,d);if(0==b&&0==d)return this.brainboard.board.LockPeiceDrag(),!0;this.brainboard.board.BeginPath(this.brainboard.NervePeice,this.brainboard);return!1};Z.prototype=Object.create(w.prototype);Z.prototype.constructor=T;Z.prototype.Create=function(a){console.log("Creating a new output (peice instance)");return new this.brainboard.brain.Exporter(this.brainboard.brain,a)};T.prototype=Object.create(w.prototype);T.prototype.constructor=T;T.prototype.Create=function(a){console.log("Creating a new input (peice instance)");
return new this.brainboard.brain.External(this.brainboard.brain,a)};W.prototype=Object.create(w.prototype);W.prototype.constructor=W;W.prototype.Create=function(a){console.log("Creating a new input (peice instance)");return new this.brainboard.brain.External(this.brainboard.brain,a)};E.prototype=Object.create(t.prototype);E.prototype.constructor=E;E.prototype.Create=function(){return!0};E.prototype.Destroy=function(){};E.prototype.Connect=function(a,b,d,c,e,f){return 0};E.prototype.Update=function(a,
b){console.log("Update background - nothing to do.")};E.prototype.OnClick=function(a,b,d){this.brainboard.board.LockDrag();return!0};E.prototype.OnRightClick=function(a,b,d){this.brainboard.RebuildComponentPopups(this);this.brainboard.hMenu.show(this.brainboard.board,this.brainboard.board.mousePos.x,this.brainboard.board.mousePos.y,(a)=>{if(void 0!==a){var c=this.brainboard;if(5E3<=a&&6E3>a){console.log("Put input peice at %d,%d",b,d);var f=new OUPUT_INPUT(c);f.conn=c.connectors[a-5E3];f.neuron=f.brain.GetInputNeuron(f.conn);
c.board.PutPeice(c.InputPeice,b,d,f)}else if(6E3<=a&&6999>=a)console.log("Put output peice at %d,%d",b,d),f=new OUPUT_INPUT(c),f.conn=c.connectors[a-6E3],c.board.PutPeice(c.OutputPeice,b,d,f);else switch(a){case 1001:return console.log("Put neuron peice at %d,%d",b,d),a=c.board.PutPeice(c.NeuronPeice,b,d,0),c.events.added&&c.events.added(c.NeuronPeice,a),!0;case 1011:return console.log("Put osc peice at %d,%d",b,d),a=c.board.PutPeice(c.OscillatorPeice,b,d,0),c.events.added&&c.events.added(c.OscillatorPeice,
a),!0;case 1010:return console.log("Put tickosc peice at %d,%d",b,d),a=c.board.PutPeice(c.TickOscillatorPeice,b,d,0),c.events.added&&c.events.added(c.TickOscillatorPeice,a),!0;case 1020:case 1021:case 1022:c.scale=a-1020;c.board.SetScale(a-1020);break;case 1004:(a=PickBoardName(null,!1))&&c.board.Save(null,a);break;case 1005:(a=PickBoardName(null,!0))&&c.board.Load(null,a);break;case 1040:return!1}}});return!0};E.prototype.OnDoubleClick=function(a,b,d){result=TrackPopup(brainboard.hMenu,null);return!0};
ia.prototype=Object.create(w.prototype);ia.prototype.constructor=w;ia.prototype.Create=function(a){console.log("Creating a new neuron (peice instance)");return this.brainboard.brain.Oscillator()};ha.prototype=Object.create(w.prototype);ha.prototype.constructor=w;ha.prototype.Create=function(a){console.log("Creating a new tick Oscillator (peice instance)");return new this.brainboard.brain.TickOscillator(this.brainboard.brain,1E3)};var ca=document.getElementById("mouseCatcher");ca.addEventListener("click",
(a)=>{ca.style.visibility="hidden"});const P=[{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">1</SPAN>\n\t\t<BR>\n        \t<CENTER>Observations<BR>\n                on<BR>Certain Properties<BR>\n                of<BR>\n                Components<BR>\n                of<BR>\n                Synthetic Brains<BR>\n                <BR><BR><BR>\n                [Click on right side of this<BR>\n\t\tjounral page to go to next page]<BR>\n          ',activate:()=>{Ea()}},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">1</SPAN>\n\t\t<BR>\n        \tI have returned to the lab to continue<BR>\n                my experiments on the brain components<BR>\n                <BR>\n                They are constructing a bug in the<BR>\n                workshop.  Once it is completed I will be<BR>\n                able to use my knowledge of synthetic<br>\n                brains to control it.<BR>\n                <BR>\n                I plan to do a series of experiments.<BR>\n                Each will involve creating a brain to<BR>\n                perform a specific function.  The brains<BR>\n                will be built on the brain board<BR>\n                <BR>\n                [Click on left side of this journal page<BR>\n                to return to previous page]<BR>\n        '},
{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">1</SPAN>\n\t\t<BR>\n        \tTool Panel<BR>\n                <BR>\n                The blue region at the top contains<BR>\n                some of the items you will use to complete<BR>\n                the goals.<BR>\n                <BR>\n                Clicking on them will automatically place<BR>\n                a copy on the board.  Click the large green<BR>\n                circle which is a Neuron.<BR>\n                <BR>\n                Don\'t worry about making a mess, the<BR>\n                board will be cleared and setup with the<BR>\n                 inputs and outputs to and from the brain<BR>\n                 respectively.<BR>\n                <BR>\n                <BR>\n                <DIV ID="jim1" > </DIV><BR>\n                <BR>\n                <BR>\n         ',
inserts:{jim1:aa()}},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">1</SPAN>\n\t\t<BR>\n        \tThe recycle can...<BR>\n                <DIV ID="jim1"> </DIV><BR>\n                <BR>\n                can be used to clear the board.<BR>\n                <BR>\n                If you accientally clear the test<BR>\n\t\tinputs and outputs, you can restore them<BR>\n\t\tby going to the previous journal page,<BR>\n\t\tand foward again, which will setup<BR>\n                for the current test.<BR>\n                <BR>\n                Red nodes are Inputs, and blue<BR>\n                nodes are outputs.<BR>\n                <BR>\n\t\tThe red node with Yellow arrow<br>\n                downward is the first button pushing<BR>\n                rotary wheel<BR>\n                <BR>\n\t\tThe red node with Yellow arrow<br>\n                to the right is the slider input<BR>\n                that ranges from 0-1 smoothly.<BR>\n                <BR>\n                <BR>\n         ',
inserts:{jim1:pa()}},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">1</SPAN>\n\t\t<BR>\n        \tThis is an example of clicking\n\t\tOn the edge of a peice, and dragging\n\t\taway one space.  The connection does\n\t\tnot show until the destination is different\n\t\tthan the source<BR>\n\t\t<BR>\n\t\t\n                <DIV ID="jim1"> </DIV><BR>\n                <BR>\n                Have fun, be creative...<BR>\n                <BR>\n                <DIV ID="jim2"> </DIV><BR>\n                <BR>\n         ',
inserts:{jim1:ua("images/first-drag.jpg"),jim2:ua("images/PathPicture.jpg")}},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">1</SPAN>\n\t\t<BR>\n        \tMonitoring Equpment<BR>\n                <BR>\n                The brain will be used to control lights in<BR>\n                response to inputs from switches.<BR>\n                <BR>\n                THe input from the switches and the<BR>\n                output to the lights will be monitored by<BR>\n                a Logic Analyzer.  It shows the level of the<BR>\n                output in blue.<BR>\n                <BR>\n                It can be preprogrammed with the<BR>\n                expected output (shown in gold during<BR>\n                a test) and will signal if the actal output<BR>\n                is wrong.<BR>\n         '},
{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">1</SPAN>\n\t\t<BR>\n        \t<BR>\n                <BR>\n                To test a brain, press the "Test" Button<BR>\n                then flip the switch to "Run".  If the<BR>\n                brain has done what it should while the<BR>\n                timer ticks to zero, the experiment is a<BR>\n                success.<BR>\n                <BR>\n                Testing can begin at any time, and may be<BR>\n\t\tstopped and reset at any time by clicking<BR>\n                the test button again.<BR>\n                <BR>\n         '},
{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">1</SPAN>\n\t\t<BR>\n        \tSignals and Lines<BR>\n                I have discovered that bug brains<BR>\n                operate on signals which range from<BR>\n                0(off) to 1(on).<BR>\n                <BR>\n                The signals enter the brain through the<BR>\n                input nodes, travel along lines and exit<BR>\n                through output nodes.<BR>\n                <BR>\n                Input Node - Line - Output Node<BR>\n                <DIV ID="jim1"> </DIV><BR>\n                A line is made by grabbing the edge of a<BR>\n                node and dragging it out.  Drop the line<BR>\n                on the edge of the target node.<BR>\n                \n         ',
activate:()=>{Fa()},inserts:{jim1:D()}},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n\t\t<BR>\n        \tExperiment 1: The Start<BR>\n                I have connected the input node to an<BR>\n                automatic switch.  The output node<BR>\n                goes to the light.  To confirm my theory<BR>\n                on the previous page, I will attempt to<BR>\n                make a brain where the light will com<BR>\n                on when the switch is on.<BR>\n                <BR>\n                <SPAN ID="jim1"></SPAN><SPAN style="line-height:400%;vertical-align:top">Input from switch</SPAN><BR>\n                <SPAN ID="jim2"></SPAN><SPAN style="line-height:400%;vertical-align:top">Output to light</SPAN><BR>\n                <BR>\n                [Build a brain on the Brain Board]<BR>\n                [To test, press Test and wait for timer<BR>\n                to expire]<BR>\n                [Go to the next page when successful]<BR>\n         ',
activate:()=>{A.clear();g.reset();C(0,2,10);r.length=0;z(0,15,10)},inserts:{jim1:O(),jim2:D()},locked:!0},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n\t\t<BR>\n\t\tA Success!!!!!<BR>\n\t\t<BR>\n\t\tThey have started work on the bug in the<BR>\n\t\tworkshop.  I had beter hurry up and<BR>\n\t\tcomplete these experiments.<BR>\n\t\t<BR>\n\t\tThere seems to be a space for connecting<BR>\n\t\tup to 8 lines to the input node.  In<BR>\n\t\ttheory then I should be able to drive<BR>\n\t\tmore than one light from the same input.<BR>\n\t\tI\'ll have to test this.<BR>\n\t\t<BR>\n\t\t<BR>\n\t\t<BR>\n\t\t<BR>\n         '},
{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n\t\t<BR>\n\t\tExperiment 2: Two Lights<BR>\n\t\tI have connected the input node to an<BR>\n\t\tautomatic switch.  There are two output<BR>\n\t\tnodes - each goes to a light.  I will<BR>\n\t\tattempt to make a brain where both<BR>\n\t\tlights come on when the switch is on.<BR>\n\t\t<BR>\n\t\t<BR>\n                <SPAN ID="jim1"></SPAN><SPAN style="line-height:400%;vertical-align:top">Input from switch</SPAN><BR>\n                <SPAN ID="jim2"></SPAN><SPAN style="line-height:400%;vertical-align:top">Output to lights 1 and 2</SPAN><BR>\n         ',
activate:()=>{Ga()},inserts:{jim1:O(),jim2:D()},locked:!0},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n\t\t<BR>\n\t\tTwo in a row!!<BR>\n\t\t<BR>\n\t\tMuch excitement.  Having a party<BR>\n\t\tto celebrate.  Maybe I could set<BR>\n\t\tup some lights???<BR>\n\t\t<BR>\n\t\tMight as well do it as an<BR>\n\t\texperiment...<BR>\n\t\t<BR>\n\t\t<BR>\n\t\t<BR>\n\t\t<BR>\n\t\t<BR>\n         '},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n\t\t<BR>\n\t\tExperiment 3: Disco<BR>\n\t\tI have set up a second faster automatic<BR>\n\t\tswitch and there are now four lights.<BR>\n\t\tI want lights 1 and 3 to swtich slowly<BR>\n\t\tand lights 2 and 4 to switch quickly.<BR>\n\t\t<BR>\n                <SPAN ID="jim1"></SPAN><SPAN style="line-height:400%;vertical-align:top">Input from 1 and 2</SPAN><BR>\n                <SPAN ID="jim2"></SPAN><SPAN style="line-height:400%;vertical-align:top">Output to lights 1,2,3 and 4.</SPAN><BR>\n\t\t[Lines can be removed by grabbing<BR>\n\t\tthem in one of the 8 grid squares<BR>\n\t\tthat surround the node then dragging<BR>\n\t\tthem away and dropping them]<BR>\n         ',
activate:()=>{Ha()},inserts:{jim1:O(),jim2:D()},locked:!0},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n\t\t<BR>\n                Neurons<BR>\n                The large green spheres are neurons.<BR>\n                Neurons are the thinking part of a brain.<BR>\n                these seem to be simplified versions of<BR>\n                real neurons.  Neurons in general have a<BR>\n                threshold.  If the input to the neuron is <BR>\n                below the threshold the neuron is off<BR>\n                (output 0).  If the input to the neuron<BR>\n                 is at or above the threshold the neuron is<BR>\n                 on (output 1).<BR>\n                 <BR>\n                 If this is true for these neurons the I<BR>\n                 could make a brain which switches on a<BR>\n                 light when the input is above some value.<BR>\n                <BR>\n                \n         '},
{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n                <BR>\n                Experiment 4: Neuron Threshold<BR>\n                The input now comes from a slider.<BR>\n                The slider produces a variable signal in<BR>\n                the range from 0 to 1.  I want the light to<BR>\n                switch on when the signal is 80 or above.<BR>\n                <BR>\n                <SPAN ID="jim1"></SPAN><SPAN style="line-height:400%;vertical-align:top"> Input from slider : 0 to 1</SPAN><BR>\n                <SPAN ID="jim2"></SPAN><SPAN style="line-height:400%;vertical-align:top">Output to light</SPAN><BR>\n                <BR>\n                [Click waste bin to clear the brain]<BR>\n                [Click large egreen button to add neuron]<BR>\n                [Neuron shows in table with slider to set\n                threshold]<BR>\n         ',
activate:()=>{Ia()},inserts:{jim1:ba(),jim2:D()},locked:!0},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n                <BR>\n                I have noticed that music equipment<BR>\n                uses a seris of lights to indicate sound<BR>\n                volume.  When the volume gets larger<BR>\n                thre are more lights lit.<BR>\n                <BR>\n                It should be possible to duplicate this<BR>\n                using several neurons.<BR>\n                <BR>\n                [On the Logic Analyzer, the blue line<BR>\n                shows the output and the gold line shows<BR>\n                the expected output.  The blue line should<BR>\n                overlay the gold line.  If you can see a gold<BR>\n                line the otuput is wrong and the test <BR>\n                will fail]\n         '},
{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n                <BR>\n                Experiment 5: Light Scale<BR>\n                The input comes from the slider.<BR>\n                There are four lights that should be lit<BR>\n                at equally spaced intervals to show the<BR>\n                value of the input.  The more light son,<BR>\n                the higher the input.<BR>\n                <BR>\n                <SPAN ID="jim1"></SPAN><SPAN style="line-height:400%;vertical-align:top"> Input from slider : 0 to 1</SPAN><BR>\n                <SPAN ID="jim2"></SPAN><SPAN style="line-height:400%;vertical-align:top">Output to lights 1,2,3 and 4</SPAN><BR>\n                <BR>\n                <BR>\n                <BR>\n                <BR>\n         ',
activate:()=>{Ja()},inserts:{jim1:ba(),jim2:D()},locked:!0},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n                <BR>\n                Synapses<BR>\n                The input to a neuron comes through a<BR>\n                synapse (shown as a blue or red blob<BR>\n                on the neuron).  Each synapse has a<BR>\n                weight between -1 and 1.  This is<BR>\n                the percent of the signal the synapse<BR>\n                passes through to the neuron.<BR>\n                <BR>\n                If there is mroe than one input to a<BR>\n                neuron, then the input signal is the sum<BR>\n                of each input signal times the weight of<BR>\n                its synapse.  If this sum exceeds the<BR>\n                threshold the neuron switches on.<BR>\n                <BR>\n                [Right click on a synapse to set the weight]<BR>\n         '},
{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n                <BR>\n                Computing with Neurons<BR>\n                By setting the synapse weights and the<BR>\n                neuron threshold it should be possible<BR>\n                to perform logic operation with<BR>\n                neurons.<BR>\n                <BR>\n                These logic operations are the building<BR>\n                blocks for digital computers. In<BR>\n                computers, signals are either 0 or 1.<BR>\n                The equivalent signals in Bug Brain are<BR>\n                0 (light off) and 1(light on).<BR>\n                <BR>\n                <BR>\n                <BR>\n                <BR>\n         '},
{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n                <BR>\n                Experiment 6: Or<BR>\n                The light should go on if switch 1 OR<BR>\n                switch 2 is on (or both are on).<BR>\n                <BR>\n                <BR>\n                <SPAN ID="jim1"></SPAN><SPAN style="line-height:400%;vertical-align:top">Input from switches 1 and 2</SPAN><BR>\n                <SPAN ID="jim2"></SPAN><SPAN style="line-height:400%;vertical-align:top">Output to light</SPAN><BR>\n                <BR>\n         ',
activate:()=>{Ka()},inserts:{jim1:ba(),jim2:D()},locked:!0},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n                <BR>\n                Experiment 7: And<BR>\n                The light should go on if switch 1 AND<BR>\n                switch 2 are on.<BR>\n                <BR>\n                <BR>\n                <SPAN ID="jim1"></SPAN><SPAN style="line-height:400%;vertical-align:top">Input from switches 1 and 2</SPAN><BR>\n                <SPAN ID="jim2"></SPAN><SPAN style="line-height:400%;vertical-align:top">Output to light</SPAN><BR>\n                <BR>\n         ',
inserts:{jim1:O(),jim2:D()},activate:()=>{La()},locked:!0},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n                <BR>\n                Experiment 8: Inhibition <BR>\n                Synapses can have negative weights.<BR>\n                A negative input is subtracted from<BR>\n                the input sum, so these synapses<BR>\n                inhibit the neuron.<BR>\n                <BR>\n                In this experiment the light should<BR>\n                be on when switch 2 is on and<BR>\n                switch 1 is off.<BR>\n                <BR>\n                <BR>\n                <SPAN ID="jim1"></SPAN><SPAN style="line-height:400%;vertical-align:top">Input from switches 1 and 2</SPAN><BR>\n                <SPAN ID="jim2"></SPAN><SPAN style="line-height:400%;vertical-align:top">Output to light</SPAN><BR>\n                <BR>\n         ',
inserts:{jim1:O(),jim2:D()},activate:()=>{Ma()},locked:!0},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n\t\t<BR>\n                Experiment 9: Inverter <BR>\n                There is a single input and output. The<BR>\n                light should go on if the switch is NOT<BR>\n                on.<BR>\n                <BR>\n                <BR>\n                <SPAN ID="jim1"></SPAN><SPAN style="line-height:400%;vertical-align:top">Input from switch</SPAN><BR>\n                <SPAN ID="jim2"></SPAN><SPAN style="line-height:400%;vertical-align:top">Output to light</SPAN><BR>\n                <BR>\n         ',
inserts:{jim1:O(),jim2:D()},activate:()=>{Na()},locked:!0},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n                <BR>\n                Exclusive Or (Xor)<BR>\n                The output is on if one or other of the<BR>\n                inputs is on but not if both are on.<BR>\n                <BR>\n                This is a function with a bit of history.<BR>\n                Minsky and Papert showed that a single<BR>\n                neuron could not do it.  They are<BR>\n                generally credited with stpping<BR>\n                anyone working on neuron networks<BR>\n                during the 1970\'s.  Interest returned in<BR>\n                the 1980\'s with the introduction of the<BR>\n                idea of multiple layers of neurons.<BR>\n                <BR>\n         '},
{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n                <BR>\n                Experiment 10: Xor<BR>\n                The light should be on if one of the<BR>\n                switches is on but not if both are on.<BR>\n                <BR>\n                <BR>\n                <SPAN ID="jim1"></SPAN><SPAN style="line-height:400%;vertical-align:top">Input from switches 1 and 2</SPAN><BR>\n                <SPAN ID="jim2"></SPAN><SPAN style="line-height:400%;vertical-align:top">Output to light</SPAN><BR>\n                <BR>\n         ',
inserts:{jim1:O(),jim2:D()},activate:()=>{Oa()},locked:!0},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n                <BR>\n                Success<BR>\n                <BR>\n                The lady bug is complete.<BR>\n                It is time to leave the lab<BR>\n                and go into the real world.<BR>\n                <BR>\n                <BR>\n                <BR>\n                <BR>\n                <BR>\n                <BR>\n                <BR>\n         ',
locked:!0},{HTML:'\n\t\t<SPAN ID="pageNum" style="float:right;margin-right:10">6</SPAN>\n\t\t<BR>\n         '}];var h={journalState:0,journalStateMax:0,progressLocked:!1,getExpectedValue:null,getTestValue:null,expectedAccum:0,testing:!1},A=function(a){function b(a,c,b,d){function e(){m.innerText=p.threshold;var a=p.value;a=void 0!==a?a.toFixed(3):"???";q.innerText=a;setTimeout(e,250)}a.addEventListener("click",()=>{f.select(b);g.select(b)});c.addEventListener("click",()=>{f.select(b);g.select(b)});
var h=c.insertCell();a.insertCell().innerText=d.name+":"+b.type;c=c.insertCell();c.colSpan=2;var k=document.createElement("input");k.type="range";k.min=-100;k.max=100;k.value=100*b.threshold;c.appendChild(k);k.addEventListener("input",()=>{b.threshold=k.value/100});c=document.createElement("select");c.add(d=document.createElement("option"));d.text="digital";d.value=l.algo.digital;c.appendChild(d);c.add(d=document.createElement("option"));d.text="analog";d.value=l.algo.analog;c.appendChild(d);c.add(d=
document.createElement("option"));d.text="sigmoid";d.value=l.algo.sigmoid;c.appendChild(d);c.addEventListener("change",(a)=>{a=a.target.options[a.target.selectedIndex];console.log("Right?",a);b.algorithm=+a.value});h.appendChild(c);var m=a.insertCell();m.innerText="123";m.align="right";m.width="25%";var q=a.insertCell();q.innerText="bbb";q.align="right";q.width="25%";var p=b;e()}function d(a,c,b){function d(){h.innerText=l.gain;var a=l.value.toFixed(3);k.innerText=a;setTimeout(d,250)}a.addEventListener("click",
()=>{f.select(b);g.select(b)});c.addEventListener("click",()=>{f.select(b);g.select(b)});c.insertCell();a.insertCell().innerText="synapse";c=c.insertCell();c.colSpan=2;var e=document.createElement("input");e.type="range";e.min=-100;e.max=100;e.value=100*b.gain;c.appendChild(e);e.addEventListener("input",()=>{b.gain=e.value/100});var h=a.insertCell();h.innerText="123";h.align="right";h.width="25%";var k=a.insertCell();k.innerText="bbb";k.align="right";k.width="25%";var l=b;d()}var c=new WeakMap,e=
null,f={table:a,clear(){for(var a;a=this.table.querySelector("tr:nth-of-type(2)");)a.remove()},select(a){var b=c.get(a);b&&(e&&e.forEach((a)=>a.className=""),b.forEach((a)=>a.className="selected"),e=b);g.select(a)},addNeuron(a,d){var e=this.table.insertRow(),f=this.table.insertRow();b(e,f,d,a);c.set(d,[e,f])},addSynapse(a,b){var e=this.table.insertRow(),f=this.table.insertRow();d(e,f,b,a);c.set(b,[e,f])}};f.clear();return f}(document.getElementById("statusTable")),Qa=document.getElementById("boardFrame"),
da=function(){const a=[],b=[];var d={cycle:0,k:1,changed:!1,Synapse:K,brainStems:[],step(){this.cycle++;this.changed?(b.length=0,a.forEach((a)=>{a.cycle!=this.cycle&&(b.push(a),a.value)}),this.changed=!1):b.forEach((a)=>a.value)},dupNeuron(b){b=b.clone();a.push(b);return b},dupSynapse(a){return a.clone()},UnLinkSynapse(a){a.output?a.DetachDestination():a.input&&a.DetachSource()},UnLinkSynapseTo(a){a.DetachDestination()},UnLinkSynapseFrom(a){a.DetachSource()},LinkSynapseFrom(a,b,d){return a.AttachSource(b,
b.attachSynapseFrom(d))},LinkSynapseTo(a,b,d){return a.AttachDestination(b,b.attachSynapse(d))},toJson(){}};Object.keys(za).forEach((a)=>d[a]=za[a]);return d}();va();var g=new V(da,Qa);g.addEventListener("added",(a,b)=>{b instanceof da.Neuron&&A.addNeuron(a,b);b instanceof da.Synapse&&A.addSynapse(a,b)});g.addEventListener("select",(a)=>{a instanceof da.Neuron&&A.select(a)});var U=document.getElementById("notebookPanel");U.addEventListener("click",(a)=>{100<a.offsetX?ea(h.journalState+1):h.journalState&&
ea(h.journalState-1)});U.innerHTML=P[h.journalState].HTML;var v=[],r=[],ya=null;(function(){var a=document.getElementById("boardToolsFrame"),b;a.appendChild((b=aa()).on);b.on.addEventListener("click",()=>{var a=ja(10*(1<<g.scale)-g.board.board_origin_x,10*(1<<g.scale)-g.board.board_origin_y);a=g.board.PutPeice(g.NeuronPeice,a.x,a.y,0);g.events.added&&g.events.added(g.NeuronPeice,a)});a.appendChild(b=pa());b.addEventListener("click",()=>{A.clear();g.reset()});a.appendChild((b=O()).on);b.on.addEventListener("click",
()=>{var a=ja(10*(1<<g.scale)-g.board.board_origin_x,10*(1<<g.scale)-g.board.board_origin_y);C(0,a.x,a.y)});a.appendChild((b=D()).on);b.on.addEventListener("click",()=>{var a=ja(10*(1<<g.scale)-g.board.board_origin_x,10*(1<<g.scale)-g.board.board_origin_y);z(0,a.x,a.y)});a.appendChild((b=ba()).on);b.on.addEventListener("click",()=>{var a=ja(10*(1<<g.scale)-g.board.board_origin_x,10*(1<<g.scale)-g.board.board_origin_y);a=g.board.PutPeice(g.sliderInputPeice,a.x,a.y,()=>v[2].getValue());g.events.added&&
g.events.added(g.sliderInputPeice,a)})})();(function(){var a=document.getElementById("boardMonitorFrame");a.style.padding=8;var b;a.appendChild(ya=b=Ca((a,b)=>{!a&&(h.testing=b)&&(h.expectedAccum=0);console.log("Test Button:",a,b);if(a&&!b){if(1>h.expectedAccum)return h.progressLocked=P[h.journalState].locked=!1,ea(h.journalState+1),!0;console.log("Failed.");return!1}}));b.style.verticalAlign="top";b.style.height="66";b.style.width="25%";b.style.top="5";b.setAttribute("viewBox","0 100 200 40");b.setAttribute("preserveAspectRatio",
"xMaxYMax");a.appendChild(b=ta(.75));v.push(b);b.style.verticalAlign="top";b.style.height="64";b.style.width="48";b.setAttribute("viewBox","0 00 100 175");a.appendChild(b=ta(.223));v.push(b);b.style.verticalAlign="top";b.style.height="64";b.style.width="48";b.setAttribute("viewBox","0 00 100 175");a.appendChild(b=Aa());v.push(b);b.style.height="128";b.style.width="96";b.setAttribute("viewBox","0 00 100 255");b.setAttribute("transform","rotate(-90 0 -25)");a.appendChild(b=Da((a)=>{if(4<=a)return r[a-
4]?100*r[a-4].value:0;if(3==a)return h.getExpectedValue?(a=h.getExpectedValue(),h.testing&&h.getTestValue&&(h.expectedAccum+=Math.abs(a-h.getTestValue())),a):0;if(a<v.length)return 100*v[a].getValue()}));b.style.position="relative";b.style.top=-65;b.style.zIndex=3;b.style.height="150";b.style.width="328";b.setAttribute("viewBox","0 00 450 235")})();xa();(function(){P.forEach((a)=>{U.innerHTML=a.HTML;var b=U.querySelector('[id="pageNum"]');b&&(b.textContent=""+(h.journalState+1),a.inserts&&Object.keys(a.inserts).forEach((b)=>
{var c;(c=U.querySelector(`[id="${b}"]`))&&("on"in a.inserts[b]?c.appendChild(a.inserts[b].on):c.appendChild(a.inserts[b]))}));a.HTML=U.innerHTML})})();(function(){var a=Number(localStorage.getItem("maxPage"));a?(P.forEach((b,d)=>{d<a&&(P[d].locked=!1)}),ea(a)):ea(0)})()})();
